<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>vita.modules.s3.s3gis.GIS</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="vita.modules.s3-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >S3</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        Package&nbsp;vita ::
        Package&nbsp;modules ::
        <a href="vita.modules.s3-module.html">Package&nbsp;s3</a> ::
        <a href="vita.modules.s3.s3gis-module.html">Module&nbsp;s3gis</a> ::
        Class&nbsp;GIS
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="vita.modules.s3.s3gis.GIS-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class GIS</h1><p class="nomargin-top"><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS">source&nbsp;code</a></span></p>
<pre class="base-tree">
object --+
         |
        <strong class="uidshort">GIS</strong>
</pre>

<hr />
<p>GIS functions</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">environment</span>,
        <span class="summary-sig-arg">deployment_settings</span>,
        <span class="summary-sig-arg">db</span>,
        <span class="summary-sig-arg">auth</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">cache</span>=<span class="summary-sig-default">None</span>)</span><br />
      x.__init__(...) initializes x; see x.__class__.__doc__ for signature</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#abbreviate_wkt" class="summary-sig-name">abbreviate_wkt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">wkt</span>,
        <span class="summary-sig-arg">max_length</span>=<span class="summary-sig-default">30</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.abbreviate_wkt">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#download_kml" class="summary-sig-name">download_kml</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">url</span>,
        <span class="summary-sig-arg">public_url</span>)</span><br />
      Download a KML file:</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.download_kml">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_api_key" class="summary-sig-name">get_api_key</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">layer</span>=<span class="summary-sig-default">&quot;google&quot;</span>)</span><br />
      Acquire API key from the database</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_api_key">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_bearing" class="summary-sig-name">get_bearing</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat_start</span>,
        <span class="summary-sig-arg">lon_start</span>,
        <span class="summary-sig-arg">lat_end</span>,
        <span class="summary-sig-arg">lon_end</span>)</span><br />
      Given a Start &amp; End set of Coordinates, return a Bearing Formula 
      from: http://www.movable-type.co.uk/scripts/latlong.html</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_bearing">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#_min_not_none" class="summary-sig-name" onclick="show_private();">_min_not_none</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">*args</span>)</span><br />
      Utility function: returns minimal argument that is not None.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._min_not_none">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_bounds" class="summary-sig-name">get_bounds</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">features</span>=<span class="summary-sig-default">[]</span>)</span><br />
      Calculate the Bounds of a list of Features e.g.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_bounds">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_children" class="summary-sig-name">get_children</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">parent_id</span>)</span><br />
      Return a list of all GIS Features which are children of the requested
      feature, using Materialized path for retrieving the children</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_children">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_parents" class="summary-sig-name">get_parents</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">feature_id</span>)</span><br />
      Return a list of all GIS Features which are parents of the requested 
      feature @ ToDo Switch to modified preorder tree traversal: 
      http://eden.sahanafoundation.org/wiki/HaitiGISToDo#HierarchicalTrees</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_parents">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_config" class="summary-sig-name">get_config</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Reads the current GIS Config from the DB</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_config">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_feature_class_id_from_name" class="summary-sig-name">get_feature_class_id_from_name</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">name</span>)</span><br />
      Returns the Feature Class ID from it's name</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_feature_class_id_from_name">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_feature_layer" class="summary-sig-name">get_feature_layer</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">prefix</span>,
        <span class="summary-sig-arg">resourcename</span>,
        <span class="summary-sig-arg">layername</span>,
        <span class="summary-sig-arg">popup_label</span>,
        <span class="summary-sig-arg">config</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">marker_id</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">filter</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">active</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">polygons</span>=<span class="summary-sig-default">False</span>)</span><br />
      Return a Feature Layer suitable to display on a map</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_feature_layer">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_features_in_radius" class="summary-sig-name">get_features_in_radius</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat</span>,
        <span class="summary-sig-arg">lon</span>,
        <span class="summary-sig-arg">radius</span>,
        <span class="summary-sig-arg">tablename</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">category</span>=<span class="summary-sig-default">None</span>)</span><br />
      Returns Features within a Radius (in km) of a LatLon Location</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_features_in_radius">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_latlon" class="summary-sig-name">get_latlon</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">feature_id</span>,
        <span class="summary-sig-arg">filter</span>=<span class="summary-sig-default">False</span>)</span><br />
      Returns the Lat/Lon for a Feature (using recursion where necessary)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_latlon">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_marker" class="summary-sig-name">get_marker</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">resource</span>,
        <span class="summary-sig-arg">category</span>=<span class="summary-sig-default">None</span>)</span><br />
      Returns the Marker for a Feature
    marker.image = filename
    marker.height
    marker.width</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_marker">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#greatCircleDistance" class="summary-sig-name">greatCircleDistance</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat1</span>,
        <span class="summary-sig-arg">lon1</span>,
        <span class="summary-sig-arg">lat2</span>,
        <span class="summary-sig-arg">lon2</span>,
        <span class="summary-sig-arg">quick</span>=<span class="summary-sig-default">True</span>)</span><br />
      Calculate the shortest distance (in km) over the earth's sphere 
      between 2 points Formulae from: 
      http://www.movable-type.co.uk/scripts/latlong.html (NB We should 
      normally use PostGIS functions, where possible, instead of this 
      query)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.greatCircleDistance">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#import_csv" class="summary-sig-name">import_csv</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">filename</span>,
        <span class="summary-sig-arg">domain</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">check_duplicates</span>=<span class="summary-sig-default">True</span>)</span><br />
      Import a CSV file of Admin Boundaries into the Locations table</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.import_csv">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#import_geonames" class="summary-sig-name">import_geonames</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">country</span>,
        <span class="summary-sig-arg">level</span>=<span class="summary-sig-default">None</span>)</span><br />
      Import Locations from the Geonames database</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.import_geonames">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#latlon_to_wkt" class="summary-sig-name">latlon_to_wkt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat</span>,
        <span class="summary-sig-arg">lon</span>)</span><br />
      Convert a LatLon to a WKT string</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.latlon_to_wkt">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#layer_subtypes" class="summary-sig-name">layer_subtypes</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">layer</span>=<span class="summary-sig-default">&quot;google&quot;</span>)</span><br />
      Return a lit of the subtypes available for a Layer</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.layer_subtypes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#parse_location" class="summary-sig-name">parse_location</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">wkt</span>,
        <span class="summary-sig-arg">lon</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">lat</span>=<span class="summary-sig-default">None</span>)</span><br />
      Parses a location from wkt, returning wkt, lat, lon, bounding box and
      type.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.parse_location">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#update_location_tree" class="summary-sig-name">update_location_tree</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">location_id</span>,
        <span class="summary-sig-arg">parent</span>=<span class="summary-sig-default">None</span>)</span><br />
      Using Materialized path for each node in the tree 
      http://eden.sahanafoundation.org/wiki/HaitiGISToDo#HierarchicalTrees</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.update_location_tree">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#wkt_centroid" class="summary-sig-name">wkt_centroid</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">form</span>)</span><br />
      OnValidation callback:
If a Point has LonLat defined: calculate the WKT.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.wkt_centroid">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#query_features_by_bbox" class="summary-sig-name">query_features_by_bbox</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lon_min</span>,
        <span class="summary-sig-arg">lat_min</span>,
        <span class="summary-sig-arg">lon_max</span>,
        <span class="summary-sig-arg">lat_max</span>)</span><br />
      Returns a query of all Locations inside the given bounding box</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.query_features_by_bbox">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_features_by_bbox" class="summary-sig-name">get_features_by_bbox</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lon_min</span>,
        <span class="summary-sig-arg">lat_min</span>,
        <span class="summary-sig-arg">lon_max</span>,
        <span class="summary-sig-arg">lat_max</span>)</span><br />
      Returns Rows of Locations whose shape intersects the given bbox.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_features_by_bbox">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#_get_features_by_shape" class="summary-sig-name" onclick="show_private();">_get_features_by_shape</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">shape</span>)</span><br />
      Returns Rows of locations which intersect the given shape.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_shape">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#_get_features_by_latlon" class="summary-sig-name" onclick="show_private();">_get_features_by_latlon</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat</span>,
        <span class="summary-sig-arg">lon</span>)</span><br />
      Returns a generator of locations whose shape intersects the given 
      LatLon.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_latlon">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#_get_features_by_feature" class="summary-sig-name" onclick="show_private();">_get_features_by_feature</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">feature</span>)</span><br />
      Returns all Locations whose geometry intersects the given feature.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_feature">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_features_by_shape" class="summary-sig-name">get_features_by_shape</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">shape</span>)</span><br />
      Returns Rows of locations which intersect the given shape.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_shape">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_features_by_latlon" class="summary-sig-name">get_features_by_latlon</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">lat</span>,
        <span class="summary-sig-arg">lon</span>)</span><br />
      Returns a generator of locations whose shape intersects the given 
      LatLon.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_latlon">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#get_features_by_feature" class="summary-sig-name">get_features_by_feature</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">feature</span>)</span><br />
      Returns all Locations whose geometry intersects the given feature.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_feature">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#set_all_bounds" class="summary-sig-name">set_all_bounds</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Sets bounds for all locations without them.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.set_all_bounds">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="vita.modules.s3.s3gis.GIS-class.html#show_map" class="summary-sig-name">show_map</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">height</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">width</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">bbox</span>=<span class="summary-sig-default">{}</span>,
        <span class="summary-sig-arg">lat</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">lon</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">zoom</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">projection</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">add_feature</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">add_feature_active</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">feature_queries</span>=<span class="summary-sig-default">[]</span>,
        <span class="summary-sig-arg">wms_browser</span>=<span class="summary-sig-default">{}</span>,
        <span class="summary-sig-arg">catalogue_overlays</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">catalogue_toolbar</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">legend</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">toolbar</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">search</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">mouse_position</span>=<span class="summary-sig-default">&quot;normal&quot;</span>,
        <span class="summary-sig-arg">print_tool</span>=<span class="summary-sig-default">{}</span>,
        <span class="summary-sig-arg">mgrs</span>=<span class="summary-sig-default">{}</span>,
        <span class="summary-sig-arg">window</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">window_hide</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">closable</span>=<span class="summary-sig-default">True</span>,
        <span class="summary-sig-arg">collapsed</span>=<span class="summary-sig-default">False</span>,
        <span class="summary-sig-arg">public_url</span>=<span class="summary-sig-default">&quot;http://127.0.0.1:8000&quot;</span>)</span><br />
      Returns the HTML to display a map</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.show_map">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">environment</span>,
        <span class="sig-arg">deployment_settings</span>,
        <span class="sig-arg">db</span>,
        <span class="sig-arg">auth</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">cache</span>=<span class="sig-default">None</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>x.__init__(...) initializes x; see x.__class__.__doc__ for 
  signature</p>
  <dl class="fields">
    <dt>Overrides:
        object.__init__
        <dd><em class="note">(inherited documentation)</em></dd>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="abbreviate_wkt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">abbreviate_wkt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">wkt</span>,
        <span class="sig-arg">max_length</span>=<span class="sig-default">30</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.abbreviate_wkt">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="download_kml"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">download_kml</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">url</span>,
        <span class="sig-arg">public_url</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.download_kml">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Download a KML file:</p>
  <ul>
    <li>
      unzip it if-required
    </li>
    <li>
      follow NetworkLinks recursively if-required
    </li>
  </ul>
  <p>Returns a file object</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_api_key"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_api_key</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">layer</span>=<span class="sig-default">&quot;google&quot;</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_api_key">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Acquire API key from the database</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_bearing"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_bearing</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat_start</span>,
        <span class="sig-arg">lon_start</span>,
        <span class="sig-arg">lat_end</span>,
        <span class="sig-arg">lon_end</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_bearing">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Given a Start &amp; End set of Coordinates, return a Bearing Formula 
  from: http://www.movable-type.co.uk/scripts/latlong.html</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_min_not_none"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_min_not_none</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">*args</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._min_not_none">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Utility function: returns minimal argument that is not None.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_bounds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_bounds</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">features</span>=<span class="sig-default">[]</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_bounds">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the Bounds of a list of Features e.g. to use in GPX export 
  for correct zooming</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        Optimised Geospatial routines rather than this crude hack
      </p>
</div></td></tr></table>
</div>
<a name="get_children"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_children</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">parent_id</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_children">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return a list of all GIS Features which are children of the requested 
  feature, using Materialized path for retrieving the children</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Author:</strong>
        Aravind Venkatesan and Ajay Kumar Sreenivasan from NCSU
        <p>This has been chosen over Modified Preorder Tree Traversal for 
        greater efficiency: 
        http://eden.sahanafoundation.org/wiki/HaitiGISToDo#HierarchicalTrees</p>
      </p>
</div></td></tr></table>
</div>
<a name="get_parents"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_parents</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">feature_id</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_parents">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return a list of all GIS Features which are parents of the requested 
  feature @ ToDo Switch to modified preorder tree traversal: 
  http://eden.sahanafoundation.org/wiki/HaitiGISToDo#HierarchicalTrees</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_config"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_config</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_config">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Reads the current GIS Config from the DB</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_feature_class_id_from_name"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_feature_class_id_from_name</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">name</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_feature_class_id_from_name">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns the Feature Class ID from it's name</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_feature_layer"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_feature_layer</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">prefix</span>,
        <span class="sig-arg">resourcename</span>,
        <span class="sig-arg">layername</span>,
        <span class="sig-arg">popup_label</span>,
        <span class="sig-arg">config</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">marker_id</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">filter</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">active</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">polygons</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_feature_layer">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return a Feature Layer suitable to display on a map</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>layername</code></strong> - used as the label in the LayerSwitcher</li>
        <li><strong class="pname"><code>popup_label</code></strong> - used in Cluster Popups to differentiate between types</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="get_features_in_radius"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_features_in_radius</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat</span>,
        <span class="sig-arg">lon</span>,
        <span class="sig-arg">radius</span>,
        <span class="sig-arg">tablename</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">category</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_features_in_radius">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns Features within a Radius (in km) of a LatLon Location</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_latlon"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_latlon</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">feature_id</span>,
        <span class="sig-arg">filter</span>=<span class="sig-default">False</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_latlon">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns the Lat/Lon for a Feature (using recursion where 
  necessary)</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>feature_id</code></strong> - the feature ID (int) or UUID (str)</li>
        <li><strong class="pname"><code>filter</code></strong> - Filter out results based on deployment_settings @ToDo Rewrite to 
          use self.get_parents()</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="get_marker"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_marker</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">resource</span>,
        <span class="sig-arg">category</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_marker">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Returns the Marker for a Feature
    marker.image = filename
    marker.height
    marker.width

Used by s3xrc for Feeds export and by get_feature_layer for Categorised Resources

@param resource
@param category

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="greatCircleDistance"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">greatCircleDistance</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat1</span>,
        <span class="sig-arg">lon1</span>,
        <span class="sig-arg">lat2</span>,
        <span class="sig-arg">lon2</span>,
        <span class="sig-arg">quick</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.greatCircleDistance">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Calculate the shortest distance (in km) over the earth's sphere 
  between 2 points Formulae from: 
  http://www.movable-type.co.uk/scripts/latlong.html (NB We should normally
  use PostGIS functions, where possible, instead of this query)</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="import_csv"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">import_csv</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">filename</span>,
        <span class="sig-arg">domain</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">check_duplicates</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.import_csv">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Import a CSV file of Admin Boundaries into the Locations table

The Location names should be ADM0_NAME to ADM5_NAME
- the highest-numbered name will be taken as the name of the current location
- the previous will be taken as the parent(s)
- any other name is ignored

It is possible to use the tool purely for Hierarchy, however:
If there is a column named 'WKT' then it will be used to provide polygon &amp;/or centroid information.
If there is no column named 'WKT' but there are columns named 'Lat' &amp; Lon' then these will be used for Point information.

WKT columns can be generated from a Shapefile using:
ogr2ogr -f CSV CSV myshapefile.shp -lco GEOMETRY=AS_WKT

Currently this function expects to be run from the CLI, with the CSV file in the web2py folder
Currently it expects L0 data to be pre-imported into the database.
- L1 should be imported 1st, then L2, then L3
- parents are found though the use of the name columns, so the previous level of hierarchy shouldn't have duplicate names in

@ToDo: Extend to support being run from the webpage
@ToDo: Write additional function(s) to do the OGR2OGR transformation from an uploaded Shapefile

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="import_geonames"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">import_geonames</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">country</span>,
        <span class="sig-arg">level</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.import_geonames">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Import Locations from the Geonames database</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>country</code></strong> - the 2-letter country code</li>
        <li><strong class="pname"><code>level</code></strong> - the ADM level to import
          <p>Designed to be run from the CLI Levels should be imported 
          sequentially. It is assumed that L0 exists in the DB already 
          L1-L3 may have been imported from Shapefiles with Polygon info 
          Geonames can then be used to populate the lower levels of 
          hierarchy</p></li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="latlon_to_wkt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">latlon_to_wkt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat</span>,
        <span class="sig-arg">lon</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.latlon_to_wkt">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Convert a LatLon to a WKT string</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>s3gis.latlon_to_wkt(6, 80)
<span class="py-output">'POINT(80 6)'</span></pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="layer_subtypes"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">layer_subtypes</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">layer</span>=<span class="sig-default">&quot;google&quot;</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.layer_subtypes">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Return a lit of the subtypes available for a Layer</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="parse_location"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">parse_location</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">wkt</span>,
        <span class="sig-arg">lon</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">lat</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.parse_location">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Parses a location from wkt, returning wkt, lat, lon, bounding box and 
  type. For points, wkt may be None if lat and lon are provided; wkt will 
  be generated. For lines and polygons, the lat, lon returned represent the
  shape's centroid. Centroid and bounding box will be None if Shapely is 
  not available.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="update_location_tree"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">update_location_tree</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">location_id</span>,
        <span class="sig-arg">parent</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.update_location_tree">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Update the Tree for GIS Locations:</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>Author:</strong>
        Aravind Venkatesan and Ajay Kumar Sreenivasan from NCSU
      </p>
</div></td></tr></table>
</div>
<a name="wkt_centroid"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">wkt_centroid</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">form</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.wkt_centroid">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

OnValidation callback:
If a Point has LonLat defined: calculate the WKT.
If a Line/Polygon has WKT defined: validate the format,
    calculate the LonLat of the Centroid, and set bounds
Centroid and bounds calculation is done using Shapely, which wraps Geos.
A nice description of the algorithm is provided here: http://www.jennessent.com/arcgis/shapes_poster.htm

Relies on Shapely.
@ToDo provide an option to use PostGIS/Spatialite

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="query_features_by_bbox"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">query_features_by_bbox</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lon_min</span>,
        <span class="sig-arg">lat_min</span>,
        <span class="sig-arg">lon_max</span>,
        <span class="sig-arg">lat_max</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.query_features_by_bbox">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns a query of all Locations inside the given bounding box</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="get_features_by_bbox"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_features_by_bbox</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lon_min</span>,
        <span class="sig-arg">lat_min</span>,
        <span class="sig-arg">lon_max</span>,
        <span class="sig-arg">lat_max</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.get_features_by_bbox">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns Rows of Locations whose shape intersects the given bbox.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_get_features_by_shape"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_get_features_by_shape</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">shape</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_shape">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns Rows of locations which intersect the given shape.</p>
  <p>Relies on Shapely for wkt parsing and intersection.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="_get_features_by_latlon"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_get_features_by_latlon</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat</span>,
        <span class="sig-arg">lon</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_latlon">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns a generator of locations whose shape intersects the given 
  LatLon.</p>
  <p>Relies on Shapely.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="_get_features_by_feature"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_get_features_by_feature</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">feature</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_feature">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns all Locations whose geometry intersects the given feature.</p>
  <p>Relies on Shapely.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="get_features_by_shape"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_features_by_shape</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">shape</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_shape">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns Rows of locations which intersect the given shape.</p>
  <p>Relies on Shapely for wkt parsing and intersection.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="get_features_by_latlon"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_features_by_latlon</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">lat</span>,
        <span class="sig-arg">lon</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_latlon">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns a generator of locations whose shape intersects the given 
  LatLon.</p>
  <p>Relies on Shapely.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="get_features_by_feature"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">get_features_by_feature</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">feature</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS._get_features_by_feature">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Returns all Locations whose geometry intersects the given feature.</p>
  <p>Relies on Shapely.</p>
  <dl class="fields">
  </dl>
<div class="fields">      <p><strong>To Do:</strong>
        provide an option to use PostGIS/Spatialite
      </p>
</div></td></tr></table>
</div>
<a name="set_all_bounds"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">set_all_bounds</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.set_all_bounds">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Sets bounds for all locations without them.</p>
  <p>If shapely is present, and a location has wkt, bounds of the geometry 
  are used.  Otherwise, the (lat, lon) are used as bounds.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="show_map"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">show_map</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">height</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">width</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">bbox</span>=<span class="sig-default">{}</span>,
        <span class="sig-arg">lat</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">lon</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">zoom</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">projection</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">add_feature</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">add_feature_active</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">feature_queries</span>=<span class="sig-default">[]</span>,
        <span class="sig-arg">wms_browser</span>=<span class="sig-default">{}</span>,
        <span class="sig-arg">catalogue_overlays</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">catalogue_toolbar</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">legend</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">toolbar</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">search</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">mouse_position</span>=<span class="sig-default">&quot;normal&quot;</span>,
        <span class="sig-arg">print_tool</span>=<span class="sig-default">{}</span>,
        <span class="sig-arg">mgrs</span>=<span class="sig-default">{}</span>,
        <span class="sig-arg">window</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">window_hide</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">closable</span>=<span class="sig-default">True</span>,
        <span class="sig-arg">collapsed</span>=<span class="sig-default">False</span>,
        <span class="sig-arg">public_url</span>=<span class="sig-default">&quot;http://127.0.0.1:8000&quot;</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="vita.modules.s3.s3gis-pysrc.html#GIS.show_map">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">

Returns the HTML to display a map

Normally called in the controller as: map = gis.show_map()
In the view, put: {{=XML(map)}}

@param height: Height of viewport (if not provided then the default setting from the Map Service Catalogue is used)
@param width: Width of viewport (if not provided then the default setting from the Map Service Catalogue is used)
@param bbox: default Bounding Box of viewport (if not provided then the Lat/Lon/Zoom are used) (Dict):
    {
    &quot;max_lat&quot; : float,
    &quot;max_lon&quot; : float,
    &quot;min_lat&quot; : float,
    &quot;min_lon&quot; : float
    }
@param lat: default Latitude of viewport (if not provided then the default setting from the Map Service Catalogue is used)
@param lon: default Longitude of viewport (if not provided then the default setting from the Map Service Catalogue is used)
@param zoom: default Zoom level of viewport (if not provided then the default setting from the Map Service Catalogue is used)
@param projection: EPSG code for the Projection to use (if not provided then the default setting from the Map Service Catalogue is used)
@param add_feature: Whether to include a DrawFeature control to allow adding a marker to the map
@param add_feature_active: Whether the DrawFeature control should be active by default
@param feature_queries: Feature Queries to overlay onto the map &amp; their options (List of Dicts):
    [{
     name   : &quot;MyLabel&quot;,    # A string: the label for the layer
     query  : query,        # A gluon.sql.Rows of gis_locations, which can be from a simple query or a Join. Extra fields can be added for 'marker' or 'shape' (with optional 'color' &amp; 'size') &amp; 'popup_label'
     active : False,        # Is the feed displayed upon load or needs ticking to load afterwards?
     popup_url : None,      # The URL which will be used to fill the pop-up. If the string contains &lt;id&gt; then the Location ID will be replaced here, otherwise it will be appended by the Location ID.
     marker : None,         # The marker query or marker_id for the icon used to display the feature (over-riding the normal process).
     polygons : False       # Use Polygon data, if-available (defaults to just using Point)
    }]
@param wms_browser: WMS Server's GetCapabilities &amp; options (dict)
    {
    name: string,           # Name for the Folder in LayerTree
    url: string             # URL of GetCapabilities
    }
@param catalogue_overlays: Show the Overlays from the GIS Catalogue (@ToDo: make this a dict of which external overlays to allow)
@param catalogue_toolbar: Show the Catalogue Toolbar
@param legend: Show the Legend panel
@param toolbar: Show the Icon Toolbar of Controls
@param search: Show the Geonames search box
@param mouse_position: Show the current coordinates in the bottom-right of the map. 3 Options: 'normal' (default), 'mgrs' (MGRS), False (off)
@param print_tool: Show a print utility (NB This requires server-side support: http://eden.sahanafoundation.org/wiki/BluePrintGISPrinting)
    {
    url: string,            # URL of print service (e.g. http://localhost:8080/geoserver/pdf/)
    mapTitle: string        # Title for the Printed Map (optional)
    subTitle: string        # subTitle for the Printed Map (optional)
    }
@param mgrs: Use the MGRS Control to select PDFs
    {
    name: string,           # Name for the Control
    url: string             # URL of PDF server
    }
@param window: Have viewport pop out of page into a resizable window
@param window_hide: Have the window hidden by default, ready to appear (e.g. on clicking a button)
@param closable: In Window mode, whether the window is closable or not
@param collapsed: Start the Tools panel (West region) collapsed
@param public_url: pass from model (not yet defined when Module instantiated

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="vita.modules.s3-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >S3</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Jan 17 00:32:28 2011
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
