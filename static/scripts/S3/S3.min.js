Calendar=function(a,e,h,g){this.timeout=this.getDateText=this.getDateToolTip=this.getDateStatus=this.currentDateEl=this.activeDiv=null;this.onSelected=h||null;this.onClose=g||null;this.hidden=this.dragging=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.weekNumbers=this.isPopup=true;this.firstDayOfWeek=typeof a=="number"?a:Calendar._FD;this.showsOtherMonths=false;this.dateStr=e;this.ar_days=null;this.showsTime=
false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.activeYear=this.hilitedYear=this.activeMonth=this.hilitedMonth=this.yearsCombo=this.monthsCombo=this.firstdayname=this.tbody=this.element=this.table=this.multiple=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined")Calendar._SDN_len=3;a=[];for(e=8;e>0;)a[--e]=Calendar._DN[e].substr(0,Calendar._SDN_len);Calendar._SDN=a;if(typeof Calendar._SMN_len=="undefined")Calendar._SMN_len=3;
a=[];for(e=12;e>0;)a[--e]=Calendar._MN[e].substr(0,Calendar._SMN_len);Calendar._SMN=a}};Calendar._C=null;Calendar.is_ie=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent);Calendar.is_ie5=Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent);Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);
Calendar.getAbsolutePos=function(a){var e=0,h=0,g=/^div$/i.test(a.tagName);if(g&&a.scrollLeft)e=a.scrollLeft;if(g&&a.scrollTop)h=a.scrollTop;e={x:a.offsetLeft-e,y:a.offsetTop-h};if(a.offsetParent){a=this.getAbsolutePos(a.offsetParent);e.x+=a.x;e.y+=a.y}return e};Calendar.isRelated=function(a,e){var h=e.relatedTarget;if(!h){var g=e.type;if(g=="mouseover")h=e.fromElement;else if(g=="mouseout")h=e.toElement}for(;h;){if(h==a)return true;h=h.parentNode}return false};
Calendar.removeClass=function(a,e){if(a&&a.className){for(var h=a.className.split(" "),g=[],j=h.length;j>0;)if(h[--j]!=e)g[g.length]=h[j];a.className=g.join(" ")}};Calendar.addClass=function(a,e){Calendar.removeClass(a,e);a.className+=" "+e};Calendar.getElement=function(a){for(a=Calendar.is_ie?window.event.srcElement:a.currentTarget;a.nodeType!=1||/^div$/i.test(a.tagName);)a=a.parentNode;return a};
Calendar.getTargetElement=function(a){for(a=Calendar.is_ie?window.event.srcElement:a.target;a.nodeType!=1;)a=a.parentNode;return a};Calendar.stopEvent=function(a){a||(a=window.event);if(Calendar.is_ie){a.cancelBubble=true;a.returnValue=false}else{a.preventDefault();a.stopPropagation()}return false};Calendar.addEvent=function(a,e,h){if(a.attachEvent)a.attachEvent("on"+e,h);else if(a.addEventListener)a.addEventListener(e,h,true);else a["on"+e]=h};
Calendar.removeEvent=function(a,e,h){if(a.detachEvent)a.detachEvent("on"+e,h);else if(a.removeEventListener)a.removeEventListener(e,h,true);else a["on"+e]=null};Calendar.createElement=function(a,e){var h=null;h=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml",a):document.createElement(a);typeof e!="undefined"&&e.appendChild(h);return h};
Calendar._add_evs=function(a){with(Calendar){addEvent(a,"mouseover",dayMouseOver);addEvent(a,"mousedown",dayMouseDown);addEvent(a,"mouseout",dayMouseOut);if(is_ie){addEvent(a,"dblclick",dayMouseDblClick);a.setAttribute("unselectable",true)}}};Calendar.findMonth=function(a){if(typeof a.month!="undefined")return a;else if(typeof a.parentNode.month!="undefined")return a.parentNode;return null};
Calendar.findYear=function(a){if(typeof a.year!="undefined")return a;else if(typeof a.parentNode.year!="undefined")return a.parentNode;return null};
Calendar.showMonthsCombo=function(){var a=Calendar._C;if(!a)return false;var e=a.activeDiv,h=a.monthsCombo;a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");a.activeMonth&&Calendar.removeClass(a.activeMonth,"active");var g=a.monthsCombo.getElementsByTagName("div")[a.date.getMonth()];Calendar.addClass(g,"active");a.activeMonth=g;a=h.style;a.display="block";if(e.navtype<0)a.left=e.offsetLeft+"px";else{h=h.offsetWidth;if(typeof h=="undefined")h=50;a.left=e.offsetLeft+e.offsetWidth-h+"px"}a.top=
e.offsetTop+e.offsetHeight+"px"};
Calendar.showYearsCombo=function(a){var e=Calendar._C;if(!e)return false;var h=e.activeDiv,g=e.yearsCombo;e.hilitedYear&&Calendar.removeClass(e.hilitedYear,"hilite");e.activeYear&&Calendar.removeClass(e.activeYear,"active");e.activeYear=null;for(var j=e.date.getFullYear()+(a?1:-1),b=g.firstChild,c=false,f=12;f>0;--f){if(j>=e.minYear&&j<=e.maxYear){b.innerHTML=j;b.year=j;b.style.display="block";c=true}else b.style.display="none";b=b.nextSibling;j+=a?e.yearStep:-e.yearStep}if(c){a=g.style;a.display=
"block";if(h.navtype<0)a.left=h.offsetLeft+"px";else{g=g.offsetWidth;if(typeof g=="undefined")g=50;a.left=h.offsetLeft+h.offsetWidth-g+"px"}a.top=h.offsetTop+h.offsetHeight+"px"}};
Calendar.tableMouseUp=function(a){var e=Calendar._C;if(!e)return false;e.timeout&&clearTimeout(e.timeout);var h=e.activeDiv;if(!h)return false;var g=Calendar.getTargetElement(a);a||(a=window.event);Calendar.removeClass(h,"active");if(g==h||g.parentNode==h)Calendar.cellClick(h,a);var j=Calendar.findMonth(g);h=null;if(j){h=new Date(e.date);if(j.month!=h.getMonth()){h.setMonth(j.month);e.setDate(h);e.dateClicked=false;e.callHandler()}}else if(g=Calendar.findYear(g)){h=new Date(e.date);if(g.year!=h.getFullYear()){h.setFullYear(g.year);
e.setDate(h);e.dateClicked=false;e.callHandler()}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);e._hideCombos();_C=null;return stopEvent(a)}};
Calendar.tableMouseOver=function(a){var e=Calendar._C;if(e){var h=e.activeDiv,g=Calendar.getTargetElement(a);if(g==h||g.parentNode==h){Calendar.addClass(h,"hilite active");Calendar.addClass(h.parentNode,"rowhilite")}else{if(typeof h.navtype=="undefined"||h.navtype!=50&&(h.navtype==0||Math.abs(h.navtype)>2))Calendar.removeClass(h,"active");Calendar.removeClass(h,"hilite");Calendar.removeClass(h.parentNode,"rowhilite")}a||(a=window.event);if(h.navtype==50&&g!=h){var j=Calendar.getAbsolutePos(h),b=h.offsetWidth,
c=a.clientX,f=true;if(c>j.x+b){c=c-j.x-b;f=false}else c=j.x-c;if(c<0)c=0;j=h._range;b=h._current;c=Math.floor(c/10)%j.length;for(var k=j.length;--k>=0;)if(j[k]==b)break;for(;c-- >0;)if(f){if(--k<0)k=j.length-1}else if(++k>=j.length)k=0;h.innerHTML=j[k];e.onUpdateTime()}if(h=Calendar.findMonth(g))if(h.month!=e.date.getMonth()){e.hilitedMonth&&Calendar.removeClass(e.hilitedMonth,"hilite");Calendar.addClass(h,"hilite");e.hilitedMonth=h}else e.hilitedMonth&&Calendar.removeClass(e.hilitedMonth,"hilite");
else{e.hilitedMonth&&Calendar.removeClass(e.hilitedMonth,"hilite");if(g=Calendar.findYear(g))if(g.year!=e.date.getFullYear()){e.hilitedYear&&Calendar.removeClass(e.hilitedYear,"hilite");Calendar.addClass(g,"hilite");e.hilitedYear=g}else e.hilitedYear&&Calendar.removeClass(e.hilitedYear,"hilite");else e.hilitedYear&&Calendar.removeClass(e.hilitedYear,"hilite")}return Calendar.stopEvent(a)}};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a))return Calendar.stopEvent(a)};
Calendar.calDragIt=function(a){var e=Calendar._C;if(!(e&&e.dragging))return false;var h,g;if(Calendar.is_ie){g=window.event.clientY+document.body.scrollTop;h=window.event.clientX+document.body.scrollLeft}else{h=a.pageX;g=a.pageY}e.hideShowCovered();var j=e.element.style;j.left=h-e.xOffs+"px";j.top=g-e.yOffs+"px";return Calendar.stopEvent(a)};
Calendar.calDragEnd=function(a){var e=Calendar._C;if(!e)return false;e.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(a)}e.hideShowCovered()};
Calendar.dayMouseDown=function(a){var e=Calendar.getElement(a);if(e.disabled)return false;var h=e.calendar;h.activeDiv=e;Calendar._C=h;if(e.navtype!=300)with(Calendar){if(e.navtype==50){e._current=e.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);addClass(e,"hilite active");addEvent(document,"mouseup",tableMouseUp)}else h.isPopup&&h._dragStart(a);if(e.navtype==-1||e.navtype==1){h.timeout&&clearTimeout(h.timeout);
h.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else if(e.navtype==-2||e.navtype==2){h.timeout&&clearTimeout(h.timeout);h.timeout=setTimeout(e.navtype>0?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else h.timeout=null;return Calendar.stopEvent(a)};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event);Calendar.is_ie&&document.selection.empty()};
Calendar.dayMouseOver=function(a){var e=Calendar.getElement(a);if(Calendar.isRelated(e,a)||Calendar._C||e.disabled)return false;if(e.ttip){if(e.ttip.substr(0,1)=="_")e.ttip=e.caldate.print(e.calendar.ttDateFormat)+e.ttip.substr(1);e.calendar.tooltips.innerHTML=e.ttip}if(e.navtype!=300){Calendar.addClass(e,"hilite");e.caldate&&Calendar.addClass(e.parentNode,"rowhilite")}return Calendar.stopEvent(a)};
Calendar.dayMouseOut=function(a){with(Calendar){var e=getElement(a);if(isRelated(e,a)||_C||e.disabled)return false;removeClass(e,"hilite");e.caldate&&removeClass(e.parentNode,"rowhilite");if(e.calendar)e.calendar.tooltips.innerHTML=_TT.SEL_DATE;return stopEvent(a)}};
Calendar.cellClick=function(a,e){var h=a.calendar,g=false,j=false,b=null;if(typeof a.navtype=="undefined"){if(h.currentDateEl){Calendar.removeClass(h.currentDateEl,"selected");Calendar.addClass(a,"selected");g=h.currentDateEl==a;if(!g)h.currentDateEl=a}h.date.setDateOnly(a.caldate);b=h.date;var c=!(h.dateClicked=!a.otherMonth);if(!c&&!h.currentDateEl)h._toggleMultipleDate(new Date(b));else j=!a.disabled;c&&h._init(h.firstDayOfWeek,b)}else{if(a.navtype==200){Calendar.removeClass(a,"hilite");h.callCloseHandler();
return}b=new Date(h.date);a.navtype==0&&b.setDateOnly(new Date);h.dateClicked=false;c=b.getFullYear();var f=b.getMonth(),k=function(m){var n=b.getDate(),o=b.getMonthDays(m);n>o&&b.setDate(o);b.setMonth(m)};switch(a.navtype){case 400:Calendar.removeClass(a,"hilite");g=Calendar._TT.ABOUT;if(typeof g!="undefined")g+=h.showsTime?Calendar._TT.ABOUT_TIME:"";else g='Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.js\nand send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n';
alert(g);return;case -2:c>h.minYear&&b.setFullYear(c-1);break;case -1:if(f>0)k(f-1);else if(c-- >h.minYear){b.setFullYear(c);k(11)}break;case 1:if(f<11)k(f+1);else if(c<h.maxYear){b.setFullYear(c+1);k(0)}break;case 2:c<h.maxYear&&b.setFullYear(c+1);break;case 100:h.setFirstDayOfWeek(a.fdow);return;case 50:g=a._range;j=a.innerHTML;for(c=g.length;--c>=0;)if(g[c]==j)break;if(e&&e.shiftKey){if(--c<0)c=g.length-1}else if(++c>=g.length)c=0;a.innerHTML=g[c];h.onUpdateTime();return;case 0:if(typeof h.getDateStatus==
"function"&&h.getDateStatus(b,b.getFullYear(),b.getMonth(),b.getDate()))return false}if(b.equalsTo(h.date)){if(a.navtype==0)j=g=true}else{h.setDate(b);j=true}}j&&e&&h.callHandler();if(g){Calendar.removeClass(a,"hilite");e&&h.callCloseHandler()}};
Calendar.prototype.create=function(a){var e=null;if(a){e=a;this.isPopup=false}else{e=document.getElementsByTagName("body")[0];this.isPopup=true}this.date=this.dateStr?new Date(this.dateStr):new Date;this.table=a=Calendar.createElement("table");a.cellSpacing=0;a.cellPadding=0;a.calendar=this;Calendar.addEvent(a,"mousedown",Calendar.tableMouseDown);var h=Calendar.createElement("div");this.element=h;h.className="calendar";if(this.isPopup){h.style.position="absolute";h.style.display="none"}h.appendChild(a);
var g=Calendar.createElement("thead",a),j=null,b=null,c=this;h=function(m,n,o){j=Calendar.createElement("td",b);j.colSpan=n;j.className="button";if(o!=0&&Math.abs(o)<=2)j.className+=" nav";Calendar._add_evs(j);j.calendar=c;j.navtype=o;j.innerHTML="<div unselectable='on'>"+m+"</div>";return j};b=Calendar.createElement("tr",g);var f=6;this.isPopup&&--f;this.weekNumbers&&++f;h("?",1,400).ttip=Calendar._TT.INFO;this.title=h("",f,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;
this.title.style.cursor="move";h("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE}b=Calendar.createElement("tr",g);b.className="headrow";this._nav_py=h("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=h("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=h(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=h("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=h("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;
b=Calendar.createElement("tr",g);b.className="daynames";if(this.weekNumbers){j=Calendar.createElement("td",b);j.className="name wn";j.innerHTML=Calendar._TT.WK}for(g=7;g>0;--g){j=Calendar.createElement("td",b);if(!g){j.navtype=100;j.calendar=this;Calendar._add_evs(j)}}this.firstdayname=this.weekNumbers?b.firstChild.nextSibling:b.firstChild;this._displayWeekdays();this.tbody=f=Calendar.createElement("tbody",a);for(g=6;g>0;--g){b=Calendar.createElement("tr",f);if(this.weekNumbers)j=Calendar.createElement("td",
b);for(var k=7;k>0;--k){j=Calendar.createElement("td",b);j.calendar=this;Calendar._add_evs(j)}}if(this.showsTime){b=Calendar.createElement("tr",f);b.className="time";j=Calendar.createElement("td",b);j.className="time";j.colSpan=2;j.innerHTML=Calendar._TT.TIME||"&nbsp;";j=Calendar.createElement("td",b);j.className="time";j.colSpan=this.weekNumbers?4:3;(function(){function m(r,y,z,B){var C=Calendar.createElement("span",j);C.className=r;C.innerHTML=y;C.calendar=c;C.ttip=Calendar._TT.TIME_PART;C.navtype=
50;C._range=[];if(typeof z!="number")C._range=z;else for(r=z;r<=B;++r)C._range[C._range.length]=r<10&&B>=10?"0"+r:""+r;Calendar._add_evs(C);return C}var n=c.date.getHours(),o=c.date.getMinutes(),p=!c.time24,t=n>12;if(p&&t)n-=12;var w=m("hour",n,p?1:0,p?12:23);n=Calendar.createElement("span",j);n.innerHTML=":";n.className="colon";var x=m("minute",o,0,59),u=null;j=Calendar.createElement("td",b);j.className="time";j.colSpan=2;if(p)u=m("ampm",t?"pm":"am",["am","pm"]);else j.innerHTML="&nbsp;";c.onSetTime=
function(){var r,y=this.date.getHours(),z=this.date.getMinutes();if(p){if(r=y>=12)y-=12;if(y==0)y=12;u.innerHTML=r?"pm":"am"}w.innerHTML=y<10?"0"+y:y;x.innerHTML=z<10?"0"+z:z};c.onUpdateTime=function(){var r=this.date,y=parseInt(w.innerHTML,10);if(p)if(/pm/i.test(u.innerHTML)&&y<12)y+=12;else if(/am/i.test(u.innerHTML)&&y==12)y=0;var z=r.getDate(),B=r.getMonth(),C=r.getFullYear();r.setHours(y);r.setMinutes(parseInt(x.innerHTML,10));r.setFullYear(C);r.setMonth(B);r.setDate(z);this.dateClicked=false;
this.callHandler()}})()}else this.onSetTime=this.onUpdateTime=function(){};a=Calendar.createElement("tfoot",a);b=Calendar.createElement("tr",a);b.className="footrow";j=h(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);j.className="ttip";if(this.isPopup){j.ttip=Calendar._TT.DRAG_TO_MOVE;j.style.cursor="move"}this.tooltips=j;this.monthsCombo=h=Calendar.createElement("div",this.element);h.className="combo";for(g=0;g<Calendar._MN.length;++g){a=Calendar.createElement("div");a.className=Calendar.is_ie?
"label-IEfix":"label";a.month=g;a.innerHTML=Calendar._SMN[g];h.appendChild(a)}this.yearsCombo=h=Calendar.createElement("div",this.element);h.className="combo";for(g=12;g>0;--g){a=Calendar.createElement("div");a.className=Calendar.is_ie?"label-IEfix":"label";h.appendChild(a)}this._init(this.firstDayOfWeek,this.date);e.appendChild(this.element)};
Calendar._keyEvent=function(a){var e=window._dynarch_popupCalendar;if(!e||e.multiple)return false;Calendar.is_ie&&(a=window.event);var h=Calendar.is_ie||a.type=="keypress",g=a.keyCode;if(a.ctrlKey)switch(g){case 37:h&&Calendar.cellClick(e._nav_pm);break;case 38:h&&Calendar.cellClick(e._nav_py);break;case 39:h&&Calendar.cellClick(e._nav_nm);break;case 40:h&&Calendar.cellClick(e._nav_ny);break;default:return false}else switch(g){case 32:Calendar.cellClick(e._nav_now);break;case 27:h&&e.callCloseHandler();
break;case 37:case 38:case 39:case 40:if(h){var j,b,c,f,k;h=g==37||g==38;k=g==37||g==39?1:7;var m=function(){f=e.currentDateEl;var p=f.pos;j=p&15;b=p>>4;c=e.ar_days[b][j]};m();for(var n=function(){var p=new Date(e.date);p.setDate(p.getDate()-k);e.setDate(p)},o=function(){var p=new Date(e.date);p.setDate(p.getDate()+k);e.setDate(p)};;){switch(g){case 37:if(--j>=0)c=e.ar_days[b][j];else{j=6;g=38;continue}break;case 38:if(--b>=0)c=e.ar_days[b][j];else{n();m()}break;case 39:if(++j<7)c=e.ar_days[b][j];
else{j=0;g=40;continue}break;case 40:if(++b<e.ar_days.length)c=e.ar_days[b][j];else{o();m()}}break}if(c)if(c.disabled)h?n():o();else Calendar.cellClick(c)}break;case 13:h&&Calendar.cellClick(e.currentDateEl,a);break;default:return false}return Calendar.stopEvent(a)};
Calendar.prototype._init=function(a,e){var h=new Date,g=h.getFullYear(),j=h.getMonth();h=h.getDate();this.table.style.visibility="hidden";var b=e.getFullYear();if(b<this.minYear){b=this.minYear;e.setFullYear(b)}else if(b>this.maxYear){b=this.maxYear;e.setFullYear(b)}this.firstDayOfWeek=a;this.date=new Date(e);var c=e.getMonth(),f=e.getDate();e.getMonthDays();e.setDate(1);var k=(e.getDay()-this.firstDayOfWeek)%7;if(k<0)k+=7;e.setDate(0-k);e.setDate(e.getDate()+1);k=this.tbody.firstChild;for(var m=
this.ar_days=[],n=Calendar._TT.WEEKEND,o=this.multiple?this.datesCells={}:null,p=0;p<6;++p,k=k.nextSibling){var t=k.firstChild;if(this.weekNumbers){t.className="day wn";t.innerHTML=e.getWeekNumber();t=t.nextSibling}k.className="daysrow";for(var w=false,x,u=m[p]=[],r=0;r<7;++r,t=t.nextSibling,e.setDate(x+1)){x=e.getDate();var y=e.getDay();t.className="day";t.pos=p<<4|r;u[r]=t;var z=e.getMonth()==c;if(z){t.otherMonth=false;w=true}else if(this.showsOtherMonths){t.className+=" othermonth";t.otherMonth=
true}else{t.className="emptycell";t.innerHTML="&nbsp;";t.disabled=true;continue}t.disabled=false;t.innerHTML=this.getDateText?this.getDateText(e,x):x;if(o)o[e.print("%Y%m%d")]=t;if(this.getDateStatus){var B=this.getDateStatus(e,b,c,x);if(this.getDateToolTip){var C=this.getDateToolTip(e,b,c,x);if(C)t.title=C}if(B===true){t.className+=" disabled";t.disabled=true}else{if(/disabled/i.test(B))t.disabled=true;t.className+=" "+B}}if(!t.disabled){t.caldate=new Date(e);t.ttip="_";if(!this.multiple&&z&&x==
f&&this.hiliteToday){t.className+=" selected";this.currentDateEl=t}if(e.getFullYear()==g&&e.getMonth()==j&&x==h){t.className+=" today";t.ttip+=Calendar._TT.PART_TODAY}if(n.indexOf(y.toString())!=-1)t.className+=t.otherMonth?" oweekend":" weekend"}}if(!(w||this.showsOtherMonths))k.className="emptyrow"}this.title.innerHTML=Calendar._MN[c]+", "+b;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};
Calendar.prototype._initMultipleDates=function(){if(this.multiple)for(var a in this.multiple){var e=this.datesCells[a];if(this.multiple[a])if(e)e.className+=" selected"}};Calendar.prototype._toggleMultipleDate=function(a){if(this.multiple){var e=a.print("%Y%m%d"),h=this.datesCells[e];if(h)if(this.multiple[e]){Calendar.removeClass(h,"selected");delete this.multiple[e]}else{Calendar.addClass(h,"selected");this.multiple[e]=a}}};
Calendar.prototype.setDateToolTipHandler=function(a){this.getDateToolTip=a};Calendar.prototype.setDate=function(a){a.equalsTo(this.date)||this._init(this.firstDayOfWeek,a)};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(a){this._init(a,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a};
Calendar.prototype.setRange=function(a,e){this.minYear=a;this.maxYear=e};Calendar.prototype.callHandler=function(){this.onSelected&&this.onSelected(this,this.date.print(this.dateFormat))};Calendar.prototype.callCloseHandler=function(){this.onClose&&this.onClose(this);this.hideShowCovered()};Calendar.prototype.destroy=function(){this.element.parentNode.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};
Calendar.prototype.reparent=function(a){var e=this.element;e.parentNode.removeChild(e);a.appendChild(e)};Calendar._checkCalendar=function(a){var e=window._dynarch_popupCalendar;if(!e)return false;for(var h=Calendar.is_ie?Calendar.getElement(a):Calendar.getTargetElement(a);h!=null&&h!=e.element;h=h.parentNode);if(h==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(a)}};
Calendar.prototype.show=function(){for(var a=this.table.getElementsByTagName("tr"),e=a.length;e>0;){var h=a[--e];Calendar.removeClass(h,"rowhilite");h=h.getElementsByTagName("td");for(var g=h.length;g>0;){var j=h[--g];Calendar.removeClass(j,"hilite");Calendar.removeClass(j,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);
Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(a,e){var h=this.element.style;h.left=a+"px";h.top=e+"px";this.show()};
Calendar.prototype.showAtElement=function(a,e){var h=this,g=Calendar.getAbsolutePos(a);if(!e||typeof e!="string"){this.showAt(g.x,g.y+a.offsetHeight);return true}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var j=h.element.offsetWidth,b=h.element.offsetHeight;h.element.style.display="none";var c=e.substr(0,1),f="l";if(e.length>1)f=e.substr(1,1);switch(c){case "T":g.y-=b;break;case "B":g.y+=a.offsetHeight;break;case "C":g.y+=(a.offsetHeight-b)/2;
break;case "t":g.y+=a.offsetHeight-b}switch(f){case "L":g.x-=j;break;case "R":g.x+=a.offsetWidth;break;case "C":g.x+=(a.offsetWidth-j)/2;break;case "l":g.x+=a.offsetWidth-j}g.width=j;g.height=b+40;h.monthsCombo.style.display="none";if(g.x<0)g.x=0;if(g.y<0)g.y=0;j=document.createElement("div");b=j.style;b.position="absolute";b.right=b.bottom=b.width=b.height="0px";document.body.appendChild(j);b=Calendar.getAbsolutePos(j);document.body.removeChild(j);if(Calendar.is_ie){b.y+=document.body.scrollTop;
b.x+=document.body.scrollLeft}else{b.y+=window.scrollY;b.x+=window.scrollX}j=g.x+g.width-b.x;if(j>0)g.x-=j;j=g.y+g.height-b.y;if(j>0)g.y-=j;h.showAt(g.x,g.y)};Calendar.is_khtml?setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10):Calendar.continuation_for_the_fucking_khtml_browser()};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a};
Calendar.prototype.parseDate=function(a,e){if(!e)e=this.dateFormat;this.setDate(Date.parseDate(a,e))};
Calendar.prototype.hideShowCovered=function(){function a(w){var x=w.style.visibility;x||(x=document.defaultView&&typeof document.defaultView.getComputedStyle=="function"?Calendar.is_khtml?"":document.defaultView.getComputedStyle(w,"").getPropertyValue("visibility"):w.currentStyle?w.currentStyle.visibility:"");return x}if(Calendar.is_ie||Calendar.is_opera){var e=["applet","iframe","select"],h=this.element,g=Calendar.getAbsolutePos(h),j=g.x,b=h.offsetWidth+j,c=g.y;h=h.offsetHeight+c;for(var f=e.length;f>
0;)for(var k=document.getElementsByTagName(e[--f]),m=null,n=k.length;n>0;){m=k[--n];g=Calendar.getAbsolutePos(m);var o=g.x,p=m.offsetWidth+o;g=g.y;var t=m.offsetHeight+g;if(this.hidden||o>b||p<j||g>h||t<c){if(!m.__msh_save_visibility)m.__msh_save_visibility=a(m);m.style.visibility=m.__msh_save_visibility}else{if(!m.__msh_save_visibility)m.__msh_save_visibility=a(m);m.style.visibility="hidden"}}}};
Calendar.prototype._displayWeekdays=function(){for(var a=this.firstDayOfWeek,e=this.firstdayname,h=Calendar._TT.WEEKEND,g=0;g<7;++g){e.className="day name";var j=(g+a)%7;if(g){e.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[j]);e.navtype=100;e.calendar=this;e.fdow=j;Calendar._add_evs(e)}h.indexOf(j.toString())!=-1&&Calendar.addClass(e,"weekend");e.innerHTML=Calendar._SDN[(g+a)%7];e=e.nextSibling}};
Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};
Calendar.prototype._dragStart=function(a){if(!this.dragging){this.dragging=true;var e;if(Calendar.is_ie){e=window.event.clientY+document.body.scrollTop;a=window.event.clientX+document.body.scrollLeft}else{e=a.clientY+window.scrollY;a=a.clientX+window.scrollX}var h=this.element.style;this.xOffs=a-parseInt(h.left);this.yOffs=e-parseInt(h.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}}};Date._MD=[31,28,31,30,31,30,31,31,30,31,30,31];
Date.SECOND=1E3;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;
Date.parseDate=function(a,e){var h=new Date,g=0,j=-1,b=0,c=a.split(/\W+/),f=e.match(/%./g),k=0,m=0,n=0,o=0;for(k=0;k<c.length;++k)if(c[k])switch(f[k]){case "%d":case "%e":b=parseInt(c[k],10);break;case "%m":j=parseInt(c[k],10)-1;break;case "%Y":case "%y":g=parseInt(c[k],10);g<100&&(g+=g>29?1900:2E3);break;case "%b":case "%B":for(m=0;m<12;++m)if(Calendar._MN[m].substr(0,c[k].length).toLowerCase()==c[k].toLowerCase()){j=m;break}break;case "%H":case "%I":case "%k":case "%l":n=parseInt(c[k],10);break;
case "%P":case "%p":if(/pm/i.test(c[k])&&n<12)n+=12;else if(/am/i.test(c[k])&&n>=12)n-=12;break;case "%M":o=parseInt(c[k],10)}if(isNaN(g))g=h.getFullYear();if(isNaN(j))j=h.getMonth();if(isNaN(b))b=h.getDate();if(isNaN(n))n=h.getHours();if(isNaN(o))o=h.getMinutes();if(g!=0&&j!=-1&&b!=0)return new Date(g,j,b,n,o,0);g=0;j=-1;for(k=b=0;k<c.length;++k)if(c[k].search(/[a-zA-Z]+/)!=-1){f=-1;for(m=0;m<12;++m)if(Calendar._MN[m].substr(0,c[k].length).toLowerCase()==c[k].toLowerCase()){f=m;break}if(f!=-1){if(j!=
-1)b=j+1;j=f}}else if(parseInt(c[k],10)<=12&&j==-1)j=c[k]-1;else if(parseInt(c[k],10)>31&&g==0){g=parseInt(c[k],10);g<100&&(g+=g>29?1900:2E3)}else if(b==0)b=c[k];if(g==0)g=h.getFullYear();if(j!=-1&&b!=0)return new Date(g,j,b,n,o,0);return h};Date.prototype.getMonthDays=function(a){var e=this.getFullYear();if(typeof a=="undefined")a=this.getMonth();return 0==e%4&&(0!=e%100||0==e%400)&&a==1?29:Date._MD[a]};
Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),e=new Date(this.getFullYear(),0,0,0,0,0);return Math.floor((a-e)/Date.DAY)};Date.prototype.getWeekNumber=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),e=a.getDay();a.setDate(a.getDate()-(e+6)%7+3);e=a.valueOf();a.setMonth(0);a.setDate(4);return Math.round((e-a.valueOf())/6048E5)+1};
Date.prototype.equalsTo=function(a){return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()&&this.getHours()==a.getHours()&&this.getMinutes()==a.getMinutes()};Date.prototype.setDateOnly=function(a){a=new Date(a);this.setDate(1);this.setFullYear(a.getFullYear());this.setMonth(a.getMonth());this.setDate(a.getDate())};
Date.prototype.print=function(a){var e=this.getMonth(),h=this.getDate(),g=this.getFullYear(),j=this.getWeekNumber(),b=this.getDay(),c={},f=this.getHours(),k=f>=12,m=k?f-12:f,n=this.getDayOfYear();if(m==0)m=12;var o=this.getMinutes(),p=this.getSeconds();c["%a"]=Calendar._SDN[b];c["%A"]=Calendar._DN[b];c["%b"]=Calendar._SMN[e];c["%B"]=Calendar._MN[e];c["%C"]=1+Math.floor(g/100);c["%d"]=h<10?"0"+h:h;c["%e"]=h;c["%H"]=f<10?"0"+f:f;c["%I"]=m<10?"0"+m:m;c["%j"]=n<100?n<10?"00"+n:"0"+n:n;c["%k"]=f;c["%l"]=
m;c["%m"]=e<9?"0"+(1+e):1+e;c["%M"]=o<10?"0"+o:o;c["%n"]="\n";c["%p"]=k?"PM":"AM";c["%P"]=k?"pm":"am";c["%s"]=Math.floor(this.getTime()/1E3);c["%S"]=p<10?"0"+p:p;c["%t"]="\t";c["%U"]=c["%W"]=c["%V"]=j<10?"0"+j:j;c["%u"]=b+1;c["%w"]=b;c["%y"]=(""+g).substr(2,2);c["%Y"]=g;c["%%"]="%";e=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)return a.replace(e,function(t){return c[t]||t});h=a.match(e);for(g=0;g<h.length;g++)if(j=c[h[g]]){e=RegExp(h[g],"g");a=a.replace(e,j)}return a};
Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(a){var e=new Date(this);e.__msh_oldSetFullYear(a);e.getMonth()!=this.getMonth()&&this.setDate(28);this.__msh_oldSetFullYear(a)};window._dynarch_popupCalendar=null;Calendar._DN=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];Calendar._SDN=["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"];Calendar._FD=0;
Calendar._MN=["January","February","March","April","May","June","July","August","September","October","November","December"];Calendar._SMN=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Calendar._TT={};Calendar._TT.INFO="About the calendar";
Calendar._TT.ABOUT="DHTML Date/Time Selector\n(c) dynarch.com 2002-2005 / Author: Mihai Bazon\nFor latest version visit: http://www.dynarch.com/projects/calendar/\nDistributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details.\n\nDate selection:\n- Use the \u00ab, \u00bb buttons to select year\n- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n- Hold mouse button on any of the above buttons for faster selection.";
Calendar._TT.ABOUT_TIME="\n\nTime selection:\n- Click on any of the time parts to increase it\n- or Shift-click to decrease it\n- or click and drag for faster selection.";Calendar._TT.PREV_YEAR="Prev. year (hold for menu)";Calendar._TT.PREV_MONTH="Prev. month (hold for menu)";Calendar._TT.GO_TODAY="Go Today";Calendar._TT.NEXT_MONTH="Next month (hold for menu)";Calendar._TT.NEXT_YEAR="Next year (hold for menu)";Calendar._TT.SEL_DATE="Select date";Calendar._TT.DRAG_TO_MOVE="Drag to move";
Calendar._TT.PART_TODAY=" (today)";Calendar._TT.DAY_FIRST="Display %s first";Calendar._TT.WEEKEND="0,6";Calendar._TT.CLOSE="Close";Calendar._TT.TODAY="Today";Calendar._TT.TIME_PART="(Shift-)Click or drag to change value";Calendar._TT.DEF_DATE_FORMAT="%Y-%m-%d";Calendar._TT.TT_DATE_FORMAT="%a, %b %e";Calendar._TT.WK="wk";Calendar._TT.TIME="Time:";
Calendar.setup=function(a){function e(c,f){if(typeof a[c]=="undefined")a[c]=f}function h(c){var f=c.params,k=c.dateClicked||f.electric;if(k&&f.inputField){f.inputField.value=c.date.print(f.ifFormat);typeof f.inputField.onchange=="function"&&f.inputField.onchange()}if(k&&f.displayArea)f.displayArea.innerHTML=c.date.print(f.daFormat);k&&typeof f.onUpdate=="function"&&f.onUpdate(c);k&&f.flat&&typeof f.flatCallback=="function"&&f.flatCallback(c);k&&f.singleClick&&c.dateClicked&&c.callCloseHandler()}e("inputField",
null);e("displayArea",null);e("button",null);e("eventName","click");e("ifFormat","%Y/%m/%d");e("daFormat","%Y/%m/%d");e("singleClick",true);e("disableFunc",null);e("dateStatusFunc",a.disableFunc);e("dateText",null);e("firstDay",null);e("align","Br");e("range",[1900,2999]);e("weekNumbers",true);e("flat",null);e("flatCallback",null);e("onSelect",null);e("onClose",null);e("onUpdate",null);e("date",null);e("showsTime",false);e("timeFormat","24");e("electric",true);e("step",2);e("position",null);e("cache",
false);e("showOthers",false);e("multiple",null);var g=["inputField","displayArea","button"],j;for(j in g)if(typeof a[g[j]]=="string")a[g[j]]=document.getElementById(a[g[j]]);if(!(a.flat||a.multiple||a.inputField||a.displayArea||a.button)){alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(a.flat!=null){if(typeof a.flat=="string")a.flat=document.getElementById(a.flat);if(!a.flat){alert("Calendar.setup:\n  Flat specified but can't find parent.");
return false}var b=new Calendar(a.firstDay,a.date,a.onSelect||h);b.showsOtherMonths=a.showOthers;b.showsTime=a.showsTime;b.time24=a.timeFormat=="24";b.params=a;b.weekNumbers=a.weekNumbers;b.setRange(a.range[0],a.range[1]);b.setDateStatusHandler(a.dateStatusFunc);b.getDateText=a.dateText;a.ifFormat&&b.setDateFormat(a.ifFormat);a.inputField&&typeof a.inputField.value=="string"&&b.parseDate(a.inputField.value);b.create(a.flat);b.show();return false}(a.button||a.displayArea||a.inputField)["on"+a.eventName]=
function(){var c=a.inputField||a.displayArea,f=a.inputField?a.ifFormat:a.daFormat,k=false,m=window.calendar;if(c)a.date=Date.parseDate(c.value||c.innerHTML,f);if(m&&a.cache){a.date&&m.setDate(a.date);m.hide()}else{window.calendar=m=new Calendar(a.firstDay,a.date,a.onSelect||h,a.onClose||function(p){p.hide()});m.showsTime=a.showsTime;m.time24=a.timeFormat=="24";m.weekNumbers=a.weekNumbers;k=true}if(a.multiple){m.multiple={};for(c=a.multiple.length;--c>=0;){var n=a.multiple[c],o=n.print("%Y%m%d");m.multiple[o]=
n}}m.showsOtherMonths=a.showOthers;m.yearStep=a.step;m.setRange(a.range[0],a.range[1]);m.params=a;m.setDateStatusHandler(a.dateStatusFunc);m.getDateText=a.dateText;m.setDateFormat(f);k&&m.create();m.refresh();a.position?m.showAt(a.position[0],a.position[1]):m.showAtElement(a.button||a.displayArea||a.inputField,a.align);return false};return b};
$(document).ready(function(){function a(){try{h.abort()}catch(j){}$("#TotalQuantity").remove();$("#inv_quantity_ajax_throbber").length==0&&$('[name = "quantity"]').after('<div id="inv_quantity_ajax_throbber" class="ajax_throbber" style="float:right"/>');url="/eden/inv/inv_item_quantity/";url+=$('[name = "inv_item_id"]').val();h=$.getJSON(url,function(b){var c=b.inv_inv_item.quantity;b=b.supply_item_pack.quantity;var f=$('[name = "item_pack_id"] option:selected').text(),k=/\(([0-9]*)\sx/.exec(f);TotalQuantity=
'<span id = "TotalQuantity"> / '+(c*b/(k==null?1:k[1])).toFixed(2)+" "+f+" ("+S3.i18n.in_inv+")</span>";$("#inv_quantity_ajax_throbber").remove();$('[name = "quantity"]').after(TotalQuantity)})}function e(){try{h.abort()}catch(j){}var b=$('[name $= "item_id"]'),c=$('[name = "item_pack_id"]');$('[id$="item_pack_id__row1"]').show();$('[id$="item_pack_id__row"]').show();$("#item_pack_ajax_throbber").length==0&&c.after('<div id="item_pack_ajax_throbber" class="ajax_throbber style="display:inline;"/>');
c.hide();var f;f=$('[name = "item_id"]').length!=0?S3.Ap.concat("/supply/item_pack.json?item_pack.item_id=",b.val()):S3.Ap.concat("/inv/inv_item_packs/",b.val());h=$.ajax({url:f,dataType:"json",context:b,success:function(k){var m="",n="";if(k.length==0)m+='<option value="">'+S3.i18n.no_packs+"</options>";else{for(var o=0;o<k.length;o++)if(k[o].quantity==1){n=k[o].name;break}for(o=0;o<k.length;o++){m+='<option value="'+k[o].id+'">';m+=k[o].quantity==1?k[o].name:k[o].name+" ("+k[o].quantity+" x "+n+
")";m+="</option>"}}c.html(m).val(1).show();href=$("#item_pack_add").attr("href")+"&item_id="+$('[name = "item_id"]').val();$("#item_pack_add").attr("href",href).show();$("#item_pack_ajax_throbber").remove();this.attr("name")=="inv_item_id"&&a()}})}var h;$("#inv_send_item_item_pack_id").change(a);var g=$('[name $= "item_id"]').val();if(g==""|g==undefined){$('[id$="item_pack_id__row1"]').hide();$('[id$="item_pack_id__row"]').hide()}else e();$('[name $= "item_id"]').change(e);$(".quantity.ajax_more").live("click",
function(j){j.preventDefault();j=$(this);var b,c;if(j.hasClass("collapsed")){if(j.hasClass("fulfil")){c="inv";b="recv"}else if(j.hasClass("transit")){b="send";c="inv"}else if(j.hasClass("commit")){b="commit";c="req"}j.after('<div class="ajax_throbber quantity_req_ajax_throbber"/>').removeClass("collapsed").addClass("expanded");var f=/req_item\/(.*)\//i.exec($(".action-btn",j.parent().parent().parent()).attr("href"))[1];f=S3.Ap.concat("/",c,"/",b,"_item_json/",f);$.ajax({url:f,dataType:"json",context:j,
success:function(k){RecvTable='<table class="recv_table">';for(i=0;i<k.length;i++){RecvTable+="<tr><td>";if(i==0)RecvTable+=k[0].id;else{RecvURL=S3.Ap.concat("/",c,"/",b,"/",k[i].id);RecvTable+="<a href = '"+RecvURL+"'>";RecvTable+=k[i].datetime!=null?k[i].datetime.substring(0,10)+"</a>":" - </a>"}RecvTable+="</td><td>"+k[i].quantity+"</td></tr>"}RecvTable+="</table>";$(".quantity_req_ajax_throbber",this.parent()).remove();this.parent().after(RecvTable)}})}else{j.removeClass("expanded").addClass("collapsed");
$(".recv_table",j.parent().parent()).remove()}})});
(function(a,e){function h(v,G){v=v?' id="'+o+v+'"':"";G=G?' style="'+G+'"':"";return a("<div"+v+G+"/>")}function g(v,G){G=G==="x"?O.width():O.height();return typeof v==="string"?Math.round(/%/.test(v)?G/100*parseInt(v,10):parseInt(v,10)):v}function j(v){return s.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(v)}function b(v){for(var G in v)if(a.isFunction(v[G])&&G.substring(0,2)!=="on")v[G]=v[G].call(X);v.rel=v.rel||X.rel||"nofollow";v.href=v.href||a(X).attr("href");v.title=v.title||
X.title;return v}function c(v,G){G&&G.call(X);a.event.trigger(v)}function f(){var v,G=o+"Slideshow_",D="click."+o,S,V;if(s.slideshow&&M[1]){S=function(){W.text(s.slideshowStop).unbind(D).bind(w,function(){if(K<M.length-1||s.loop)v=setTimeout(A.next,s.slideshowSpeed)}).bind(t,function(){clearTimeout(v)}).one(D+" "+x,V);H.removeClass(G+"off").addClass(G+"on");v=setTimeout(A.next,s.slideshowSpeed)};V=function(){clearTimeout(v);W.text(s.slideshowStart).unbind([w,t,x,D].join(" ")).one(D,S);H.removeClass(G+
"on").addClass(G+"off")};s.slideshowAuto?S():V()}}function k(v){if(!F){X=v;s=b(a.extend({},a.data(X,n)));M=a(X);K=0;if(s.rel!=="nofollow"){M=a("."+ka).filter(function(){return(a.data(this,n).rel||this.rel)===s.rel});K=M.index(X);if(K===-1){M=M.add(X);K=M.length-1}}if(!ea){ea=ma=true;H.show();if(s.returnFocus)try{X.blur();a(X).one(u,function(){try{this.focus()}catch(D){}})}catch(G){}P.css({opacity:+s.opacity,cursor:s.overlayClose?"pointer":"auto"}).show();s.w=g(s.initialWidth,"x");s.h=g(s.initialHeight,
"y");A.position(0);B&&O.bind("resize."+C+" scroll."+C,function(){P.css({width:O.width(),height:O.height(),top:O.scrollTop(),left:O.scrollLeft()})}).trigger("scroll."+C);c(p,s.onOpen);L.add(Z).add(ga).add(W).add(ca).hide();R.html(s.close).show()}A.load(true)}}var m={transition:"elastic",speed:300,width:false,initialWidth:"600",innerWidth:false,maxWidth:false,height:false,initialHeight:"450",innerHeight:false,maxHeight:false,scalePhotos:true,scrolling:true,inline:false,html:false,iframe:false,photo:false,
href:false,title:false,rel:false,opacity:0.9,preloading:true,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:false,returnFocus:true,loop:true,slideshow:false,slideshowAuto:true,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:false,onLoad:false,onComplete:false,onCleanup:false,onClosed:false,overlayClose:true,escKey:true,arrowKey:true},n="colorbox",o="cbox",p=o+"_open",t=o+"_load",w=o+"_complete",x=o+"_cleanup",u=o+
"_closed",r=o+"_purge",y=o+"_loaded",z=a.browser.msie&&!a.support.opacity,B=z&&a.browser.version<7,C=o+"_IE6",P,H,E,J,aa,ha,da,ja,M,O,N,I,T,ca,L,W,ga,Z,R,U,ia,fa,Y,X,K,s,ea,ma,F=false,A,ka=o+"Element";A=a.fn[n]=a[n]=function(v,G){var D=this,S;if(!D[0]&&D.selector)return D;v=v||{};if(G)v.onComplete=G;if(!D[0]||D.selector===undefined){D=a("<a/>");v.open=true}D.each(function(){a.data(this,n,a.extend({},a.data(this,n)||m,v));a(this).addClass(ka)});S=v.open;if(a.isFunction(S))S=S.call(D);S&&k(D[0]);return D};
A.init=function(){O=a(e);H=h().attr({id:n,"class":z?o+"IE":""});P=h("Overlay",B?"position:absolute":"").hide();E=h("Wrapper");J=h("Content").append(N=h("LoadedContent","width:0; height:0; overflow:hidden"),T=h("LoadingOverlay").add(h("LoadingGraphic")),ca=h("Title"),L=h("Current"),ga=h("Next"),Z=h("Previous"),W=h("Slideshow").bind(p,f),R=h("Close"));E.append(h().append(h("TopLeft"),aa=h("TopCenter"),h("TopRight")),h(false,"clear:left").append(ha=h("MiddleLeft"),J,da=h("MiddleRight")),h(false,"clear:left").append(h("BottomLeft"),
ja=h("BottomCenter"),h("BottomRight"))).children().children().css({"float":"left"});I=h(false,"position:absolute; width:9999px; visibility:hidden; display:none");a("body").prepend(P,H.append(E,I));J.children().hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).addClass("hover");U=aa.height()+ja.height()+J.outerHeight(true)-J.height();ia=ha.width()+da.width()+J.outerWidth(true)-J.width();fa=N.outerHeight(true);Y=N.outerWidth(true);H.css({"padding-bottom":U,"padding-right":ia}).hide();
ga.click(A.next);Z.click(A.prev);R.click(A.close);J.children().removeClass("hover");a("."+ka).live("click",function(v){if(!(v.button!==0&&typeof v.button!=="undefined"||v.ctrlKey||v.shiftKey||v.altKey)){v.preventDefault();k(this)}});P.click(function(){s.overlayClose&&A.close()});a(document).bind("keydown",function(v){if(ea&&s.escKey&&v.keyCode===27){v.preventDefault();A.close()}if(ea&&s.arrowKey&&!ma&&M[1])if(v.keyCode===37&&(K||s.loop)){v.preventDefault();Z.click()}else if(v.keyCode===39&&(K<M.length-
1||s.loop)){v.preventDefault();ga.click()}})};A.remove=function(){H.add(P).remove();a("."+ka).die("click").removeData(n).removeClass(ka)};A.position=function(v,G){function D(ba){aa[0].style.width=ja[0].style.width=J[0].style.width=ba.style.width;T[0].style.height=T[1].style.height=J[0].style.height=ha[0].style.height=da[0].style.height=ba.style.height}var S,V=Math.max(document.documentElement.clientHeight-s.h-fa-U,0)/2+O.scrollTop(),Q=Math.max(O.width()-s.w-Y-ia,0)/2+O.scrollLeft();S=H.width()===
s.w+Y&&H.height()===s.h+fa?0:v;E[0].style.width=E[0].style.height="9999px";H.dequeue().animate({width:s.w+Y,height:s.h+fa,top:V,left:Q},{duration:S,complete:function(){D(this);ma=false;E[0].style.width=s.w+Y+ia+"px";E[0].style.height=s.h+fa+U+"px";G&&G()},step:function(){D(this)}})};A.resize=function(v){if(ea){v=v||{};if(v.width)s.w=g(v.width,"x")-Y-ia;if(v.innerWidth)s.w=g(v.innerWidth,"x");N.css({width:s.w});if(v.height)s.h=g(v.height,"y")-fa-U;if(v.innerHeight)s.h=g(v.innerHeight,"y");if(!v.innerHeight&&
!v.height){v=N.wrapInner("<div style='overflow:auto'></div>").children();s.h=v.height();v.replaceWith(v.children())}N.css({height:s.h});A.position(s.transition==="none"?0:s.speed)}};A.prep=function(v){function G(V){var Q,ba,la,na,oa=M.length,pa=s.loop;A.position(V,function(){function qa(){z&&H[0].style.removeAttribute("filter")}if(ea){z&&D&&N.fadeIn(100);N.show();c(y);ca.show().html(s.title);if(oa>1){typeof s.current==="string"&&L.html(s.current.replace(/\{current\}/,K+1).replace(/\{total\}/,oa)).show();
ga[pa||K<oa-1?"show":"hide"]().html(s.next);Z[pa||K?"show":"hide"]().html(s.previous);Q=K?M[K-1]:M[oa-1];la=K<oa-1?M[K+1]:M[0];s.slideshow&&W.show();if(s.preloading){na=a.data(la,n).href||la.href;ba=a.data(Q,n).href||Q.href;na=a.isFunction(na)?na.call(la):na;ba=a.isFunction(ba)?ba.call(Q):ba;if(j(na))a("<img/>")[0].src=na;if(j(ba))a("<img/>")[0].src=ba}}T.hide();s.transition==="fade"?H.fadeTo(S,1,function(){qa()}):qa();O.bind("resize."+o,function(){A.position(0)});c(w,s.onComplete)}})}if(ea){var D,
S=s.transition==="none"?0:s.speed;O.unbind("resize."+o);N.remove();N=h("LoadedContent").html(v);N.hide().appendTo(I.show()).css({width:function(){s.w=s.w||N.width();s.w=s.mw&&s.mw<s.w?s.mw:s.w;return s.w}(),overflow:s.scrolling?"auto":"hidden"}).css({height:function(){s.h=s.h||N.height();s.h=s.mh&&s.mh<s.h?s.mh:s.h;return s.h}()}).prependTo(J);I.hide();a("#"+o+"Photo").css({cssFloat:"none",marginLeft:"auto",marginRight:"auto"});B&&a("select").not(H.find("select")).filter(function(){return this.style.visibility!==
"hidden"}).css({visibility:"hidden"}).one(x,function(){this.style.visibility="inherit"});s.transition==="fade"?H.fadeTo(S,0,function(){G(0)}):G(S)}};A.load=function(v){var G,D,S,V=A.prep;ma=true;X=M[K];v||(s=b(a.extend({},a.data(X,n))));c(r);c(t,s.onLoad);s.h=s.height?g(s.height,"y")-fa-U:s.innerHeight&&g(s.innerHeight,"y");s.w=s.width?g(s.width,"x")-Y-ia:s.innerWidth&&g(s.innerWidth,"x");s.mw=s.w;s.mh=s.h;if(s.maxWidth){s.mw=g(s.maxWidth,"x")-Y-ia;s.mw=s.w&&s.w<s.mw?s.w:s.mw}if(s.maxHeight){s.mh=
g(s.maxHeight,"y")-fa-U;s.mh=s.h&&s.h<s.mh?s.h:s.mh}G=s.href;T.show();if(s.inline){h().hide().insertBefore(a(G)[0]).one(r,function(){a(this).replaceWith(N.children())});V(a(G))}else if(s.iframe){H.one(y,function(){var Q=a("<iframe frameborder='0' style='width:100%; height:100%; border:0; display:block'/>")[0];Q.name=o+ +new Date;Q.src=s.href;if(!s.scrolling)Q.scrolling="no";if(z)Q.allowtransparency="true";a(Q).appendTo(N).one(r,function(){Q.src="//about:blank"})});V(" ")}else if(s.html)V(s.html);
else if(j(G)){D=new Image;D.onload=function(){var Q;D.onload=null;D.id=o+"Photo";a(D).css({border:"none",display:"block",cssFloat:"left"});if(s.scalePhotos){S=function(){D.height-=D.height*Q;D.width-=D.width*Q};if(s.mw&&D.width>s.mw){Q=(D.width-s.mw)/D.width;S()}if(s.mh&&D.height>s.mh){Q=(D.height-s.mh)/D.height;S()}}if(s.h)D.style.marginTop=Math.max(s.h-D.height,0)/2+"px";if(M[1]&&(K<M.length-1||s.loop))a(D).css({cursor:"pointer"}).click(A.next);if(z)D.style.msInterpolationMode="bicubic";setTimeout(function(){V(D)},
1)};setTimeout(function(){D.src=G},1)}else G&&I.load(G,function(Q,ba,la){V(ba==="error"?"Request unsuccessful: "+la.statusText:a(this).children())})};A.next=function(){if(!ma){K=K<M.length-1?K+1:0;A.load()}};A.prev=function(){if(!ma){K=K?K-1:M.length-1;A.load()}};A.close=function(){if(ea&&!F){F=true;ea=false;c(x,s.onCleanup);O.unbind("."+o+" ."+C);P.fadeTo("fast",0);H.stop().fadeTo("fast",0,function(){c(r);N.remove();H.add(P).css({opacity:1,cursor:"auto"}).hide();setTimeout(function(){F=false;c(u,
s.onClosed)},1)})}};A.element=function(){return a(X)};A.settings=m;a(A.init)})(jQuery,this);
(function(a,e){function h(){this.debug=true;this._curInst=null;this._isInline=false;this._disabledInputs=[];this._inDialog=this._timepickerShowing=false;this._dialogClass="ui-timepicker-dialog";this._mainDivId="ui-timepicker-div";this._inlineClass="ui-timepicker-inline";this._currentClass="ui-timepicker-current";this._dayOverClass="ui-timepicker-days-cell-over";this.regional=[];this.regional[""]={hourText:"Hour",minuteText:"Minute",amPmText:["AM","PM"]};this._defaults={showOn:"focus",showAnim:"fadeIn",
showOptions:{},appendText:"",onSelect:null,onClose:null,timeSeparator:":",showPeriod:false,showLeadingZero:true,showMinutesLeadingZero:true,altField:"",defaultTime:""};a.extend(this._defaults,this.regional[""]);this.tpDiv=a('<div id="'+this._mainDivId+'" class="ui-timepicker ui-widget ui-helper-clearfix ui-corner-all " style="display: none"></div>')}function g(b,c){a.extend(b,c);for(var f in c)if(c[f]==null||c[f]==e)b[f]=c[f];return b}a.extend(a.ui,{timepicker:{version:"0.0.1"}});var j=(new Date).getTime();
a.extend(h.prototype,{markerClassName:"hasTimepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetTimepicker:function(){return this.tpDiv},setDefaults:function(b){g(this._defaults,b||{});return this},_attachTimepicker:function(b,c){var f=null,k;for(k in this._defaults){var m=b.getAttribute("time:"+k);if(m){f=f||{};try{f[k]=eval(m)}catch(n){f[k]=m}}}k=b.nodeName.toLowerCase();m=k=="div"||k=="span";if(!b.id){this.uuid+=1;b.id="tp"+this.uuid}var o=this._newInst(a(b),m);o.settings=
a.extend({},c||{},f||{});if(k=="input")this._connectTimepicker(b,o);else m&&this._inlineTimepicker(b,o)},_newInst:function(b,c){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,tpDiv:!c?this.tpDiv:a('<div class="'+this._inlineClass+' ui-timepicker ui-widget  ui-helper-clearfix"></div>')}},_connectTimepicker:function(b,c){var f=a(b);c.append=a([]);c.trigger=a([]);if(!f.hasClass(this.markerClassName)){this._attachments(f,
c);f.addClass(this.markerClassName).keydown(this._doKeyDown).keyup(this._doKeyUp).bind("setData.timepicker",function(k,m,n){c.settings[m]=n}).bind("getData.timepicker",function(k,m){return this._get(c,m)});a.data(b,"timepicker",c)}},_doKeyDown:function(b){var c=true;a.timepicker._getInst(b.target)._keyEvent=true;if(a.timepicker._timepickerShowing)switch(b.keyCode){case 9:a.timepicker._hideTimepicker();c=false;break;case 27:a.timepicker._hideTimepicker();break;default:c=false}else if(b.keyCode==36&&
b.ctrlKey)a.timepicker._showTimepicker(this);else c=false;if(c){b.preventDefault();b.stopPropagation()}},_doKeyUp:function(b){b=a.timepicker._getInst(b.target);a.timepicker._setTimeFromField(b);a.timepicker._updateTimepicker(b)},_attachments:function(b,c){var f=this._get(c,"appendText"),k=this._get(c,"isRTL");c.append&&c.append.remove();if(f){c.append=a('<span class="'+this._appendClass+'">'+f+"</span>");b[k?"before":"after"](c.append)}b.unbind("focus",this._showTimepicker);c.trigger&&c.trigger.remove();
f=this._get(c,"showOn");if(f=="focus"||f=="both")b.focus(this._showTimepicker);if(f=="button"||f=="both"){f=this._get(c,"buttonText");var m=this._get(c,"buttonImage");c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:m,alt:f,title:f}):a('<button type="button"></button>').addClass(this._triggerClass).html(m==""?f:a("<img/>").attr({src:m,alt:f,title:f})));b[k?"before":"after"](c.trigger);c.trigger.click(function(){a.timepicker._timepickerShowing&&a.timepicker._lastInput==
b[0]?a.timepicker._hideTimepicker():a.timepicker._showTimepicker(b[0]);return false})}},_inlineTimepicker:function(b,c){var f=a(b);if(!f.hasClass(this.markerClassName)){f.addClass(this.markerClassName).append(c.tpDiv).bind("setData.timepicker",function(k,m,n){c.settings[m]=n}).bind("getData.timepicker",function(k,m){return this._get(c,m)});a.data(b,"timepicker",c);this._setTimeFromField(c);this._updateTimepicker(c);c.tpDiv.show()}},_showTimepicker:function(b){b=b.target||b;if(b.nodeName.toLowerCase()!=
"input")b=a("input",b.parentNode)[0];if(!(a.timepicker._isDisabledTimepicker(b)||a.timepicker._lastInput==b)){var c=a.timepicker._getInst(b);a.timepicker._curInst&&a.timepicker._curInst!=c&&a.timepicker._curInst.tpDiv.stop(true,true);var f=a.timepicker._get(c,"beforeShow");g(c.settings,f?f.apply(b,[b,c]):{});c.lastVal=null;a.timepicker._lastInput=b;a.timepicker._setTimeFromField(c);if(a.timepicker._inDialog)b.value="";if(!a.timepicker._pos){a.timepicker._pos=a.timepicker._findPos(b);a.timepicker._pos[1]+=
b.offsetHeight}var k=false;a(b).parents().each(function(){k|=a(this).css("position")=="fixed";return!k});if(k&&a.browser.opera){a.timepicker._pos[0]-=document.documentElement.scrollLeft;a.timepicker._pos[1]-=document.documentElement.scrollTop}f={left:a.timepicker._pos[0],top:a.timepicker._pos[1]};a.timepicker._pos=null;c.tpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.timepicker._updateTimepicker(c);c._hoursClicked=false;c._minutesClicked=false;f=a.timepicker._checkOffset(c,f,k);
c.tpDiv.css({position:a.timepicker._inDialog&&a.blockUI?"static":k?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!c.inline){f=a.timepicker._get(c,"showAnim");var m=a.timepicker._get(c,"duration"),n=function(){a.timepicker._timepickerShowing=true;var o=a.timepicker._getBorders(c.tpDiv);c.tpDiv.find("iframe.ui-timepicker-cover").css({left:-o[0],top:-o[1],width:c.tpDiv.outerWidth(),height:c.tpDiv.outerHeight()})};c.tpDiv.zIndex(a(b).zIndex()+1);a.effects&&a.effects[f]?c.tpDiv.show(f,
a.timepicker._get(c,"showOptions"),m,n):c.tpDiv[f||"show"](f?m:null,n);if(!f||!m)n();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();a.timepicker._curInst=c}}},_updateTimepicker:function(b){var c=this,f=a.timepicker._getBorders(b.tpDiv);b.tpDiv.empty().append(this._generateHTML(b)).find("iframe.ui-timepicker-cover").css({left:-f[0],top:-f[1],width:b.tpDiv.outerWidth(),height:b.tpDiv.outerHeight()}).end().find(".ui-timepicker td a").bind("mouseout",function(){a(this).removeClass("ui-state-hover");
this.className.indexOf("ui-timepicker-prev")!=-1&&a(this).removeClass("ui-timepicker-prev-hover");this.className.indexOf("ui-timepicker-next")!=-1&&a(this).removeClass("ui-timepicker-next-hover")}).bind("mouseover",function(){if(!c._isDisabledTimepicker(b.inline?b.tpDiv.parent()[0]:b.input[0])){a(this).parents(".ui-timepicker-calendar").find("a").removeClass("ui-state-hover");a(this).addClass("ui-state-hover");this.className.indexOf("ui-timepicker-prev")!=-1&&a(this).addClass("ui-timepicker-prev-hover");
this.className.indexOf("ui-timepicker-next")!=-1&&a(this).addClass("ui-timepicker-next-hover")}}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end()},_generateHTML:function(b){var c,f="",k=this._get(b,"showPeriod")==true,m=this._get(b,"showLeadingZero")==true,n=this._get(b,"showMinutesLeadingZero")==true,o=this._get(b,"amPmText");f='<table class="ui-timepicker-table ui-widget-content ui-corner-all"><tr><td class="ui-timepicker-hours"><div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+
this._get(b,"hourText")+'</div><table class="ui-timepicker">';f+='<tr><th rowspan="2" class="periods">'+o[0]+"</th>";for(c=0;c<=5;c++)f+=this._generateHTMLHourCell(b,c,k,m);f+="</tr><tr>";for(c=6;c<=11;c++)f+=this._generateHTMLHourCell(b,c,k,m);f+='</tr><tr><th rowspan="2" class="periods">'+o[1]+"</th>";for(c=12;c<=17;c++)f+=this._generateHTMLHourCell(b,c,k,m);f+="</tr><tr>";for(c=18;c<=23;c++)f+=this._generateHTMLHourCell(b,c,k,m);f+='</tr></table></td><td class="ui-timepicker-minutes"><div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+
this._get(b,"minuteText")+'</div><table class="ui-timepicker"><tr>';for(c=0;c<15;c+=5)f+=this._generateHTMLMinuteCell(b,c,c<10&&n?"0"+c.toString():c.toString());f+="</tr><tr>";for(c=15;c<30;c+=5)f+=this._generateHTMLMinuteCell(b,c,c.toString());f+="</tr><tr>";for(c=30;c<45;c+=5)f+=this._generateHTMLMinuteCell(b,c,c.toString());f+="</tr><tr>";for(c=45;c<60;c+=5)f+=this._generateHTMLMinuteCell(b,c,c.toString());f+="</tr></table></td></tr></table>";return f},_generateHTMLHourCell:function(b,c,f,k){var m=
c;if(c>12&&f)m=c-12;if(m==0&&f)m=12;if(m<10&&k)m="0"+m;return'<td onclick="TP_jQuery_'+j+".timepicker.selectHours('#"+b.id+"', "+c.toString()+', this ); return false;" ondblclick="TP_jQuery_'+j+".timepicker.selectHours('#"+b.id+"', "+c.toString()+', this, true ); return false;" ><a href="#" class="ui-state-default '+(c==b.hours?"ui-state-active":"")+'">'+m.toString()+"</a></td>"},_generateHTMLMinuteCell:function(b,c,f){return'<td onclick="TP_jQuery_'+j+".timepicker.selectMinutes('#"+b.id+"', "+c.toString()+
', this ); return false;" ondblclick="TP_jQuery_'+j+".timepicker.selectMinutes('#"+b.id+"', "+c.toString()+', this, true ); return false;" ><a href="#" class="ui-state-default '+(c==b.minutes?"ui-state-active":"")+'" >'+f+"</a></td>"},_isDisabledTimepicker:function(b){if(!b)return false;for(var c=0;c<this._disabledInputs.length;c++)if(this._disabledInputs[c]==b)return true;return false},_checkOffset:function(b,c,f){var k=b.tpDiv.outerWidth(),m=b.tpDiv.outerHeight(),n=b.input?b.input.outerWidth():
0,o=b.input?b.input.outerHeight():0,p=document.documentElement.clientWidth+a(document).scrollLeft(),t=document.documentElement.clientHeight+a(document).scrollTop();c.left-=this._get(b,"isRTL")?k-n:0;c.left-=f&&c.left==b.input.offset().left?a(document).scrollLeft():0;c.top-=f&&c.top==b.input.offset().top+o?a(document).scrollTop():0;c.left-=Math.min(c.left,c.left+k>p&&p>k?Math.abs(c.left+k-p):0);c.top-=Math.min(c.top,c.top+m>t&&t>m?Math.abs(m+o):0);return c},_findPos:function(b){for(var c=this._get(this._getInst(b),
"isRTL");b&&(b.type=="hidden"||b.nodeType!=1);)b=b[c?"previousSibling":"nextSibling"];b=a(b).offset();return[b.left,b.top]},_getBorders:function(b){var c=function(f){return{thin:1,medium:2,thick:3}[f]||f};return[parseFloat(c(b.css("border-left-width"))),parseFloat(c(b.css("border-top-width")))]},_checkExternalClick:function(b){if(a.timepicker._curInst){b=a(b.target);b[0].id!=a.timepicker._mainDivId&&b.parents("#"+a.timepicker._mainDivId).length==0&&!b.hasClass(a.timepicker.markerClassName)&&!b.hasClass(a.timepicker._triggerClass)&&
a.timepicker._timepickerShowing&&!(a.timepicker._inDialog&&a.blockUI)&&a.timepicker._hideTimepicker()}},_hideTimepicker:function(b){var c=this._curInst;if(!(!c||b&&c!=a.data(b,"timepicker")))if(this._timepickerShowing){b=this._get(c,"showAnim");var f=this._get(c,"duration"),k=function(){a.timepicker._tidyDialog(c);this._curInst=null};a.effects&&a.effects[b]?c.tpDiv.hide(b,a.timepicker._get(c,"showOptions"),f,k):c.tpDiv[b=="slideDown"?"slideUp":b=="fadeIn"?"fadeOut":"hide"](b?f:null,k);b||k();if(b=
this._get(c,"onClose"))b.apply(c.input?c.input[0]:null,[c.input?c.input.val():"",c]);this._timepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(a.blockUI){a.unblockUI();a("body").append(this.tpDiv)}}this._inDialog=false}},_tidyDialog:function(b){b.tpDiv.removeClass(this._dialogClass).unbind(".ui-timepicker")},_getInst:function(b){try{return a.data(b,"timepicker")}catch(c){throw"Missing instance data for this timepicker";
}},_get:function(b,c){return b.settings[c]!==e?b.settings[c]:this._defaults[c]},_setTimeFromField:function(b){if(b.input.val()!=b.lastVal){var c=this._get(b,"defaultTime"),f=this._getCurrentTimeRounded(b);if(c!="")f=c;if(b.inline==false&&b.input.val()!="")f=b.input.val();c=b.lastVal=f;c=this.parseTime(b,c);b.hours=c.hours;b.minutes=c.minutes}},_getCurrentTimeRounded:function(b){var c=new Date;b=this._get(b,"timeSeparator");var f=c.getMinutes();f=Math.round(f/5)*5;return c.getHours().toString()+b+
f.toString()},parseTime:function(b,c){var f={};f.hours=-1;f.minutes=-1;var k=this._get(b,"timeSeparator"),m=this._get(b,"amPmText");k=c.indexOf(k);if(k==-1)return f;f.hours=parseInt(c.substr(0,k),10);f.minutes=parseInt(c.substr(k+1),10);k=this._get(b,"showPeriod")==true;var n=c.toUpperCase();if(f.hours<12&&k&&n.indexOf(m[1].toUpperCase())!=-1)f.hours+=12;if(f.hours==12&&k&&n.indexOf(m[0].toUpperCase())!=-1)f.hours=0;return f},selectHours:function(b,c,f,k){b=this._getInst(a(b)[0]);a(f).parents(".ui-timepicker-hours:first").find("a").removeClass("ui-state-active");
a(f).children("a").addClass("ui-state-active");b.hours=c;this._updateSelectedValue(b);b._hoursClicked=true;if(b._minutesClicked||k)a.timepicker._hideTimepicker()},selectMinutes:function(b,c,f,k){b=this._getInst(a(b)[0]);a(f).parents(".ui-timepicker-minutes:first").find("a").removeClass("ui-state-active");a(f).children("a").addClass("ui-state-active");b.minutes=c;this._updateSelectedValue(b);b._minutesClicked=true;if(b._hoursClicked||k)a.timepicker._hideTimepicker()},_updateSelectedValue:function(b){if(b.hours<
0||b.hours>23)b.hours=12;if(b.minutes<0||b.minutes>59)b.minutes=0;var c="",f=this._get(b,"showPeriod")==true,k=this._get(b,"showLeadingZero")==true,m=this._get(b,"amPmText"),n=b.minutes?b.minutes:0,o=b.hours?b.hours:0;o||(displayHoyrs=0);if(f){if(b.hours==0)o=12;if(b.hours<12)c=m[0];else{c=m[1];if(o>12)o-=12}}f=o.toString();if(k&&o<10)f="0"+f;k=n.toString();if(n<10)k="0"+k;n=f+this._get(b,"timeSeparator")+k;if(c.length>0)n+=" "+c;if(b.input){b.input.val(n);b.input.trigger("change")}if(c=this._get(b,
"onSelect"))c.apply(b.input?b.input[0]:null,[n,b]);this._updateAlternate(b,n);return n},_updateAlternate:function(b,c){var f=this._get(b,"altField");f&&a(f).each(function(){a(this).val(c)})}});a.fn.timepicker=function(b){if(!a.timepicker.initialized){a(document).mousedown(a.timepicker._checkExternalClick).find("body").append(a.timepicker.tpDiv);a.timepicker.initialized=true}var c=Array.prototype.slice.call(arguments,1);if(typeof b=="string"&&(b=="isDisabled"||b=="getDate"||b=="widget"))return a.timepicker["_"+
b+"Datepicker"].apply(a.timepicker,[this[0]].concat(c));if(b=="option"&&arguments.length==2&&typeof arguments[1]=="string")return a.timepicker["_"+b+"Datepicker"].apply(a.timepicker,[this[0]].concat(c));return this.each(function(){typeof b=="string"?a.timepicker["_"+b+"Datepicker"].apply(a.timepicker,[this].concat(c)):a.timepicker._attachTimepicker(this,b)})};a.timepicker=new h;a.timepicker.initialized=false;a.timepicker.uuid=(new Date).getTime();a.timepicker.version="1.8.6";window["TP_jQuery_"+j]=
a})(jQuery);
(function(a){a.cluetip={version:"1.0.7"};var e,h,g,j,b,c,f,k;a.fn.cluetip=function(o,p){if(typeof o=="object"){p=o;o=null}if(o=="destroy")return this.removeData("thisInfo").unbind(".cluetip");return this.each(function(t){function w(){return false}var x=this,u=a(this),r=a.extend(true,{},a.fn.cluetip.defaults,p||{},a.metadata?u.metadata():a.meta?u.data():{}),y=false,z=+r.cluezIndex;u.data("thisInfo",{title:x.title,zIndex:z});var B=false,C=0;if(!a("#cluetip").length){a('<div id="cluetip"><div id="cluetip-outer"><h3 id="cluetip-title"></h3><div id="cluetip-inner"></div></div><div id="cluetip-extra"></div><div id="cluetip-arrows" class="cluetip-arrows"></div></div>')[m](n).hide();e=
a("#cluetip").css({position:"absolute"});g=a("#cluetip-outer").css({position:"relative",zIndex:z});h=a("#cluetip-inner");j=a("#cluetip-title");b=a("#cluetip-arrows");c=a('<div id="cluetip-waitimage"></div>').css({position:"absolute"}).insertBefore(e).hide()}var P=r.dropShadow?+r.dropShadowSteps:0;if(!f){f=a([]);for(var H=0;H<P;H++)f=f.add(a("<div></div>").css({zIndex:z-1,opacity:0.1,top:1+H,left:1+H}));f.css({position:"absolute",backgroundColor:"#000"}).prependTo(e)}var E=u.attr(r.attribute),J=r.cluetipClass;
if(!E&&!r.splitTitle&&!o)return true;if(r.local&&r.localPrefix)E=r.localPrefix+E;r.local&&r.hideLocal&&a(E+":first").hide();var aa=parseInt(r.topOffset,10),ha=parseInt(r.leftOffset,10),da,ja,M=isNaN(parseInt(r.height,10))?"auto":/\D/g.test(r.height)?r.height:r.height+"px",O,N,I,T,ca,L=parseInt(r.width,10)||275,W=L+(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0)+P,ga=this.offsetWidth,Z,R,U,ia,fa,Y=r.attribute!="title"?u.attr(r.titleAttribute):"";if(r.splitTitle){if(Y==
undefined)Y="";fa=Y.split(r.splitTitle);Y=fa.shift()}if(r.escapeTitle)Y=Y.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;");var X=function(F){if(!r.onActivate(u))return false;B=true;e.removeClass().css({width:L});E==u.attr("href")&&u.css("cursor",r.cursor);r.hoverClass&&u.addClass(r.hoverClass);N=u.offset().top;Z=u.offset().left;U=F.pageX;T=F.pageY;if(x.tagName.toLowerCase()!="area"){O=a(document).scrollTop();ia=a(window).width()}if(r.positionBy=="fixed"){R=ga+Z+ha;e.css({left:R})}else{R=
ga>Z&&Z>W||Z+ga+W+ha>ia?Z-W-ha:ga+Z+ha;if(x.tagName.toLowerCase()=="area"||r.positionBy=="mouse"||ga+W>ia)if(U+20+W>ia){e.addClass(" cluetip-"+J);R=U-W-ha>=0?U-W-ha-parseInt(e.css("marginLeft"),10)+parseInt(h.css("marginRight"),10):U-W/2}else R=U+ha;var A=R<0?F.pageY+aa:F.pageY;e.css({left:R>0&&r.positionBy!="bottomTop"?R:U+W/2>ia?ia/2-W/2:Math.max(U-W/2,0),zIndex:u.data("thisInfo").zIndex});b.css({zIndex:u.data("thisInfo").zIndex+1})}ja=a(window).height();if(o){if(typeof o=="function")o=o.call(x);
h.html(o);K(A)}else if(fa){F=fa.length;h.html(F?fa[0]:"");if(F>1)for(var ka=1;ka<F;ka++)h.append('<div class="split-body">'+fa[ka]+"</div>");K(A)}else if(!r.local&&E.indexOf("#")!==0)if(/\.(jpe?g|tiff?|gif|png)$/i.test(E)){h.html('<img src="'+E+'" alt="'+Y+'" />');K(A)}else if(y&&r.ajaxCache){h.html(y);K(A)}else{var v=r.ajaxSettings.beforeSend,G=r.ajaxSettings.error,D=r.ajaxSettings.success,S=r.ajaxSettings.complete;F=a.extend(true,{},r.ajaxSettings,{cache:false,url:E,beforeSend:function(V){v&&v.call(x,
V,e,h);g.children().empty();r.waitImage&&c.css({top:T+20,left:U+20,zIndex:u.data("thisInfo").zIndex-1}).show()},error:function(V,Q){if(B)G?G.call(x,V,Q,e,h):h.html("<i>sorry, the contents could not be loaded</i>")},success:function(V,Q){y=r.ajaxProcess.call(x,V);if(B){D&&D.call(x,V,Q,e,h);h.html(y)}},complete:function(V,Q){S&&S.call(x,V,Q,e,h);var ba=h[0].getElementsByTagName("img");k=ba.length;for(var la=0,na=ba.length;la<na;la++)ba[la].complete&&k--;if(k&&!a.browser.opera)a(ba).bind("load error",
function(){k--;if(k<1){c.hide();B&&K(A)}});else{c.hide();B&&K(A)}}});a.ajax(F)}else if(r.local){F=a(E+(/#\S+$/.test(E)?"":":eq("+t+")")).clone(true).show();h.html(F);K(A)}},K=function(F){e.addClass("cluetip-"+J);if(r.truncate){var A=h.text().slice(0,r.truncate)+"...";h.html(A)}Y?j.show().html(Y):r.showTitle?j.show().html("&nbsp;"):j.hide();if(r.sticky){A=a('<div id="cluetip-close"><a href="#">'+r.closeText+"</a></div>");r.closePosition=="bottom"?A.appendTo(h):r.closePosition=="title"?A.prependTo(j):
A.prependTo(h);A.bind("click.cluetip",function(){ea();return false});r.mouseOutClose?e.bind("mouseleave.cluetip",function(){ea()}):e.unbind("mouseleave.cluetip")}A="";g.css({zIndex:u.data("thisInfo").zIndex,overflow:M=="auto"?"visible":"auto",height:M});da=M=="auto"?Math.max(e.outerHeight(),e.height()):parseInt(M,10);I=N;ca=O+ja;if(r.positionBy=="fixed")I=N-r.dropShadowSteps+aa;else if(R<U&&Math.max(R,0)+W>U||r.positionBy=="bottomTop")if(N+da+aa>ca&&T-O>da+aa){I=T-da-aa;A="top"}else{I=T+aa;A="bottom"}else I=
N+da+aa>ca?da>=ja?O:ca-da-aa:u.css("display")=="block"||x.tagName.toLowerCase()=="area"||r.positionBy=="mouse"?F-aa:N-r.dropShadowSteps;if(A=="")R<Z?A="left":A="right";e.css({top:I+"px"}).removeClass().addClass("clue-"+A+"-"+J).addClass(" cluetip-"+J);if(r.arrows){F=N-I-r.dropShadowSteps;b.css({top:/(left|right)/.test(A)&&R>=0&&F>0?F+"px":/(left|right)/.test(A)?0:""}).show()}else b.hide();f.hide();e.hide()[r.fx.open](r.fx.openSpeed||0);r.dropShadow&&f.css({height:da,width:L,zIndex:u.data("thisInfo").zIndex-
1}).show();a.fn.bgiframe&&e.bgiframe();if(r.delayedClose>0)C=setTimeout(ea,r.delayedClose);r.onShow.call(x,e,h)},s=function(){B=false;c.hide();if(!r.sticky||/click|toggle/.test(r.activation)){ea();clearTimeout(C)}r.hoverClass&&u.removeClass(r.hoverClass)},ea=function(){g.parent().hide().removeClass();r.onHide.call(x,e,h);u.removeClass("cluetip-clicked");Y&&u.attr(r.titleAttribute,Y);u.css("cursor","");r.arrows&&b.css({top:""})};a(document).bind("hideCluetip",function(){ea()});if(/click|toggle/.test(r.activation))u.bind("click.cluetip",
function(F){if(e.is(":hidden")||!u.is(".cluetip-clicked")){X(F);a(".cluetip-clicked").removeClass("cluetip-clicked");u.addClass("cluetip-clicked")}else s(F);this.blur();return false});else if(r.activation=="focus"){u.bind("focus.cluetip",function(F){X(F)});u.bind("blur.cluetip",function(F){s(F)})}else{u[r.clickThrough?"unbind":"bind"]("click",w);var ma=function(F){if(r.tracking==true){var A=R-F.pageX,ka=I?I-F.pageY:N-F.pageY;u.bind("mousemove.cluetip",function(v){e.css({left:v.pageX+A,top:v.pageY+
ka})})}};a.fn.hoverIntent&&r.hoverIntent?u.hoverIntent({sensitivity:r.hoverIntent.sensitivity,interval:r.hoverIntent.interval,over:function(F){X(F);ma(F)},timeout:r.hoverIntent.timeout,out:function(F){s(F);u.unbind("mousemove.cluetip")}}):u.bind("mouseenter.cluetip",function(F){X(F);ma(F)}).bind("mouseleave.cluetip",function(F){s(F);u.unbind("mousemove.cluetip")});u.bind("mouseover.cluetip",function(){u.attr("title","")}).bind("mouseleave.cluetip",function(){u.attr("title",u.data("thisInfo").title)})}})};
a.fn.cluetip.defaults={width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:false,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",
openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(){return true},onShow:function(){},onHide:function(){},ajaxCache:true,ajaxProcess:function(o){return o=o.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"")},ajaxSettings:{dataType:"html"},debug:false};var m="appendTo",n="body";a.cluetip.setup=function(o){if(o&&o.insertionType&&o.insertionType.match(/appendTo|prependTo|insertBefore|insertAfter/))m=o.insertionType;if(o&&
o.insertionElement)n=o.insertionElement}})(jQuery);
(function(a){a.ui=a.ui||{};var e=/left|center|right/,h=/top|center|bottom/,g=a.fn.position,j=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return g.apply(this,arguments);b=a.extend({},b);var c=a(b.of),f=c[0],k=(b.collision||"flip").split(" "),m=b.offset?b.offset.split(" "):[0,0],n,o,p;if(f.nodeType===9){n=c.width();o=c.height();p={top:0,left:0}}else if(f.setTimeout){n=c.width();o=c.height();p={top:c.scrollTop(),left:c.scrollLeft()}}else if(f.preventDefault){b.at="left top";n=o=0;p={top:b.of.pageY,
left:b.of.pageX}}else{n=c.outerWidth();o=c.outerHeight();p=c.offset()}a.each(["my","at"],function(){var t=(b[this]||"").split(" ");if(t.length===1)t=e.test(t[0])?t.concat(["center"]):h.test(t[0])?["center"].concat(t):["center","center"];t[0]=e.test(t[0])?t[0]:"center";t[1]=h.test(t[1])?t[1]:"center";b[this]=t});if(k.length===1)k[1]=k[0];m[0]=parseInt(m[0],10)||0;if(m.length===1)m[1]=m[0];m[1]=parseInt(m[1],10)||0;if(b.at[0]==="right")p.left+=n;else if(b.at[0]==="center")p.left+=n/2;if(b.at[1]==="bottom")p.top+=
o;else if(b.at[1]==="center")p.top+=o/2;p.left+=m[0];p.top+=m[1];return this.each(function(){var t=a(this),w=t.outerWidth(),x=t.outerHeight(),u=parseInt(a.curCSS(this,"marginLeft",true))||0,r=parseInt(a.curCSS(this,"marginTop",true))||0,y=w+u+(parseInt(a.curCSS(this,"marginRight",true))||0),z=x+r+(parseInt(a.curCSS(this,"marginBottom",true))||0),B=a.extend({},p),C;if(b.my[0]==="right")B.left-=w;else if(b.my[0]==="center")B.left-=w/2;if(b.my[1]==="bottom")B.top-=x;else if(b.my[1]==="center")B.top-=
x/2;B.left=Math.round(B.left);B.top=Math.round(B.top);C={left:B.left-u,top:B.top-r};a.each(["left","top"],function(P,H){a.ui.position[k[P]]&&a.ui.position[k[P]][H](B,{targetWidth:n,targetHeight:o,elemWidth:w,elemHeight:x,collisionPosition:C,collisionWidth:y,collisionHeight:z,offset:m,my:b.my,at:b.at})});a.fn.bgiframe&&t.bgiframe();t.offset(a.extend(B,{using:b.using}))})};a.ui.position={fit:{left:function(b,c){var f=a(window);f=c.collisionPosition.left+c.collisionWidth-f.width()-f.scrollLeft();b.left=
f>0?b.left-f:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var f=a(window);f=c.collisionPosition.top+c.collisionHeight-f.height()-f.scrollTop();b.top=f>0?b.top-f:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!=="center"){var f=a(window);f=c.collisionPosition.left+c.collisionWidth-f.width()-f.scrollLeft();var k=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,m=c.at[0]==="left"?c.targetWidth:-c.targetWidth,n=-2*c.offset[0];b.left+=
c.collisionPosition.left<0?k+m+n:f>0?k+m+n:0}},top:function(b,c){if(c.at[1]!=="center"){var f=a(window);f=c.collisionPosition.top+c.collisionHeight-f.height()-f.scrollTop();var k=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,m=c.at[1]==="top"?c.targetHeight:-c.targetHeight,n=-2*c.offset[1];b.top+=c.collisionPosition.top<0?k+m+n:f>0?k+m+n:0}}}};if(!a.offset.setOffset){a.offset.setOffset=function(b,c){if(/static/.test(a.curCSS(b,"position")))b.style.position="relative";var f=a(b),
k=f.offset(),m=parseInt(a.curCSS(b,"top",true),10)||0,n=parseInt(a.curCSS(b,"left",true),10)||0;k={top:c.top-k.top+m,left:c.left-k.left+n};"using"in c?c.using.call(b,k):f.css(k)};a.fn.offset=function(b){var c=this[0];if(!c||!c.ownerDocument)return null;if(b)return this.each(function(){a.offset.setOffset(this,b)});return j.call(this)}}})(jQuery);var S3MultiselectWidgetFileCounter=0;
function S3MultiselectWidgetAddClick(a){var e=a.WidgetID,h=[/DummyDisplay0/g,/DummyDisplay1/g,/DummyDisplay2/g,/DummyDisplay3/g,/DummyDisplay4/g],g=[/DummyJSON0/g,/DummyJSON1/g,/DummyJSON2/g,/DummyJSON3/g,/DummyJSON4/g],j=$("#"+e+"_json").val(),b="{",c,f=true,k=a.NewRow,m="",n="";for(i=0;i<a.ColumnFields.length;i++){var o="#"+e+"_"+a.ColumnFields[i],p=$(o),t=$(o+"_auto_text").val();DisplayValue="";if(p.is("select")){c="'"+p.val()+"'";DisplayValue=$(o+" option:selected").text();p.val("")}else if(t!=
undefined){DisplayValue=t;c=$(o+"_auto_json").val();if(a.ColumnFields[i].slice(-3)=="_id"&&c==""){DisplayValue="";break}$(o+"_auto_text").val("");$(o+"_auto_json").val("");$(o+"_auto_edit").hide()}else if(p.attr("type")=="file"){DisplayValue=p.val();if(DisplayValue!=""){m=o;n=a.ColumnFields[i]+S3MultiselectWidgetFileCounter;c="'"+n+"'";S3MultiselectWidgetFileCounter++}}else{DisplayValue=p.val();p.val("");if(p.attr("class")=="currency")DisplayValue=c.replace("$","");DisplayValue=DisplayValue.replace(/'/g,
'"');c="'"+DisplayValue+"'"}if(DisplayValue!="")f=false;k=k.replace(h[i],DisplayValue);k=k.replace(g[i],c);b=b+"'"+a.ColumnFields[i]+"':"+c+","}b=b.slice(0,-1)+"}";if(!f&&!j.match(b)){if(j!="")j+=",";j+=b;$("#"+e+"_json").val(j);$(k).insertBefore("#"+a.WidgetID+"_input_row");if(m!=""){$(m).attr("id",n);$("#"+n).attr("name",n);$("#"+n).hide();$('<input class="upload" id="drrpp_framework_file_dummy_file" type="file" />').insertAfter("#"+n)}}}
function S3MultiselectWidgetDeleteClick(a,e){var h=e.WidgetID,g=$(a).attr("row_id");$("#"+e.DummyName).val();var j=$("#"+h+"_json").val();$(a).parent().parent().remove();if(g!="New"){if(j!="")j+=",";j=j+"{'id':'"+g+"','deleted':True},"}else{g="{";for(i=0;i<e.ColumnFields.length;i++)g=g+"'"+e.ColumnFields[i]+"':'"+$(a).attr(e.ColumnFields[i])+"',";g=g.slice(0,-1)+"}";j=j.replace(g,"")}j=j.replace(",,",",");if(j.slice(-1)==",")j=j.slice(0,-1);$("#"+h+"_json").val(j)}
jQuery&&function(a){function e(c,f,k){for(var m="",n=0;n<f.length;n++)if(f[n].optgroup){m+='<label class="optGroup">';m+=k.optGroupSelectable?'<input type="checkbox" class="optGroup" />'+f[n].optgroup:f[n].optgroup;m+='</label><div class="optGroupContainer">';m+=e(c,f[n].options,k);m+="</div>"}else{m=m;var o=f[n],p='<label><input type="checkbox" name="'+c+'[]" value="'+o.value+'"';if(o.selected)p+=' checked="checked"';p+=" />"+o.text+"</label>";m=m+p}return m}function h(c){var f=a(this),k=f.next(".multiSelectOptions"),
m=f.data("config"),n=f.data("callback");k.html("");var o="";if(m.selectAll)o+='<label class="selectAll"><input type="checkbox" class="selectAll" />'+m.selectAllText+"</label>";o+=e(f.attr("id"),c,m);k.html(o);c=k.width();o=false;if(k.height()>m.listHeight){k.css("height",m.listHeight+"px");o=true}else k.css("height","");c=o&&c==k.width()?17:0;k.width()+c<f.outerWidth()?k.css("width",f.outerWidth()-2+"px"):k.css("width",k.width()+c+"px");a.fn.bgiframe&&f.next(".multiSelectOptions").bgiframe({width:k.width(),
height:k.height()});m.selectAll&&k.find("INPUT.selectAll").click(function(){k.find("INPUT:checkbox").attr("checked",a(this).attr("checked")).parent("LABEL").toggleClass("checked",a(this).attr("checked"))});if(m.optGroupSelectable){k.addClass("optGroupHasCheckboxes");k.find("INPUT.optGroup").click(function(){a(this).parent().next().find("INPUT:checkbox").attr("checked",a(this).attr("checked")).parent("LABEL").toggleClass("checked",a(this).attr("checked"))})}k.find("INPUT:checkbox").click(function(){a(this).parent("LABEL").toggleClass("checked",
a(this).attr("checked"));b.call(f);f.focus();a(this).parent().parent().hasClass("optGroupContainer")&&j.call(f,a(this).parent().parent().prev());n&&n(a(this))});k.each(function(){a(this).find("INPUT:checked").parent().addClass("checked")});b.call(f);m.optGroupSelectable&&k.find("LABEL.optGroup").each(function(){j.call(f,a(this))});k.find("LABEL:has(INPUT)").hover(function(){a(this).parent().find("LABEL").removeClass("hover");a(this).addClass("hover")},function(){a(this).parent().find("LABEL").removeClass("hover")});
f.keydown(function(p){var t=a(this).next(".multiSelectOptions");if(t.css("visibility")!="hidden"){if(p.keyCode==9){a(this).addClass("focus").trigger("click");a(this).focus().next(":input").focus();return true}if(p.keyCode==27||p.keyCode==37||p.keyCode==39)a(this).addClass("focus").trigger("click");if(p.keyCode==40||p.keyCode==38){var w=t.find("LABEL"),x=w.index(w.filter(".hover")),u=-1;if(x<0)t.find("LABEL:first").addClass("hover");else if(p.keyCode==40&&x<w.length-1)u=x+1;else if(p.keyCode==38&&
x>0)u=x-1;if(u>=0){a(w.get(x)).removeClass("hover");a(w.get(u)).addClass("hover");g(t)}return false}if(p.keyCode==13||p.keyCode==32){p=t.find("LABEL.hover INPUT:checkbox");p.attr("checked",!p.attr("checked")).parent("LABEL").toggleClass("checked",p.attr("checked"));p.hasClass("selectAll")&&t.find("INPUT:checkbox").attr("checked",p.attr("checked")).parent("LABEL").addClass("checked").toggleClass("checked",p.attr("checked"));b.call(f);n&&n(a(this));return false}if(p.keyCode>=33&&p.keyCode<=126){w=t.find("LABEL:startsWith("+
String.fromCharCode(p.keyCode)+")");var r=w.index(w.filter("LABEL.hover"));x=w.filter(function(y){return y>r});w=(x.length>=1?x:w).filter("LABEL:first");if(w.length==1){t.find("LABEL.hover").removeClass("hover");w.addClass("hover");g(t)}}}else{if(p.keyCode==38||p.keyCode==40||p.keyCode==13||p.keyCode==32){a(this).removeClass("focus").trigger("click");t.find("LABEL:first").addClass("hover");return false}if(p.keyCode==9){t.next(":input").focus();return true}}if(p.keyCode==13)return false})}function g(c){var f=
c.find("LABEL.hover").position().top+c.find("LABEL.hover").outerHeight();f>c.innerHeight()&&c.scrollTop(c.scrollTop()+f-c.innerHeight());c.find("LABEL.hover").position().top<0&&c.scrollTop(c.scrollTop()+c.find("LABEL.hover").position().top)}function j(c){if(a(this).data("config").optGroupSelectable){var f=true;a(c).next().find("INPUT:checkbox").each(function(){if(!a(this).attr("checked"))return f=false});a(c).find("INPUT.optGroup").attr("checked",f).parent("LABEL").toggleClass("checked",f)}}function b(){var c=
a(this),f=c.next(".multiSelectOptions"),k=c.data("config"),m=0,n=true,o="";f.find("INPUT:checkbox").not(".selectAll, .optGroup").each(function(){if(a(this).attr("checked")){m++;o=o+a(this).parent().text()+", "}else n=false});o=o.replace(/\s*\,\s*$/,"");if(m==0)c.find("span").html(k.noneSelected);else if(k.oneOrMoreSelected=="*"){c.find("span").html(o);c.attr("title",o)}else c.find("span").html(k.oneOrMoreSelected.replace("%",m));k.selectAll&&f.find("INPUT.selectAll").attr("checked",n).parent("LABEL").toggleClass("checked",
n)}a.extend(a.fn,{multiSelect:function(c,f){c||(c={});if(c.selectAll==undefined)c.selectAll=true;if(c.selectAllText==undefined)c.selectAllText="Select All";if(c.noneSelected==undefined)c.noneSelected="Select options";if(c.oneOrMoreSelected==undefined)c.oneOrMoreSelected="% selected";if(c.optGroupSelectable==undefined)c.optGroupSelectable=false;if(c.listHeight==undefined)c.listHeight=150;a(this).each(function(){var k=a(this),m='<a href="javascript:;" class="multiSelect"><span></span></a>';m+='<div class="multiSelectOptions" style="position: absolute; z-index: 99999; visibility: hidden;"></div>';
a(k).after(m);var n=a(k).next(".multiSelect");n.next(".multiSelectOptions");n.find("span").css("width",a(k).width()+"px");n.data("config",c);n.data("callback",f);var o=[];a(k).children().each(function(){if(this.tagName.toUpperCase()=="OPTGROUP"){var p=[];o.push({optgroup:a(this).attr("label"),options:p});a(this).children("OPTION").each(function(){a(this).val()!=""&&p.push({text:a(this).html(),value:a(this).val(),selected:a(this).attr("selected")})})}else this.tagName.toUpperCase()=="OPTION"&&a(this).val()!=
""&&o.push({text:a(this).html(),value:a(this).val(),selected:a(this).attr("selected")})});a(k).remove();n.attr("id",a(k).attr("id"));h.call(n,o);n.hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(){a(this).hasClass("active")?a(this).multiSelectOptionsHide():a(this).multiSelectOptionsShow();return false}).focus(function(){a(this).addClass("focus")}).blur(function(){a(this).removeClass("focus")});a(document).click(function(p){a(p.target).parents().andSelf().is(".multiSelectOptions")||
n.multiSelectOptionsHide()})})},multiSelectOptionsUpdate:function(c){h.call(a(this),c)},multiSelectOptionsHide:function(){a(this).removeClass("active").removeClass("hover").next(".multiSelectOptions").css("visibility","hidden")},multiSelectOptionsShow:function(){var c=a(this),f=c.next(".multiSelectOptions");c.data("config");a(".multiSelect").multiSelectOptionsHide();f.find("LABEL").removeClass("hover");c.addClass("active").next(".multiSelectOptions").css("visibility","visible");c.focus();c.next(".multiSelectOptions").scrollTop(0);
f=c.position();c.next(".multiSelectOptions").css({top:f.top+a(this).outerHeight()+"px"});c.next(".multiSelectOptions").css({left:f.left+"px"})},selectedValuesString:function(){var c="";a(this).next(".multiSelectOptions").find("INPUT:checkbox:checked").not(".optGroup, .selectAll").each(function(){c+=a(this).attr("value")+","});return c.replace(/\s*\,\s*$/,"")}});a.expr[":"].startsWith=function(c,f,k){f=k[3];if(!f)return false;return eval("/^[/s]*"+f+"/i").test(a(c).text())}}(jQuery);
(function(a){a.fn.elementExists=function(){return jQuery(this).length>0}})(jQuery);(function(a){a.fn.formElementType=function(){return jQuery(this).elementExists()?jQuery(this).attr("type"):""}})(jQuery);(function(a){a.fn.isTextBox=function(){return jQuery(this).formElementType()==="text"}})(jQuery);(function(a){a.fn.isTextArea=function(){return jQuery(this).formElementType()==="textarea"}})(jQuery);(function(a){a.fn.isPassword=function(){return jQuery(this).formElementType()==="password"}})(jQuery);
(function(a){a.fn.isHiddenInput=function(){return jQuery(this).formElementType()==="hidden"}})(jQuery);(function(a){a.fn.isCheckBox=function(){return jQuery(this).formElementType()==="checkbox"}})(jQuery);(function(a){a.fn.isRadioBox=function(){return jQuery(this).formElementType()==="radio"}})(jQuery);(function(a){a.fn.isButton=function(){return jQuery(this).formElementType()==="button"}})(jQuery);(function(a){a.fn.isSubmitButton=function(){return jQuery(this).formElementType()==="submit"}})(jQuery);
(function(a){a.fn.isResetButton=function(){return jQuery(this).formElementType()==="reset"}})(jQuery);(function(a){a.fn.isSelectBox=function(){var e=jQuery(this).formElementType(),h=this.attr("size");return e!=="select-one"?false:typeof h==="undefined"?false:parseInt(h)>1}})(jQuery);(function(a){a.fn.isMultiSelectBox=function(){return jQuery(this).formElementType()==="select-multiple"}})(jQuery);
(function(a){a.fn.isDropDownList=function(){var e=jQuery(this).formElementType(),h=this.attr("size");return e!=="select-one"?false:typeof h==="undefined"?true:parseInt(h)<=1}})(jQuery);(function(a){a.fn.isChecked=function(){return jQuery(this).is(":checked")}})(jQuery);
(function(a){a.fn.isSelected=function(){var e=jQuery(this);if(arguments.length===0)return false;var h=false,g=arguments[0],j=arguments;if(e.isRadioBox()){e=jQuery("input[type='radio'][name='"+e.attr("name")+"'][checked]");if(e.length===1)return g===e.val()}else if(e.isSelectBox()||e.isDropDownList()){e=jQuery("#"+e.attr("id")+" option:selected");if(e.length===1)return g===e.val()}else if(e.isMultiSelectBox()){e=jQuery("#"+e.attr("id")+" option:selected");jQuery.each(e,function(){var b=jQuery(this);
h=false;for(var c=0;c<j.length;c++)if(j[c]===b.val()){h=true;break}})}return h}})(jQuery);
(function(a){a.fn.selectedItem=function(e){var h=jQuery(this);if(typeof e==="undefined"||isNaN(e))e=0;if(h.isRadioBox()){var g=jQuery("input[type='radio'][name='"+h.attr("name")+"'][checked]");if(e>g.length-1)e=g.length-1;else if(e<0)e=0;if(g.length>0)return jQuery(g[e])}else if(h.isSelectBox()||h.isMultiSelectBox()||h.isDropDownList()){g=jQuery("#"+h.attr("id")+" option:selected");if(e>g.length-1)e=g.length-1;else if(e<0)e=0;if(g.length>0)return jQuery(g[e])}return h}})(jQuery);
(function(a){a.fn.firstSelectedItem=function(){return jQuery(this).selectedItem()}})(jQuery);(function(a){a.fn.lastSelectedItem=function(){return jQuery(this).selectedItem(Number.MAX_VALUE)}})(jQuery);(function(a){a.fn.selectedValue=function(){return jQuery(this).selectedItem(0).val()}})(jQuery);
(function(a){a.fn.selectedValues=function(){var e=[],h=jQuery(this);if(h.isMultiSelectBox()){h=jQuery("#"+h.attr("id")+" option:selected");jQuery.each(h,function(){e.push(jQuery(this).val())})}else e.push(h.selectedValue());return e}})(jQuery);
(function(a){a.fn.itemExists=function(e){var h=jQuery(this),g=false;if(h.isRadioBox())g=jQuery("input[type='radio'][name='"+h.attr("name")+"'][value='"+e+"']").length===1;else if(h.isSelectBox()||h.isMultiSelectBox()||h.isDropDownList()){h=jQuery("#"+h.attr("id")+" option");jQuery.each(h,function(){if(jQuery(this).val()===e){g=true;return false}})}else return jQuery(this).val()===e;return g}})(jQuery);
(function(a,e){function h(g){return!a(g).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(!a.ui.version){a.extend(a.ui,{version:"1.8.9",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(g,j){return typeof g==="number"?this.each(function(){var b=this;setTimeout(function(){a(b).focus();j&&j.call(b)},g)}):this._focus.apply(this,arguments)},scrollParent:function(){var g;g=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,
"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!g.length?a(document):g},zIndex:function(g){if(g!==e)return this.css("zIndex",g);if(this.length){g=a(this[0]);for(var j;g.length&&g[0]!==document;){j=g.css("position");
if(j==="absolute"||j==="relative"||j==="fixed"){j=parseInt(g.css("zIndex"),10);if(!isNaN(j)&&j!==0)return j}g=g.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(g){g.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});a.each(["Width","Height"],function(g,j){function b(m,n,o,p){a.each(c,function(){n-=parseFloat(a.curCSS(m,"padding"+this,true))||0;if(o)n-=parseFloat(a.curCSS(m,
"border"+this+"Width",true))||0;if(p)n-=parseFloat(a.curCSS(m,"margin"+this,true))||0});return n}var c=j==="Width"?["Left","Right"]:["Top","Bottom"],f=j.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+j]=function(m){if(m===e)return k["inner"+j].call(this);return this.each(function(){a(this).css(f,b(this,m)+"px")})};a.fn["outer"+j]=function(m,n){if(typeof m!=="number")return k["outer"+j].call(this,m);return this.each(function(){a(this).css(f,
b(this,m,true,n)+"px")})}});a.extend(a.expr[":"],{data:function(g,j,b){return!!a.data(g,b[3])},focusable:function(g){var j=g.nodeName.toLowerCase(),b=a.attr(g,"tabindex");if("area"===j){j=g.parentNode;b=j.name;if(!g.href||!b||j.nodeName.toLowerCase()!=="map")return false;g=a("img[usemap=#"+b+"]")[0];return!!g&&h(g)}return(/input|select|textarea|button|object/.test(j)?!g.disabled:"a"==j?g.href||!isNaN(b):!isNaN(b))&&h(g)},tabbable:function(g){var j=a.attr(g,"tabindex");return(isNaN(j)||j>=0)&&a(g).is(":focusable")}});
a(function(){var g=document.body,j=g.appendChild(j=document.createElement("div"));a.extend(j.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=j.offsetHeight===100;a.support.selectstart="onselectstart"in j;g.removeChild(j).style.display="none"});a.extend(a.ui,{plugin:{add:function(g,j,b){g=a.ui[g].prototype;for(var c in b){g.plugins[c]=g.plugins[c]||[];g.plugins[c].push([j,b[c]])}},call:function(g,j,b){if((j=g.plugins[j])&&g.element[0].parentNode)for(var c=0;c<j.length;c++)g.options[j[c][0]]&&
j[c][1].apply(g.element,b)}},contains:function(g,j){return document.compareDocumentPosition?g.compareDocumentPosition(j)&16:g!==j&&g.contains(j)},hasScroll:function(g,j){if(a(g).css("overflow")==="hidden")return false;var b=j&&j==="left"?"scrollLeft":"scrollTop",c=false;if(g[b]>0)return true;g[b]=1;c=g[b]>0;g[b]=0;return c},isOverAxis:function(g,j,b){return g>j&&g<j+b},isOver:function(g,j,b,c,f,k){return a.ui.isOverAxis(g,b,f)&&a.ui.isOverAxis(j,c,k)}})}})(jQuery);var s3_gis_pullNext;
function s3_gis_dropdown_select(a,e){s3_gis_pullNext=false;$("#gis_location_lat").val("");$("#gis_location_lon").val("");$("#gis_location_addr_street").val("");$("#gis_location_postcode").val("");var h=$("#gis_location_L"+a).val();if(h||e){var g;$.getJSONS3(a==s3_gis_maxlevel?s3_gis_url+"/search.json?filter=%3D&field=level&value=nullnone&parent="+h:s3_gis_url+"/search.json?filter=%3D&field=level&value=L"+(a+1)+"&parent="+h,function(j){if(j.length==0)g=s3_gis_empty_set;else if(j.length==1){g='<option value="'+
j[0].id+'">'+j[0].name+"</option>";s3_gis_pullNext=true}else{g=s3_gis_select_location;for(var b=0;b<j.length;b++)g+='<option value="'+j[b].id+'">'+j[b].name+"</option>"}a==s3_gis_maxlevel?$("#gis_location_").html(g):$("#gis_location_L"+(a+1)).html(g)},false,true);if(a==s3_gis_maxlevel){if(g!=s3_gis_empty_set){$("#gis_location_").removeClass("hidden").show();$("#gis_location_label_").removeClass("hidden").show();$("#gis_location_details-btn").removeClass("hidden").show()}}else{$("#gis_location_L"+
(a+1)).removeClass("hidden").show();$("#gis_location_label_L"+(a+1)).removeClass("hidden").show();$("#gis_location_details-btn").removeClass("hidden").show()}s3_gis_dropdown_hide(a+2);if(s3_gis_pullNext){h=$("#gis_location_L"+(a+1)).val();$("#"+s3_gis_location_id).val(h);s3_gis_dropdown_select(a+1)}else""==$("#gis_location_name").val()&&$("#"+s3_gis_location_id).val(h)}else{s3_gis_dropdown_hide(a+1);0==a&&""==$("#gis_location_name").val()&&$("#"+s3_gis_location_id).val("")}}
function s3_gis_dropdown_hide(a){for(l=a;l<=parseInt(s3_gis_maxlevel);l+=1){$("#gis_location_L"+l).hide().html(s3_gis_loading_locations);$("#gis_location_label_L"+l).hide()}if(a<parseInt(s3_gis_maxlevel)+2){$("#gis_location_").hide().html(s3_gis_loading_locations);$("#gis_location_label_").hide();$("#gis_location_details-btn").hide()}}
function s3_gis_save_location(a,e,h,g,j){var b=$("#gis_location_L5").val();if(undefined==b||""==b){b=$("#gis_location_L4").val();if(undefined==b||""==b){b=$("#gis_location_L3").val();if(undefined==b||""==b){b=$("#gis_location_L2").val();if(undefined==b||""==b){b=$("#gis_location_L1").val();if(undefined==b||""==b)b=$("#gis_location_L0").val()}}}}a=""==S3.gis.uuid?s3_gis_url+"/create.url?name="+a:s3_gis_url+"/update.url?uuid="+S3.gis.uuid+"&name="+a;""==e||""==h||(a=a+"&lat="+e+"&lon="+h);if(""!=g)a=
a+"&addr_street="+g.replace(/\n/g,"%0d");if(""!=j)a=a+"&addr_postcode="+j;undefined==b||""==b||(a=a+"&parent="+b);$.ajax({async:false,url:a,dataType:"json",success:function(c){if(""==S3.gis.uuid&&c.status=="success"){c=c.message.split("=")[1];$("#"+s3_gis_location_id).val(c)}}})}function s3_gis_geolocate(a){var e=a.coords.latitude;a=a.coords.longitude;$("#gis_location_lat").val(e);$("#gis_location_lon").val(a)}var s3_gis_calcDone=false,s3_gis_calcAnswer;
function s3_gis_convertDD(){var a=$("#DDMMSS_deg").val(),e=$("#DDMMSS_min").val(),h=$("#DDMMSS_sec").val(),g=false;if(a=="")a=0;else if(isNaN(a)||a>180||a<-180){alert(s3_gis_degrees_validation_error);g=true}if(e=="")e=0;else if(isNaN(e)||e>60||e<0){alert(s3_gis_minutes_validation_error);g=true}if(h=="")h=0;else if(isNaN(h)||h>60||h<0){alert(s3_gis_seconds_validation_error);g=true}if(g==false){e=e*1+h/60;s3_gis_calcAnswer=a>0?a*1+e/60:a*1-e/60;$("#DDMMSS_dec").val(s3_gis_calcAnswer);s3_gis_calcDone=
true}}function s3_gis_convertGps(){var a=0,e=0;a=$("#gps_deg").val();e=$("#gps_min").val();var h=false;if(a=="")a=0;else if(isNaN(a)||a>180||a<-180){alert(s3_gis_degrees_validation_error);h=true}if(e=="")e=0;else if(isNaN(e)||e>60||e<0){alert(s3_gis_minutes_validation_error);h=true}if(h==false){s3_gis_calcAnswer=a>0?a*1+e/60:a*1-e/60;$("#gps_dec").val(s3_gis_calcAnswer);s3_gis_calcDone=true}}
function s3_gis_convertFillBack(a){if(s3_gis_calcDone==true){a==1?$("#gis_location_lat").attr("value",s3_gis_calcAnswer):$("#gis_location_lon").attr("value",s3_gis_calcAnswer);return true}else alert(s3_gis_no_calculations_error);return false}
$(function(){if(typeof s3_gis_location_id!="undefined"){$("#gis_location_L0").change(function(){s3_gis_dropdown_select(0)});$("#gis_location_L1").change(function(){s3_gis_dropdown_select(1)});$("#gis_location_L2").change(function(){s3_gis_dropdown_select(2)});$("#gis_location_L3").change(function(){s3_gis_dropdown_select(3)});$("#gis_location_L4").change(function(){s3_gis_dropdown_select(4)});$("#gis_location_").change(function(){var e=$(this).val();""==$("#gis_location_name").val()&&$("#"+s3_gis_location_id).val(e)});
$("#gis_location_add-btn").click(function(e){if(""!=S3.gis.uuid){$("body").data("uuid",S3.gis.uuid);S3.gis.uuid=""}var h=$("#gis_location_lat").val(),g=$("#gis_location_lat").val();if(""!=h||""!=g){$("body").data("lat",h);$("body").data("lon",g);$("#gis_location_lat").val("");$("#gis_location_lon").val("")}$("#gis_location_add-btn").hide();$("#gis_location_cancel-btn").removeClass("hidden").show();$("#gis_location_").hide();$("#gis_location_label_").hide();navigator.geolocation&&$("#gis_location_geolocate-btn").removeClass("hidden").show();
$("#gis_location_map-btn").removeClass("hidden").show();$("#gis_location_name_label").removeClass("hidden").show();$("#gis_location_name").removeClass("hidden").show();$("#gis_location_addr_street_label").removeClass("hidden").show();$("#gis_location_addr_street_row").removeClass("hidden").show();$("#gis_location_postcode_label").removeClass("hidden").show();$("#gis_location_postcode_row").removeClass("hidden").show();$("#gis_location_advanced_div").removeClass("hidden").show();e.preventDefault()});
$("#gis_location_advanced_checkbox").change(function(e){if($("#gis_location_advanced_checkbox").is(":checked")){$("#gis_location_lat_label").removeClass("hidden").show();$("#gis_location_lat_row").removeClass("hidden").show();$("#gis_location_lon_label").removeClass("hidden").show();$("#gis_location_lon_row").removeClass("hidden").show()}else{$("#gis_location_lat_label").hide();$("#gis_location_lat_row").hide();$("#gis_location_lon_label").hide();$("#gis_location_lon_row").hide()}e.preventDefault()});
$("#gis_location_search-btn").click(function(e){$(this).hide();$("#gis_location_autocomplete_div").removeClass("hidden").show();e.preventDefault()});$("#gis_location_details-btn").click(function(e){$("#gis_location_map-btn").removeClass("hidden").show();$("#gis_location_addr_street_label").removeClass("hidden").show();$("#gis_location_addr_street_row").removeClass("hidden").show();$("#gis_location_postcode_label").removeClass("hidden").show();$("#gis_location_postcode_row").removeClass("hidden").show();
$("#gis_location_advanced_div").removeClass("hidden").show();e.preventDefault()});$("#gis_location_cancel-btn").click(function(e){S3.gis.uuid=$("body").data("uuid");$("#gis_location_lat").val($("body").data("lat"));$("#gis_location_lon").val($("body").data("lon"));$("#gis_location_cancel-btn").hide();$("#gis_location_name").val("");$("#gis_location_add-btn").show();if(""!=$("#gis_location_").val()){$("#gis_location_").show();$("#gis_location_label_").show();$("#gis_location_details-btn").show()}$("#gis_location_map-btn").hide();
$("#gis_location_name_label").hide();$("#gis_location_name").hide();$("#gis_location_addr_street_label").hide();$("#gis_location_addr_street_row").hide();$("#gis_location_postcode_label").hide();$("#gis_location_postcode_row").hide();$("#gis_location_advanced_div").hide();e.preventDefault()});$("#gis_location_geolocate-btn").click(function(e){navigator.geolocation.getCurrentPosition(s3_gis_geolocate);e.preventDefault()});var a={val:$("#gis_location_autocomplete").val(),accept:false};$("#gis_location_autocomplete").autocomplete({source:s3_gis_url+
"/search.json?filter=~&field=name&exclude_field=level&exclude_value=XX",minLength:2,focus:function(e,h){$("#gis_location_autocomplete").val(h.item.name);return false},select:function(e,h){$("#gis_location_autocomplete").val(h.item.name);$("#"+s3_gis_location_id).val(h.item.id);a.accept=true;var g=h.item.path,j=h.item.id,b,c,f,k,m=[];switch(h.item.level){case "L0":$("#gis_location_L0").val(j);$("#"+s3_gis_location_id).val(j);s3_gis_dropdown_select(0);break;case "L1":if(g){g=g.split("/");if(g.length==
2&&g[1]==j)$("#gis_location_L0").val(g[0]);else{s3_gis_dropdown_select(0,true);$("#gis_location_L1").val(j);$("#"+s3_gis_location_id).val(j);break}}s3_gis_dropdown_select(0,true);$("#gis_location_L1").val(j);$("#"+s3_gis_location_id).val(j);s3_gis_dropdown_select(1);break;case "L2":if(g){g=g.split("/");if(g.length==3&&g[2]==j){$("#gis_location_L0").val(g[0]);b=g[1]}else if(g.length==2&&g[1]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0])$("#gis_location_L0").val(g[0]);else b=g[0];
else{s3_gis_dropdown_select(1,true);$("#gis_location_L2").val(j);$("#"+s3_gis_location_id).val(j);break}}s3_gis_dropdown_select(0,true);$("#gis_location_L1").val(b);s3_gis_dropdown_select(1,true);$("#gis_location_L2").val(j);$("#"+s3_gis_location_id).val(j);s3_gis_dropdown_select(2);break;case "L3":if(g){g=g.split("/");if(g.length==4&&g[3]==j){$("#gis_location_L0").val(g[0]);b=g[1];c=g[2]}else if(g.length==3&&g[2]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);
m=[g[1]]}else{b=g[0];c=g[1]}else if(g.length==2&&g[1]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0])$("#gis_location_L0").val(g[0]);else m=[g[0]];else{s3_gis_dropdown_select(2,true);$("#gis_location_L3").val(j);$("#"+s3_gis_location_id).val(j);break}}s3_gis_dropdown_select(0,true);if(m[0])if(undefined!=$("#gis_location_L1 option[value="+m[0]+"]")[0])b=m[0];$("#gis_location_L1").val(b);s3_gis_dropdown_select(1,true);if(m[0])if(undefined!=$("#gis_location_L2 option[value="+m[0]+"]")[0])c=
m[0];$("#gis_location_L2").val(c);s3_gis_dropdown_select(2,true);$("#gis_location_L3").val(j);$("#"+s3_gis_location_id).val(j);s3_gis_dropdown_select(3);break;case "L4":if(g){g=g.split("/");if(g.length==5&&g[4]==j){$("#gis_location_L0").val(g[0]);b=g[1];c=g[2];f=g[3]}else if(g.length==4&&g[3]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);m=[g[1],g[2]]}else m=[g[0],g[1],g[2]];else if(g.length==3&&g[2]==j)if(undefined!=$("#gis_location_L0 option[value="+
g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);m=[g[1]]}else m=[g[0],g[1]];else if(g.length==2&&g[1]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0])$("#gis_location_L0").val(g[0]);else m=[g[0]];else{s3_gis_dropdown_select(3,true);$("#gis_location_L4").val(j);$("#"+s3_gis_location_id).val(j);break}}s3_gis_dropdown_select(0,true);if(m[0])if(undefined!=$("#gis_location_L1 option[value="+m[0]+"]")[0])b=m[0];$("#gis_location_L1").val(b);s3_gis_dropdown_select(1,true);if(m[0])if(undefined!=
$("#gis_location_L2 option[value="+m[0]+"]")[0])c=m[0];else if(m[1])if(undefined!=$("#gis_location_L2 option[value="+m[1]+"]")[0])c=m[1];$("#gis_location_L2").val(c);s3_gis_dropdown_select(2,true);if(m[0])if(undefined!=$("#gis_location_L3 option[value="+m[0]+"]")[0])f=m[0];else if(m[1])if(undefined!=$("#gis_location_L3 option[value="+m[1]+"]")[0])f=m[1];else if(m[2])if(undefined!=$("#gis_location_L3 option[value="+m[2]+"]")[0])f=m[2];$("#gis_location_L3").val(f);s3_gis_dropdown_select(3,true);$("#gis_location_L4").val(j);
$("#"+s3_gis_location_id).val(j);s3_gis_dropdown_select(4);break;case "L5":break;default:if(g){g=g.split("/");if(g.length==6&&g[5]==j){$("#gis_location_L0").val(g[0]);b=g[1];c=g[2];f=g[4]}else if(g.length==5&&g[4]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);m=[g[1],g[2],g[3]]}else m=[g[0],g[1],g[2],g[3]];else if(g.length==4&&g[3]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);m=[g[1],g[2]]}else m=
[g[0],g[1],g[2]];else if(g.length==3&&g[2]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0]){$("#gis_location_L0").val(g[0]);m=[g[1]]}else m=[g[0],g[1]];else if(g.length==2&&g[1]==j)if(undefined!=$("#gis_location_L0 option[value="+g[0]+"]")[0])$("#gis_location_L0").val(g[0]);else m=[g[0]];else{s3_gis_dropdown_select(4,true);$("#gis_location_").val(j);$("#"+s3_gis_location_id).val(j);break}s3_gis_dropdown_select(0,true);if(m[0])if(undefined!=$("#gis_location_L1 option[value="+m[0]+
"]")[0])b=m[0];$("#gis_location_L1").val(b);s3_gis_dropdown_select(1,true);if(m[0])if(undefined!=$("#gis_location_L2 option[value="+m[0]+"]")[0])c=m[0];else if(m[1])if(undefined!=$("#gis_location_L2 option[value="+m[1]+"]")[0])c=m[1];$("#gis_location_L2").val(c);s3_gis_dropdown_select(2,true);if(m[0])if(undefined!=$("#gis_location_L3 option[value="+m[0]+"]")[0])f=m[0];else if(m[1])if(undefined!=$("#gis_location_L3 option[value="+m[1]+"]")[0])f=m[1];else if(m[2])if(undefined!=$("#gis_location_L3 option[value="+
m[2]+"]")[0])f=m[2];$("#gis_location_L3").val(f);s3_gis_dropdown_select(3);if(m[0])if(undefined!=$("#gis_location_L4 option[value="+m[0]+"]")[0])k=m[0];else if(m[1])if(undefined!=$("#gis_location_L4 option[value="+m[1]+"]")[0])k=m[1];else if(m[2])if(undefined!=$("#gis_location_L4 option[value="+m[2]+"]")[0])k=m[2];else if(m[3])if(undefined!=$("#gis_location_L4 option[value="+m[4]+"]")[0])k=m[3];$("#gis_location_L4").val(k);s3_gis_dropdown_select(4,true);$("#gis_location_").val(j)}$("#"+s3_gis_location_id).val(j)}$("#gis_location_autocomplete_div").hide();
$("#gis_location_search-btn").show();return false}}).data("autocomplete")._renderItem=function(e,h){return $("<li></li>").data("item.autocomplete",h).append("<a>"+h.name+"</a>").appendTo(e)};$("#gis_location_autocomplete").blur(function(){if(!$("#gis_location_autocomplete").val()){$("#"+s3_gis_location_id).val("");a.accept=true}if(a.accept)a.val=$("#gis_location_autocomplete").val();else $("#gis_location_autocomplete").val(a.val);a.accept=false});$("form").submit(function(){S3ClearNavigateAwayConfirm();
var e=$("#gis_location_name").val(),h=$("#gis_location_lat").val(),g=$("#gis_location_lon").val(),j=$("#gis_location_addr_street").val(),b=$("#gis_location_postcode").val();if(""==e)if((""==h||""==g)&&""==j&&""==b)return true;else{e=$("#gis_location_ :selected").text();if(s3_gis_loading_locations.search(e)){$("#gis_location_name").after('<div id="type__error" class="error" style="display: block;">Name field is required!</div>');$("#gis_location_name").focus();s3_navigate_away_confirm&&S3SetNavigateAwayConfirm();
return false}else{S3.gis.lat==$("#gis_location_lat").val()&&S3.gis.lon==$("#gis_location_lon").val()&&S3.gis.addr_street==$("#gis_location_addr_street").val().replace(/\n/g,"%0d")&&S3.gis.postcode==$("#gis_location_postcode").val()||s3_gis_save_location(e,h,g,j,b);return true}}s3_gis_save_location(e,h,g,j,b);return true})}});
Ext.onReady(function(){var a,e=Ext.get("gis_location_converter-btn"),h=Ext.get("gis_location_map-btn");h&&h.on("click",function(){mapWin.show(this)});e&&e.on("click",function(){a||(a=new Ext.Window({applyTo:"gis-convert-win",layout:"fit",width:400,height:250,closeAction:"hide",plain:true,items:new Ext.TabPanel({applyTo:"gis-convert-tabs",autoTabs:true,activeTab:0,deferredRender:false,border:false}),buttons:[{text:s3_gis_fill_lat,disabled:false,handler:function(){if(s3_gis_convertFillBack(1)){s3_gis_calcDone=
false;$("#DDMMSS_dec").val("");$("#gps_dec").val("")}}},{text:s3_gis_fill_lon,handler:function(){if(s3_gis_convertFillBack(2)){s3_gis_calcDone=false;$("#DDMMSS_dec").val("");$("#gps_dec").val("")}}}]}));a.show(this)})});
(function(a,e){function h(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._inDialog=this._datepickerShowing=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su",
"Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false};a.extend(this._defaults,this.regional[""]);this.dpDiv=a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}function g(b,c){a.extend(b,c);for(var f in c)if(c[f]==
null||c[f]==e)b[f]=c[f];return b}a.extend(a.ui,{datepicker:{version:"1.8.9"}});var j=(new Date).getTime();a.extend(h.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(b){g(this._defaults,b||{});return this},_attachDatepicker:function(b,c){var f=null,k;for(k in this._defaults){var m=b.getAttribute("date:"+k);if(m){f=f||{};try{f[k]=eval(m)}catch(n){f[k]=m}}}k=b.nodeName.toLowerCase();
m=k=="div"||k=="span";if(!b.id){this.uuid+=1;b.id="dp"+this.uuid}var o=this._newInst(a(b),m);o.settings=a.extend({},c||{},f||{});if(k=="input")this._connectDatepicker(b,o);else m&&this._inlineDatepicker(b,o)},_newInst:function(b,c){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:!c?this.dpDiv:a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}},
_connectDatepicker:function(b,c){var f=a(b);c.append=a([]);c.trigger=a([]);if(!f.hasClass(this.markerClassName)){this._attachments(f,c);f.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(k,m,n){c.settings[m]=n}).bind("getData.datepicker",function(k,m){return this._get(c,m)});this._autoSize(c);a.data(b,"datepicker",c)}},_attachments:function(b,c){var f=this._get(c,"appendText"),k=this._get(c,"isRTL");c.append&&
c.append.remove();if(f){c.append=a('<span class="'+this._appendClass+'">'+f+"</span>");b[k?"before":"after"](c.append)}b.unbind("focus",this._showDatepicker);c.trigger&&c.trigger.remove();f=this._get(c,"showOn");if(f=="focus"||f=="both")b.focus(this._showDatepicker);if(f=="button"||f=="both"){f=this._get(c,"buttonText");var m=this._get(c,"buttonImage");c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:m,alt:f,title:f}):a('<button type="button"></button>').addClass(this._triggerClass).html(m==
""?f:a("<img/>").attr({src:m,alt:f,title:f})));b[k?"before":"after"](c.trigger);c.trigger.click(function(){a.datepicker._datepickerShowing&&a.datepicker._lastInput==b[0]?a.datepicker._hideDatepicker():a.datepicker._showDatepicker(b[0]);return false})}},_autoSize:function(b){if(this._get(b,"autoSize")&&!b.inline){var c=new Date(2009,11,20),f=this._get(b,"dateFormat");if(f.match(/[DM]/)){var k=function(m){for(var n=0,o=0,p=0;p<m.length;p++)if(m[p].length>n){n=m[p].length;o=p}return o};c.setMonth(k(this._get(b,
f.match(/MM/)?"monthNames":"monthNamesShort")));c.setDate(k(this._get(b,f.match(/DD/)?"dayNames":"dayNamesShort"))+20-c.getDay())}b.input.attr("size",this._formatDate(b,c).length)}},_inlineDatepicker:function(b,c){var f=a(b);if(!f.hasClass(this.markerClassName)){f.addClass(this.markerClassName).append(c.dpDiv).bind("setData.datepicker",function(k,m,n){c.settings[m]=n}).bind("getData.datepicker",function(k,m){return this._get(c,m)});a.data(b,"datepicker",c);this._setDate(c,this._getDefaultDate(c),
true);this._updateDatepicker(c);this._updateAlternate(c);c.dpDiv.show()}},_dialogDatepicker:function(b,c,f,k,m){b=this._dialogInst;if(!b){this.uuid+=1;this._dialogInput=a('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);a("body").append(this._dialogInput);b=this._dialogInst=this._newInst(this._dialogInput,false);b.settings={};a.data(this._dialogInput[0],"datepicker",b)}g(b.settings,k||{});
c=c&&c.constructor==Date?this._formatDate(b,c):c;this._dialogInput.val(c);this._pos=m?m.length?m:[m.pageX,m.pageY]:null;if(!this._pos)this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)];this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");b.settings.onSelect=f;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);
this._showDatepicker(this._dialogInput[0]);a.blockUI&&a.blockUI(this.dpDiv);a.data(this._dialogInput[0],"datepicker",b);return this},_destroyDatepicker:function(b){var c=a(b),f=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var k=b.nodeName.toLowerCase();a.removeData(b,"datepicker");if(k=="input"){f.append.remove();f.trigger.remove();c.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",
this._doKeyUp)}else if(k=="div"||k=="span")c.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(b){var c=a(b),f=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var k=b.nodeName.toLowerCase();if(k=="input"){b.disabled=false;f.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else if(k=="div"||k=="span")c.children("."+this._inlineClass).children().removeClass("ui-state-disabled");this._disabledInputs=a.map(this._disabledInputs,
function(m){return m==b?null:m})}},_disableDatepicker:function(b){var c=a(b),f=a.data(b,"datepicker");if(c.hasClass(this.markerClassName)){var k=b.nodeName.toLowerCase();if(k=="input"){b.disabled=true;f.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else if(k=="div"||k=="span")c.children("."+this._inlineClass).children().addClass("ui-state-disabled");this._disabledInputs=a.map(this._disabledInputs,function(m){return m==b?null:
m});this._disabledInputs[this._disabledInputs.length]=b}},_isDisabledDatepicker:function(b){if(!b)return false;for(var c=0;c<this._disabledInputs.length;c++)if(this._disabledInputs[c]==b)return true;return false},_getInst:function(b){try{return a.data(b,"datepicker")}catch(c){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(b,c,f){var k=this._getInst(b);if(arguments.length==2&&typeof c=="string")return c=="defaults"?a.extend({},a.datepicker._defaults):k?c=="all"?a.extend({},
k.settings):this._get(k,c):null;var m=c||{};if(typeof c=="string"){m={};m[c]=f}if(k){this._curInst==k&&this._hideDatepicker();var n=this._getDateDatepicker(b,true);g(k.settings,m);this._attachments(a(b),k);this._autoSize(k);this._setDateDatepicker(b,n);this._updateDatepicker(k)}},_changeDatepicker:function(b,c,f){this._optionDatepicker(b,c,f)},_refreshDatepicker:function(b){(b=this._getInst(b))&&this._updateDatepicker(b)},_setDateDatepicker:function(b,c){var f=this._getInst(b);if(f){this._setDate(f,
c);this._updateDatepicker(f);this._updateAlternate(f)}},_getDateDatepicker:function(b,c){var f=this._getInst(b);f&&!f.inline&&this._setDateFromField(f,c);return f?this._getDate(f):null},_doKeyDown:function(b){var c=a.datepicker._getInst(b.target),f=true,k=c.dpDiv.is(".ui-datepicker-rtl");c._keyEvent=true;if(a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker();f=false;break;case 13:f=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",c.dpDiv);
f[0]?a.datepicker._selectDay(b.target,c.selectedMonth,c.selectedYear,f[0]):a.datepicker._hideDatepicker();return false;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 35:if(b.ctrlKey||b.metaKey)a.datepicker._clearDate(b.target);
f=b.ctrlKey||b.metaKey;break;case 36:if(b.ctrlKey||b.metaKey)a.datepicker._gotoToday(b.target);f=b.ctrlKey||b.metaKey;break;case 37:if(b.ctrlKey||b.metaKey)a.datepicker._adjustDate(b.target,k?+1:-1,"D");f=b.ctrlKey||b.metaKey;if(b.originalEvent.altKey)a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(c,"stepBigMonths"):-a.datepicker._get(c,"stepMonths"),"M");break;case 38:if(b.ctrlKey||b.metaKey)a.datepicker._adjustDate(b.target,-7,"D");f=b.ctrlKey||b.metaKey;break;case 39:if(b.ctrlKey||
b.metaKey)a.datepicker._adjustDate(b.target,k?-1:+1,"D");f=b.ctrlKey||b.metaKey;if(b.originalEvent.altKey)a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(c,"stepBigMonths"):+a.datepicker._get(c,"stepMonths"),"M");break;case 40:if(b.ctrlKey||b.metaKey)a.datepicker._adjustDate(b.target,+7,"D");f=b.ctrlKey||b.metaKey;break;default:f=false}else if(b.keyCode==36&&b.ctrlKey)a.datepicker._showDatepicker(this);else f=false;if(f){b.preventDefault();b.stopPropagation()}},_doKeyPress:function(b){var c=
a.datepicker._getInst(b.target);if(a.datepicker._get(c,"constrainInput")){c=a.datepicker._possibleChars(a.datepicker._get(c,"dateFormat"));var f=String.fromCharCode(b.charCode==e?b.keyCode:b.charCode);return b.ctrlKey||b.metaKey||f<" "||!c||c.indexOf(f)>-1}},_doKeyUp:function(b){b=a.datepicker._getInst(b.target);if(b.input.val()!=b.lastVal)try{if(a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,a.datepicker._getFormatConfig(b))){a.datepicker._setDateFromField(b);
a.datepicker._updateAlternate(b);a.datepicker._updateDatepicker(b)}}catch(c){a.datepicker.log(c)}return true},_showDatepicker:function(b){b=b.target||b;if(b.nodeName.toLowerCase()!="input")b=a("input",b.parentNode)[0];if(!(a.datepicker._isDisabledDatepicker(b)||a.datepicker._lastInput==b)){var c=a.datepicker._getInst(b);a.datepicker._curInst&&a.datepicker._curInst!=c&&a.datepicker._curInst.dpDiv.stop(true,true);var f=a.datepicker._get(c,"beforeShow");g(c.settings,f?f.apply(b,[b,c]):{});c.lastVal=
null;a.datepicker._lastInput=b;a.datepicker._setDateFromField(c);if(a.datepicker._inDialog)b.value="";if(!a.datepicker._pos){a.datepicker._pos=a.datepicker._findPos(b);a.datepicker._pos[1]+=b.offsetHeight}var k=false;a(b).parents().each(function(){k|=a(this).css("position")=="fixed";return!k});if(k&&a.browser.opera){a.datepicker._pos[0]-=document.documentElement.scrollLeft;a.datepicker._pos[1]-=document.documentElement.scrollTop}f={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=
null;c.dpDiv.empty();c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(c);f=a.datepicker._checkOffset(c,f,k);c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":k?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!c.inline){f=a.datepicker._get(c,"showAnim");var m=a.datepicker._get(c,"duration"),n=function(){a.datepicker._datepickerShowing=true;var o=c.dpDiv.find("iframe.ui-datepicker-cover");if(o.length){var p=a.datepicker._getBorders(c.dpDiv);
o.css({left:-p[0],top:-p[1],width:c.dpDiv.outerWidth(),height:c.dpDiv.outerHeight()})}};c.dpDiv.zIndex(a(b).zIndex()+1);a.effects&&a.effects[f]?c.dpDiv.show(f,a.datepicker._get(c,"showOptions"),m,n):c.dpDiv[f||"show"](f?m:null,n);if(!f||!m)n();c.input.is(":visible")&&!c.input.is(":disabled")&&c.input.focus();a.datepicker._curInst=c}}},_updateDatepicker:function(b){var c=this,f=a.datepicker._getBorders(b.dpDiv);b.dpDiv.empty().append(this._generateHTML(b));var k=b.dpDiv.find("iframe.ui-datepicker-cover");
k.length&&k.css({left:-f[0],top:-f[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()});b.dpDiv.find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){a(this).removeClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&a(this).removeClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&a(this).removeClass("ui-datepicker-next-hover")}).bind("mouseover",function(){if(!c._isDisabledDatepicker(b.inline?
b.dpDiv.parent()[0]:b.input[0])){a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");a(this).addClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&a(this).addClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&a(this).addClass("ui-datepicker-next-hover")}}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end();f=this._getNumberOfMonths(b);k=f[1];k>1?b.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",
17*k+"em"):b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");b.dpDiv[(f[0]!=1||f[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");b==a.datepicker._curInst&&a.datepicker._datepickerShowing&&b.input&&b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();if(b.yearshtml){var m=b.yearshtml;setTimeout(function(){m===b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml);
m=b.yearshtml=null},0)}},_getBorders:function(b){var c=function(f){return{thin:1,medium:2,thick:3}[f]||f};return[parseFloat(c(b.css("border-left-width"))),parseFloat(c(b.css("border-top-width")))]},_checkOffset:function(b,c,f){var k=b.dpDiv.outerWidth(),m=b.dpDiv.outerHeight(),n=b.input?b.input.outerWidth():0,o=b.input?b.input.outerHeight():0,p=document.documentElement.clientWidth+a(document).scrollLeft(),t=document.documentElement.clientHeight+a(document).scrollTop();c.left-=this._get(b,"isRTL")?
k-n:0;c.left-=f&&c.left==b.input.offset().left?a(document).scrollLeft():0;c.top-=f&&c.top==b.input.offset().top+o?a(document).scrollTop():0;c.left-=Math.min(c.left,c.left+k>p&&p>k?Math.abs(c.left+k-p):0);c.top-=Math.min(c.top,c.top+m>t&&t>m?Math.abs(m+o):0);return c},_findPos:function(b){for(var c=this._get(this._getInst(b),"isRTL");b&&(b.type=="hidden"||b.nodeType!=1);)b=b[c?"previousSibling":"nextSibling"];b=a(b).offset();return[b.left,b.top]},_hideDatepicker:function(b){var c=this._curInst;if(!(!c||
b&&c!=a.data(b,"datepicker")))if(this._datepickerShowing){b=this._get(c,"showAnim");var f=this._get(c,"duration"),k=function(){a.datepicker._tidyDialog(c);this._curInst=null};a.effects&&a.effects[b]?c.dpDiv.hide(b,a.datepicker._get(c,"showOptions"),f,k):c.dpDiv[b=="slideDown"?"slideUp":b=="fadeIn"?"fadeOut":"hide"](b?f:null,k);b||k();if(b=this._get(c,"onClose"))b.apply(c.input?c.input[0]:null,[c.input?c.input.val():"",c]);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",
left:"0",top:"-100px"});if(a.blockUI){a.unblockUI();a("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(b){b.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){b=a(b.target);b[0].id!=a.datepicker._mainDivId&&b.parents("#"+a.datepicker._mainDivId).length==0&&!b.hasClass(a.datepicker.markerClassName)&&!b.hasClass(a.datepicker._triggerClass)&&a.datepicker._datepickerShowing&&!(a.datepicker._inDialog&&
a.blockUI)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,f){b=a(b);var k=this._getInst(b[0]);if(!this._isDisabledDatepicker(b[0])){this._adjustInstDate(k,c+(f=="M"?this._get(k,"showCurrentAtPos"):0),f);this._updateDatepicker(k)}},_gotoToday:function(b){b=a(b);var c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay){c.selectedDay=c.currentDay;c.drawMonth=c.selectedMonth=c.currentMonth;c.drawYear=c.selectedYear=c.currentYear}else{var f=new Date;c.selectedDay=f.getDate();c.drawMonth=
c.selectedMonth=f.getMonth();c.drawYear=c.selectedYear=f.getFullYear()}this._notifyChange(c);this._adjustDate(b)},_selectMonthYear:function(b,c,f){b=a(b);var k=this._getInst(b[0]);k._selectingMonthYear=false;k["selected"+(f=="M"?"Month":"Year")]=k["draw"+(f=="M"?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10);this._notifyChange(k);this._adjustDate(b)},_clickMonthYear:function(b){var c=this._getInst(a(b)[0]);c.input&&c._selectingMonthYear&&setTimeout(function(){c.input.focus()},0);c._selectingMonthYear=
!c._selectingMonthYear},_selectDay:function(b,c,f,k){var m=a(b);if(!(a(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(m[0]))){m=this._getInst(m[0]);m.selectedDay=m.currentDay=a("a",k).html();m.selectedMonth=m.currentMonth=c;m.selectedYear=m.currentYear=f;this._selectDate(b,this._formatDate(m,m.currentDay,m.currentMonth,m.currentYear))}},_clearDate:function(b){b=a(b);this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(b,c){var f=this._getInst(a(b)[0]);c=c!=null?c:this._formatDate(f);
f.input&&f.input.val(c);this._updateAlternate(f);var k=this._get(f,"onSelect");if(k)k.apply(f.input?f.input[0]:null,[c,f]);else f.input&&f.input.trigger("change");if(f.inline)this._updateDatepicker(f);else{this._hideDatepicker();this._lastInput=f.input[0];typeof f.input[0]!="object"&&f.input.focus();this._lastInput=null}},_updateAlternate:function(b){var c=this._get(b,"altField");if(c){var f=this._get(b,"altFormat")||this._get(b,"dateFormat"),k=this._getDate(b),m=this.formatDate(f,k,this._getFormatConfig(b));
a(c).each(function(){a(this).val(m)})}},noWeekends:function(b){b=b.getDay();return[b>0&&b<6,""]},iso8601Week:function(b){b=new Date(b.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();b.setMonth(0);b.setDate(1);return Math.floor(Math.round((c-b)/864E5)/7)+1},parseDate:function(b,c,f){if(b==null||c==null)throw"Invalid arguments";c=typeof c=="object"?c.toString():c+"";if(c=="")return null;var k=(f?f.shortYearCutoff:null)||this._defaults.shortYearCutoff;k=typeof k!="string"?k:(new Date).getFullYear()%
100+parseInt(k,10);for(var m=(f?f.dayNamesShort:null)||this._defaults.dayNamesShort,n=(f?f.dayNames:null)||this._defaults.dayNames,o=(f?f.monthNamesShort:null)||this._defaults.monthNamesShort,p=(f?f.monthNames:null)||this._defaults.monthNames,t=f=-1,w=-1,x=-1,u=false,r=function(E){(E=P+1<b.length&&b.charAt(P+1)==E)&&P++;return E},y=function(E){var J=r(E);E=RegExp("^\\d{1,"+(E=="@"?14:E=="!"?20:E=="y"&&J?4:E=="o"?3:2)+"}");E=c.substring(C).match(E);if(!E)throw"Missing number at position "+C;C+=E[0].length;
return parseInt(E[0],10)},z=function(E,J,aa){E=r(E)?aa:J;for(J=0;J<E.length;J++)if(c.substr(C,E[J].length).toLowerCase()==E[J].toLowerCase()){C+=E[J].length;return J+1}throw"Unknown name at position "+C;},B=function(){if(c.charAt(C)!=b.charAt(P))throw"Unexpected literal at position "+C;C++},C=0,P=0;P<b.length;P++)if(u)if(b.charAt(P)=="'"&&!r("'"))u=false;else B();else switch(b.charAt(P)){case "d":w=y("d");break;case "D":z("D",m,n);break;case "o":x=y("o");break;case "m":t=y("m");break;case "M":t=z("M",
o,p);break;case "y":f=y("y");break;case "@":var H=new Date(y("@"));f=H.getFullYear();t=H.getMonth()+1;w=H.getDate();break;case "!":H=new Date((y("!")-this._ticksTo1970)/1E4);f=H.getFullYear();t=H.getMonth()+1;w=H.getDate();break;case "'":if(r("'"))B();else u=true;break;default:B()}if(f==-1)f=(new Date).getFullYear();else if(f<100)f+=(new Date).getFullYear()-(new Date).getFullYear()%100+(f<=k?0:-100);if(x>-1){t=1;w=x;do{k=this._getDaysInMonth(f,t-1);if(w<=k)break;t++;w-=k}while(1)}H=this._daylightSavingAdjust(new Date(f,
t-1,w));if(H.getFullYear()!=f||H.getMonth()+1!=t||H.getDate()!=w)throw"Invalid date";return H},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1E7,formatDate:function(b,c,f){if(!c)return"";var k=(f?f.dayNamesShort:null)||this._defaults.dayNamesShort,m=(f?
f.dayNames:null)||this._defaults.dayNames,n=(f?f.monthNamesShort:null)||this._defaults.monthNamesShort;f=(f?f.monthNames:null)||this._defaults.monthNames;var o=function(r){(r=u+1<b.length&&b.charAt(u+1)==r)&&u++;return r},p=function(r,y,z){y=""+y;if(o(r))for(;y.length<z;)y="0"+y;return y},t=function(r,y,z,B){return o(r)?B[y]:z[y]},w="",x=false;if(c)for(var u=0;u<b.length;u++)if(x)if(b.charAt(u)=="'"&&!o("'"))x=false;else w+=b.charAt(u);else switch(b.charAt(u)){case "d":w+=p("d",c.getDate(),2);break;
case "D":w+=t("D",c.getDay(),k,m);break;case "o":w+=p("o",(c.getTime()-(new Date(c.getFullYear(),0,0)).getTime())/864E5,3);break;case "m":w+=p("m",c.getMonth()+1,2);break;case "M":w+=t("M",c.getMonth(),n,f);break;case "y":w+=o("y")?c.getFullYear():(c.getYear()%100<10?"0":"")+c.getYear()%100;break;case "@":w+=c.getTime();break;case "!":w+=c.getTime()*1E4+this._ticksTo1970;break;case "'":if(o("'"))w+="'";else x=true;break;default:w+=b.charAt(u)}return w},_possibleChars:function(b){for(var c="",f=false,
k=function(n){(n=m+1<b.length&&b.charAt(m+1)==n)&&m++;return n},m=0;m<b.length;m++)if(f)if(b.charAt(m)=="'"&&!k("'"))f=false;else c+=b.charAt(m);else switch(b.charAt(m)){case "d":case "m":case "y":case "@":c+="0123456789";break;case "D":case "M":return null;case "'":if(k("'"))c+="'";else f=true;break;default:c+=b.charAt(m)}return c},_get:function(b,c){return b.settings[c]!==e?b.settings[c]:this._defaults[c]},_setDateFromField:function(b,c){if(b.input.val()!=b.lastVal){var f=this._get(b,"dateFormat"),
k=b.lastVal=b.input?b.input.val():null,m,n;m=n=this._getDefaultDate(b);var o=this._getFormatConfig(b);try{m=this.parseDate(f,k,o)||n}catch(p){this.log(p);k=c?"":k}b.selectedDay=m.getDate();b.drawMonth=b.selectedMonth=m.getMonth();b.drawYear=b.selectedYear=m.getFullYear();b.currentDay=k?m.getDate():0;b.currentMonth=k?m.getMonth():0;b.currentYear=k?m.getFullYear():0;this._adjustInstDate(b)}},_getDefaultDate:function(b){return this._restrictMinMax(b,this._determineDate(b,this._get(b,"defaultDate"),new Date))},
_determineDate:function(b,c,f){var k=function(n){var o=new Date;o.setDate(o.getDate()+n);return o},m=function(n){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),n,a.datepicker._getFormatConfig(b))}catch(o){}var p=(n.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,t=p.getFullYear(),w=p.getMonth();p=p.getDate();for(var x=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,u=x.exec(n);u;){switch(u[2]||"d"){case "d":case "D":p+=parseInt(u[1],10);break;case "w":case "W":p+=parseInt(u[1],
10)*7;break;case "m":case "M":w+=parseInt(u[1],10);p=Math.min(p,a.datepicker._getDaysInMonth(t,w));break;case "y":case "Y":t+=parseInt(u[1],10);p=Math.min(p,a.datepicker._getDaysInMonth(t,w))}u=x.exec(n)}return new Date(t,w,p)};if(c=(c=c==null||c===""?f:typeof c=="string"?m(c):typeof c=="number"?isNaN(c)?f:k(c):new Date(c.getTime()))&&c.toString()=="Invalid Date"?f:c){c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0)}return this._daylightSavingAdjust(c)},_daylightSavingAdjust:function(b){if(!b)return null;
b.setHours(b.getHours()>12?b.getHours()+2:0);return b},_setDate:function(b,c,f){var k=!c,m=b.selectedMonth,n=b.selectedYear;c=this._restrictMinMax(b,this._determineDate(b,c,new Date));b.selectedDay=b.currentDay=c.getDate();b.drawMonth=b.selectedMonth=b.currentMonth=c.getMonth();b.drawYear=b.selectedYear=b.currentYear=c.getFullYear();if((m!=b.selectedMonth||n!=b.selectedYear)&&!f)this._notifyChange(b);this._adjustInstDate(b);if(b.input)b.input.val(k?"":this._formatDate(b))},_getDate:function(b){return!b.currentYear||
b.input&&b.input.val()==""?null:this._daylightSavingAdjust(new Date(b.currentYear,b.currentMonth,b.currentDay))},_generateHTML:function(b){var c=new Date;c=this._daylightSavingAdjust(new Date(c.getFullYear(),c.getMonth(),c.getDate()));var f=this._get(b,"isRTL"),k=this._get(b,"showButtonPanel"),m=this._get(b,"hideIfNoPrevNext"),n=this._get(b,"navigationAsDateFormat"),o=this._getNumberOfMonths(b),p=this._get(b,"showCurrentAtPos"),t=this._get(b,"stepMonths"),w=o[0]!=1||o[1]!=1,x=this._daylightSavingAdjust(!b.currentDay?
new Date(9999,9,9):new Date(b.currentYear,b.currentMonth,b.currentDay)),u=this._getMinMaxDate(b,"min"),r=this._getMinMaxDate(b,"max");p=b.drawMonth-p;var y=b.drawYear;if(p<0){p+=12;y--}if(r){var z=this._daylightSavingAdjust(new Date(r.getFullYear(),r.getMonth()-o[0]*o[1]+1,r.getDate()));for(z=u&&z<u?u:z;this._daylightSavingAdjust(new Date(y,p,1))>z;){p--;if(p<0){p=11;y--}}}b.drawMonth=p;b.drawYear=y;z=this._get(b,"prevText");z=!n?z:this.formatDate(z,this._daylightSavingAdjust(new Date(y,p-t,1)),this._getFormatConfig(b));
z=this._canAdjustMonth(b,-1,y,p)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+j+".datepicker._adjustDate('#"+b.id+"', -"+t+", 'M');\" title=\""+z+'"><span class="ui-icon ui-icon-circle-triangle-'+(f?"e":"w")+'">'+z+"</span></a>":m?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+z+'"><span class="ui-icon ui-icon-circle-triangle-'+(f?"e":"w")+'">'+z+"</span></a>";var B=this._get(b,"nextText");B=!n?B:this.formatDate(B,this._daylightSavingAdjust(new Date(y,
p+t,1)),this._getFormatConfig(b));m=this._canAdjustMonth(b,+1,y,p)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+j+".datepicker._adjustDate('#"+b.id+"', +"+t+", 'M');\" title=\""+B+'"><span class="ui-icon ui-icon-circle-triangle-'+(f?"w":"e")+'">'+B+"</span></a>":m?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+B+'"><span class="ui-icon ui-icon-circle-triangle-'+(f?"w":"e")+'">'+B+"</span></a>";t=this._get(b,"currentText");B=this._get(b,"gotoCurrent")&&
b.currentDay?x:c;t=!n?t:this.formatDate(t,B,this._getFormatConfig(b));n=!b.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+j+'.datepicker._hideDatepicker();">'+this._get(b,"closeText")+"</button>":"";k=k?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(f?n:"")+(this._isInRange(b,B)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+
j+".datepicker._gotoToday('#"+b.id+"');\">"+t+"</button>":"")+(f?"":n)+"</div>":"";n=parseInt(this._get(b,"firstDay"),10);n=isNaN(n)?0:n;t=this._get(b,"showWeek");B=this._get(b,"dayNames");this._get(b,"dayNamesShort");var C=this._get(b,"dayNamesMin"),P=this._get(b,"monthNames"),H=this._get(b,"monthNamesShort"),E=this._get(b,"beforeShowDay"),J=this._get(b,"showOtherMonths"),aa=this._get(b,"selectOtherMonths");this._get(b,"calculateWeek");for(var ha=this._getDefaultDate(b),da="",ja=0;ja<o[0];ja++){for(var M=
"",O=0;O<o[1];O++){var N=this._daylightSavingAdjust(new Date(y,p,b.selectedDay)),I=" ui-corner-all",T="";if(w){T+='<div class="ui-datepicker-group';if(o[1]>1)switch(O){case 0:T+=" ui-datepicker-group-first";I=" ui-corner-"+(f?"right":"left");break;case o[1]-1:T+=" ui-datepicker-group-last";I=" ui-corner-"+(f?"left":"right");break;default:T+=" ui-datepicker-group-middle";I=""}T+='">'}T+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+I+'">'+(/all|left/.test(I)&&ja==0?f?m:z:"")+
(/all|right/.test(I)&&ja==0?f?z:m:"")+this._generateMonthYearHeader(b,p,y,u,r,ja>0||O>0,P,H)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var ca=t?'<th class="ui-datepicker-week-col">'+this._get(b,"weekHeader")+"</th>":"";for(I=0;I<7;I++){var L=(I+n)%7;ca+="<th"+((I+n+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+B[L]+'">'+C[L]+"</span></th>"}T+=ca+"</tr></thead><tbody>";ca=this._getDaysInMonth(y,p);if(y==b.selectedYear&&p==b.selectedMonth)b.selectedDay=Math.min(b.selectedDay,
ca);I=(this._getFirstDayOfMonth(y,p)-n+7)%7;ca=w?6:Math.ceil((I+ca)/7);L=this._daylightSavingAdjust(new Date(y,p,1-I));for(var W=0;W<ca;W++){T+="<tr>";var ga=!t?"":'<td class="ui-datepicker-week-col">'+this._get(b,"calculateWeek")(L)+"</td>";for(I=0;I<7;I++){var Z=E?E.apply(b.input?b.input[0]:null,[L]):[true,""],R=L.getMonth()!=p,U=R&&!aa||!Z[0]||u&&L<u||r&&L>r;ga+='<td class="'+((I+n+6)%7>=5?" ui-datepicker-week-end":"")+(R?" ui-datepicker-other-month":"")+(L.getTime()==N.getTime()&&p==b.selectedMonth&&
b._keyEvent||ha.getTime()==L.getTime()&&ha.getTime()==N.getTime()?" "+this._dayOverClass:"")+(U?" "+this._unselectableClass+" ui-state-disabled":"")+(R&&!J?"":" "+Z[1]+(L.getTime()==x.getTime()?" "+this._currentClass:"")+(L.getTime()==c.getTime()?" ui-datepicker-today":""))+'"'+((!R||J)&&Z[2]?' title="'+Z[2]+'"':"")+(U?"":' onclick="DP_jQuery_'+j+".datepicker._selectDay('#"+b.id+"',"+L.getMonth()+","+L.getFullYear()+', this);return false;"')+">"+(R&&!J?"&#xa0;":U?'<span class="ui-state-default">'+
L.getDate()+"</span>":'<a class="ui-state-default'+(L.getTime()==c.getTime()?" ui-state-highlight":"")+(L.getTime()==x.getTime()?" ui-state-active":"")+(R?" ui-priority-secondary":"")+'" href="#">'+L.getDate()+"</a>")+"</td>";L.setDate(L.getDate()+1);L=this._daylightSavingAdjust(L)}T+=ga+"</tr>"}p++;if(p>11){p=0;y++}T+="</tbody></table>"+(w?"</div>"+(o[0]>0&&O==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");M+=T}da+=M}da+=k+(a.browser.msie&&parseInt(a.browser.version,10)<7&&!b.inline?
'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");b._keyEvent=false;return da},_generateMonthYearHeader:function(b,c,f,k,m,n,o,p){var t=this._get(b,"changeMonth"),w=this._get(b,"changeYear"),x=this._get(b,"showMonthAfterYear"),u='<div class="ui-datepicker-title">',r="";if(n||!t)r+='<span class="ui-datepicker-month">'+o[c]+"</span>";else{o=k&&k.getFullYear()==f;var y=m&&m.getFullYear()==f;r+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+j+".datepicker._selectMonthYear('#"+
b.id+"', this, 'M');\" onclick=\"DP_jQuery_"+j+".datepicker._clickMonthYear('#"+b.id+"');\">";for(var z=0;z<12;z++)if((!o||z>=k.getMonth())&&(!y||z<=m.getMonth()))r+='<option value="'+z+'"'+(z==c?' selected="selected"':"")+">"+p[z]+"</option>";r+="</select>"}x||(u+=r+(n||!(t&&w)?"&#xa0;":""));b.yearshtml="";if(n||!w)u+='<span class="ui-datepicker-year">'+f+"</span>";else{p=this._get(b,"yearRange").split(":");var B=(new Date).getFullYear();o=function(C){C=C.match(/c[+-].*/)?f+parseInt(C.substring(1),
10):C.match(/[+-].*/)?B+parseInt(C,10):parseInt(C,10);return isNaN(C)?B:C};c=o(p[0]);p=Math.max(c,o(p[1]||""));c=k?Math.max(c,k.getFullYear()):c;p=m?Math.min(p,m.getFullYear()):p;for(b.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+j+".datepicker._selectMonthYear('#"+b.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+j+".datepicker._clickMonthYear('#"+b.id+"');\">";c<=p;c++)b.yearshtml+='<option value="'+c+'"'+(c==f?' selected="selected"':"")+">"+c+"</option>";b.yearshtml+="</select>";
if(a.browser.mozilla)u+='<select class="ui-datepicker-year"><option value="'+f+'" selected="selected">'+f+"</option></select>";else{u+=b.yearshtml;b.yearshtml=null}}u+=this._get(b,"yearSuffix");if(x)u+=(n||!(t&&w)?"&#xa0;":"")+r;u+="</div>";return u},_adjustInstDate:function(b,c,f){var k=b.drawYear+(f=="Y"?c:0),m=b.drawMonth+(f=="M"?c:0);c=Math.min(b.selectedDay,this._getDaysInMonth(k,m))+(f=="D"?c:0);k=this._restrictMinMax(b,this._daylightSavingAdjust(new Date(k,m,c)));b.selectedDay=k.getDate();
b.drawMonth=b.selectedMonth=k.getMonth();b.drawYear=b.selectedYear=k.getFullYear();if(f=="M"||f=="Y")this._notifyChange(b)},_restrictMinMax:function(b,c){var f=this._getMinMaxDate(b,"min"),k=this._getMinMaxDate(b,"max");f=f&&c<f?f:c;return f=k&&f>k?k:f},_notifyChange:function(b){var c=this._get(b,"onChangeMonthYear");if(c)c.apply(b.input?b.input[0]:null,[b.selectedYear,b.selectedMonth+1,b])},_getNumberOfMonths:function(b){b=this._get(b,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,
b]:b},_getMinMaxDate:function(b,c){return this._determineDate(b,this._get(b,c+"Date"),null)},_getDaysInMonth:function(b,c){return 32-(new Date(b,c,32)).getDate()},_getFirstDayOfMonth:function(b,c){return(new Date(b,c,1)).getDay()},_canAdjustMonth:function(b,c,f,k){var m=this._getNumberOfMonths(b);f=this._daylightSavingAdjust(new Date(f,k+(c<0?c:m[0]*m[1]),1));c<0&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth()));return this._isInRange(b,f)},_isInRange:function(b,c){var f=this._getMinMaxDate(b,
"min"),k=this._getMinMaxDate(b,"max");return(!f||c.getTime()>=f.getTime())&&(!k||c.getTime()<=k.getTime())},_getFormatConfig:function(b){var c=this._get(b,"shortYearCutoff");c=typeof c!="string"?c:(new Date).getFullYear()%100+parseInt(c,10);return{shortYearCutoff:c,dayNamesShort:this._get(b,"dayNamesShort"),dayNames:this._get(b,"dayNames"),monthNamesShort:this._get(b,"monthNamesShort"),monthNames:this._get(b,"monthNames")}},_formatDate:function(b,c,f,k){if(!c){b.currentDay=b.selectedDay;b.currentMonth=
b.selectedMonth;b.currentYear=b.selectedYear}c=c?typeof c=="object"?c:this._daylightSavingAdjust(new Date(k,f,c)):this._daylightSavingAdjust(new Date(b.currentYear,b.currentMonth,b.currentDay));return this.formatDate(this._get(b,"dateFormat"),c,this._getFormatConfig(b))}});a.fn.datepicker=function(b){if(!a.datepicker.initialized){a(document).mousedown(a.datepicker._checkExternalClick).find("body").append(a.datepicker.dpDiv);a.datepicker.initialized=true}var c=Array.prototype.slice.call(arguments,
1);if(typeof b=="string"&&(b=="isDisabled"||b=="getDate"||b=="widget"))return a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c));if(b=="option"&&arguments.length==2&&typeof arguments[1]=="string")return a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c));return this.each(function(){typeof b=="string"?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)})};a.datepicker=new h;a.datepicker.initialized=
false;a.datepicker.uuid=(new Date).getTime();a.datepicker.version="1.8.9";window["DP_jQuery_"+j]=a})(jQuery);function popup(a){newwindow=window.open(a,"name","height=400,width=600");window.focus&&newwindow.focus();return false}function collapse(a){jQuery("#"+a).slideToggle()}function fade(a,e){e>0?jQuery("#"+a).hide().fadeIn("slow"):jQuery("#"+a).show().fadeOut("slow")}
function ajax(a,e,h){query="";if(typeof e=="string"){if(d=jQuery(e).serialize())query=d}else{pcs=[];for(i=0;i<e.length;i++)(q=jQuery("#"+e[i]).serialize())&&pcs.push(q);if(pcs.length>0)query=pcs.join("&")}jQuery.ajax({type:"POST",url:a,data:query,success:function(g){if(h)h==":eval"?eval(g):jQuery("#"+h).html(g)}})}String.prototype.reverse=function(){return this.split("").reverse().join("")};
function web2py_ajax_init(){jQuery(".hidden").hide();jQuery(".error").hide().slideDown("slow");jQuery(".flash").click(function(){jQuery(this).fadeOut("slow");return false});jQuery("input.string").attr("size",50);jQuery("textarea.text").attr("cols",50).attr("rows",10);jQuery("input.integer").keyup(function(){this.value=this.value.reverse().replace(/[^0-9\-]|\-(?=.)/g,"").reverse()});jQuery("input.double").keyup(function(){this.value=this.value.reverse().replace(/[^0-9\-\.]|[\-](?=.)|[\.](?=[0-9]*[\.])/g,
"").reverse()})}jQuery(document).ready(function(){jQuery(".flash").hide().slideDown("slow");jQuery(".flash").html()!=""&&jQuery(".flash").slideDown("slow");web2py_ajax_init()});function web2py_trap_form(a,e){jQuery("#"+e+" form").each(function(){var h=jQuery(this);h.hasClass("no_trap")||h.submit(function(){jQuery(".flash").hide().html("");web2py_ajax_page("post",a,h.serialize(),e);return false})})}
function web2py_ajax_page(a,e,h,g){jQuery.ajax({type:a,url:e,data:h,beforeSend:function(j){j.setRequestHeader("web2py-component-location",document.location);j.setRequestHeader("web2py-component-element",g)},complete:function(j){(command=j.getResponseHeader("web2py-component-command"))&&eval(command);(flash=j.getResponseHeader("web2py-component-flash"))&&jQuery(".flash").html(flash).slideDown()},success:function(j){jQuery("#"+g).html(j);web2py_trap_form(e,g);web2py_ajax_init()}})}
function web2py_component(a,e){jQuery(document).ready(function(){web2py_ajax_page("get",a,null,e)})}jQuery(document).ready(function(){jQuery(".s3_checkbox_label").cluetip({activation:"hover",positionBy:"auto",local:true,hideLocal:false,showTitle:false,topOffset:0,mouseOutClose:true,arrows:true,clickThrough:true})});
jQuery.fn.fancyZoom=function(a){function e(o){if(f)return false;f=true;var p=$($(this).attr("href")),t=a.height,w=window.innerWidth||window.document.documentElement.clientWidth||window.document.body.clientWidth,x=window.innerHeight||window.document.documentElement.clientHeight||window.document.body.clientHeight,u=window.pageYOffset||window.document.documentElement.scrollTop||window.document.body.scrollTop,r={width:w,height:x,x:window.pageXOffset||window.document.documentElement.scrollLeft||window.document.body.scrollLeft,
y:u};w=(a.width||p.width())+60;x=(t||p.height())+60;t=Math.max(r.height/2-x/2+u,0);r=r.width/2-w/2;u=o.pageY;o=o.pageX;m.attr("curTop",u);m.attr("curLeft",o);m.attr("scaleImg",a.scaleImg?"true":"false");$("#zoom").hide().css({position:"absolute",top:u+"px",left:o+"px",width:"1px",height:"1px"});j();m.hide();a.closeOnClick&&$("#zoom").click(h);if(a.scaleImg){n.html(p.html());$("#zoom_content img").css("width","100%")}else n.html("");$("#zoom").animate({top:t+"px",left:r+"px",opacity:"show",width:w,
height:x},500,null,function(){a.scaleImg!=true&&n.html(p.html());b();m.show();f=false});return false}function h(){if(f)return false;f=true;$("#zoom").unbind("click");j();m.attr("scaleImg")!="true"&&n.html("");m.hide();$("#zoom").animate({top:m.attr("curTop")+"px",left:m.attr("curLeft")+"px",opacity:"hide",width:"1px",height:"1px"},500,null,function(){m.attr("scaleImg")=="true"&&n.html("");b();f=false});return false}function g(o){$("#zoom_table td").each(function(){var w=$(this).css("background-image").replace(/\.(png|gif|none)\"\)$/,
"."+o+'")');$(this).css("background-image",w)});var p=m.children("img"),t=p.attr("src").replace(/\.(png|gif|none)$/,"."+o);p.attr("src",t)}function j(){$.browser.msie&&parseFloat($.browser.version)>=7&&g("gif")}function b(){$.browser.msie&&$.browser.version>=7&&g("png")}var c=(a=a||{})&&a.directory?a.directory:"images",f=false;if($("#zoom").length==0){var k=$.browser.msie?"gif":"png";c='<div id="zoom" style="display:none;">                   <table id="zoom_table" style="border-collapse:collapse; width:100%; height:100%;">                     <tbody>                       <tr>                         <td class="tl" style="background:url('+
c+"/tl."+k+') 0 0 no-repeat; width:20px height:20px; overflow:hidden;" />                         <td class="tm" style="background:url('+c+"/tm."+k+') 0 0 repeat-x; height:20px; overflow:hidden;" />                         <td class="tr" style="background:url('+c+"/tr."+k+') 100% 0 no-repeat; width:20px height:20px; overflow:hidden;" />                       </tr>                       <tr>                         <td class="ml" style="background:url('+c+"/ml."+k+') 0 0 repeat-y; width:20px; overflow:hidden;" />                         <td class="mm" style="background:#fff; vertical-align:top; padding:10px;">                           <div id="zoom_content">                           </div>                         </td>                         <td class="mr" style="background:url('+
c+"/mr."+k+') 100% 0 repeat-y;  width:20px; overflow:hidden;" />                       </tr>                       <tr>                         <td class="bl" style="background:url('+c+"/bl."+k+') 0 100% no-repeat; width:20px height:20px; overflow:hidden;" />                         <td class="bm" style="background:url('+c+"/bm."+k+') 0 100% repeat-x; height:20px; overflow:hidden;" />                         <td class="br" style="background:url('+c+"/br."+k+') 100% 100% no-repeat; width:20px height:20px; overflow:hidden;" />                       </tr>                     </tbody>                   </table>                   <a href="#" title="Close" id="zoom_close" style="position:absolute; top:0; left:0;">                     <img src="'+
c+"/closebox."+k+'" alt="Close" style="border:none; margin:0; padding:0;" />                   </a>                 </div>';$("body").append(c);$("html").click(function(o){$(o.target).parents("#zoom:visible").length==0&&h()});$(document).keyup(function(o){o.keyCode==27&&$("#zoom:visible").length>0&&h()});$("#zoom_close").click(h)}$("#zoom");$("#zoom_table");var m=$("#zoom_close"),n=$("#zoom_content");$("td.ml,td.mm,td.mr");this.each(function(){$($(this).attr("href")).hide();$(this).click(e)});return this};
(function(a,e){if(a.cleanData){var h=a.cleanData;a.cleanData=function(j){for(var b=0,c;(c=j[b])!=null;b++)a(c).triggerHandler("remove");h(j)}}else{var g=a.fn.remove;a.fn.remove=function(j,b){return this.each(function(){if(!b)if(!j||a.filter(j,[this]).length)a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return g.call(a(this),j,b)})}}a.widget=function(j,b,c){var f=j.split(".")[0],k;j=j.split(".")[1];k=f+"-"+j;if(!c){c=b;b=a.Widget}a.expr[":"][k]=function(m){return!!a.data(m,
j)};a[f]=a[f]||{};a[f][j]=function(m,n){arguments.length&&this._createWidget(m,n)};b=new b;b.options=a.extend(true,{},b.options);a[f][j].prototype=a.extend(true,b,{namespace:f,widgetName:j,widgetEventPrefix:a[f][j].prototype.widgetEventPrefix||j,widgetBaseClass:k},c);a.widget.bridge(j,a[f][j])};a.widget.bridge=function(j,b){a.fn[j]=function(c){var f=typeof c==="string",k=Array.prototype.slice.call(arguments,1),m=this;c=!f&&k.length?a.extend.apply(null,[true,c].concat(k)):c;if(f&&c.charAt(0)==="_")return m;
f?this.each(function(){var n=a.data(this,j),o=n&&a.isFunction(n[c])?n[c].apply(n,k):n;if(o!==n&&o!==e){m=o;return false}}):this.each(function(){var n=a.data(this,j);n?n.option(c||{})._init():a.data(this,j,new b(c,this))});return m}};a.Widget=function(j,b){arguments.length&&this._createWidget(j,b)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(j,b){a.data(b,this.widgetName,this);this.element=a(b);this.options=a.extend(true,{},this.options,
this._getCreateOptions(),j);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(j,b){var c=j;if(arguments.length===0)return a.extend({},this.options);if(typeof j==="string"){if(b===e)return this.options[j];c={};c[j]=b}this._setOptions(c);return this},_setOptions:function(j){var b=this;a.each(j,function(c,f){b._setOption(c,f)});return this},_setOption:function(j,b){this.options[j]=b;if(j==="disabled")this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",b);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(j,b,c){var f=this.options[j];b=a.Event(b);b.type=(j===this.widgetEventPrefix?j:this.widgetEventPrefix+j).toLowerCase();c=c||{};if(b.originalEvent){j=a.event.props.length;for(var k;j;){k=a.event.props[--j];b[k]=b.originalEvent[k]}}this.element.trigger(b,c);return!(a.isFunction(f)&&f.call(this.element[0],b,c)===false||b.isDefaultPrevented())}}})(jQuery);
(function(a){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var e=this,h=this.element[0].ownerDocument,g;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(j){if(!(e.options.disabled||e.element.attr("readonly"))){g=false;var b=a.ui.keyCode;
switch(j.keyCode){case b.PAGE_UP:e._move("previousPage",j);break;case b.PAGE_DOWN:e._move("nextPage",j);break;case b.UP:e._move("previous",j);j.preventDefault();break;case b.DOWN:e._move("next",j);j.preventDefault();break;case b.ENTER:case b.NUMPAD_ENTER:if(e.menu.active){g=true;j.preventDefault()}case b.TAB:if(!e.menu.active)break;e.menu.select(j);break;case b.ESCAPE:e.element.val(e.term);e.close(j);break;default:clearTimeout(e.searching);e.searching=setTimeout(function(){if(e.term!=e.element.val()){e.selectedItem=
null;e.search(null,j)}},e.options.delay)}}}).bind("keypress.autocomplete",function(j){if(g){g=false;j.preventDefault()}}).bind("focus.autocomplete",function(){if(!e.options.disabled){e.selectedItem=null;e.previous=e.element.val()}}).bind("blur.autocomplete",function(j){if(!e.options.disabled){clearTimeout(e.searching);e.closing=setTimeout(function(){e.close(j);e._change(j)},150)}});this._initSource();this.response=function(){return e._response.apply(e,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||
"body",h)[0]).mousedown(function(j){var b=e.menu.element[0];a(j.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==e.element[0]&&c.target!==b&&!a.ui.contains(b,c.target)&&e.close()})},1);setTimeout(function(){clearTimeout(e.closing)},13)}).menu({focus:function(j,b){var c=b.item.data("item.autocomplete");false!==e._trigger("focus",j,{item:c})&&/^key/.test(j.originalEvent.type)&&e.element.val(c.value)},selected:function(j,b){var c=b.item.data("item.autocomplete"),
f=e.previous;if(e.element[0]!==h.activeElement){e.element.focus();e.previous=f;setTimeout(function(){e.previous=f;e.selectedItem=c},1)}false!==e._trigger("select",j,{item:c})&&e.element.val(c.value);e.term=e.element.val();e.close(j);e.selectedItem=c},blur:function(){e.menu.element.is(":visible")&&e.element.val()!==e.term&&e.element.val(e.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(e,h){a.Widget.prototype._setOption.apply(this,arguments);e==="source"&&this._initSource();if(e==="appendTo")this.menu.element.appendTo(a(h||"body",this.element[0].ownerDocument)[0]);e==="disabled"&&h&&this.xhr&&this.xhr.abort()},_initSource:function(){var e=this,h,g;if(a.isArray(this.options.source)){h=this.options.source;this.source=function(j,b){b(a.ui.autocomplete.filter(h,j.term))}}else if(typeof this.options.source===
"string"){g=this.options.source;this.source=function(j,b){e.xhr&&e.xhr.abort();e.xhr=a.ajax({url:g,data:j,dataType:"json",success:function(c,f,k){k===e.xhr&&b(c);e.xhr=null},error:function(c){c===e.xhr&&b([]);e.xhr=null}})}}else this.source=this.options.source},search:function(e,h){e=e!=null?e:this.element.val();this.term=this.element.val();if(e.length<this.options.minLength)return this.close(h);clearTimeout(this.closing);if(this._trigger("search",h)!==false)return this._search(e)},_search:function(e){this.pending++;
this.element.addClass("ui-autocomplete-loading");this.source({term:e},this.response)},_response:function(e){if(!this.options.disabled&&e&&e.length){e=this._normalize(e);this._suggest(e);this._trigger("open")}else this.close();this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(e){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",e)}},_change:function(e){this.previous!==
this.element.val()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(e){if(e.length&&e[0].label&&e[0].value)return e;return a.map(e,function(h){if(typeof h==="string")return{label:h,value:h};return a.extend({label:h.label||h.value,value:h.value||h.label},h)})},_suggest:function(e){var h=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(h,e);this.menu.deactivate();this.menu.refresh();h.show();this._resizeMenu();h.position(a.extend({of:this.element},this.options.position))},
_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(e,h){var g=this;a.each(h,function(j,b){g._renderItem(e,b)})},_renderItem:function(e,h){return a("<li></li>").data("item.autocomplete",h).append(a("<a></a>").text(h.label)).appendTo(e)},_move:function(e,h){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)){this.element.val(this.term);this.menu.deactivate()}else this.menu[e](h);
else this.search(null,h)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(e,h){var g=RegExp(a.ui.autocomplete.escapeRegex(h),"i");return a.grep(e,function(j){return g.test(j.label||j.value||j)})}})})(jQuery);
(function(a){a.widget("ui.menu",{_create:function(){var e=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(h){if(a(h.target).closest(".ui-menu-item a").length){h.preventDefault();e.select(h)}});this.refresh()},refresh:function(){var e=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(h){e.activate(h,a(this).parent())}).mouseleave(function(){e.deactivate()})},activate:function(e,h){this.deactivate();if(this.hasScroll()){var g=h.offset().top-this.element.offset().top,j=this.element.attr("scrollTop"),b=this.element.height();if(g<0)this.element.attr("scrollTop",j+g);else g>=b&&this.element.attr("scrollTop",j+g-b+h.height())}this.active=h.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:h})},
deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null}},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,h,g){if(this.active){e=this.active[e+"All"](".ui-menu-item").eq(0);
e.length?this.activate(g,e):this.activate(g,this.element.children(h))}else this.activate(g,this.element.children(h))},nextPage:function(e){if(this.hasScroll())if(!this.active||this.last())this.activate(e,this.element.children(".ui-menu-item:first"));else{var h=this.active.offset().top,g=this.element.height(),j=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-h-g+a(this).height();return b<10&&b>-10});j.length||(j=this.element.children(".ui-menu-item:last"));this.activate(e,
j)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(e){if(this.hasScroll())if(!this.active||this.first())this.activate(e,this.element.children(".ui-menu-item:last"));else{var h=this.active.offset().top,g=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var j=a(this).offset().top-h+g-a(this).height();return j<10&&j>-10});result.length||(result=this.element.children(".ui-menu-item:first"));
this.activate(e,result)}else this.activate(e,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})})(jQuery);$(document).ready(function(){S3.rtl?$('div.label label[id!="delete_record__label"]').prepend(":"):$('div.label label[id!="delete_record__label"]').append(":")});var S3={};S3.gis={};var popupWin=null;
function openPopup(a){if(!popupWin||popupWin.closed)popupWin=window.open(a,"popupWin","width=640, height=480");else popupWin.focus()}
$(document).ready(function(){try{$(".zoom").fancyZoom({scaleImg:true,closeOnClick:true,directory:S3.Ap.concat("/static/media")})}catch(a){}$("input.date").datepicker({changeMonth:true,changeYear:true,showOn:"both",buttonImage:S3.Ap.concat("/static/img/jquery-ui/calendar.gif"),buttonImageOnly:true,dateFormat:"yy-mm-dd",isRTL:S3.rtl});$(".error").hide().slideDown("slow");$(".error").click(function(){$(this).fadeOut("slow");return false});$(".warning").hide().slideDown("slow");$(".warning").click(function(){$(this).fadeOut("slow");
return false});$(".information").hide().slideDown("slow");$(".information").click(function(){$(this).fadeOut("slow");return false});$(".confirmation").hide().slideDown("slow");$(".confirmation").click(function(){$(this).fadeOut("slow");return false});$(".hoverable").hover(function(){$(this).addClass("hovered")},function(){$(this).removeClass("hovered")});$("#modulenav li").hover(function(){var h=$(this).width(),g=$("ul",this).width();g!=null&&g<h&&$("ul",this).css({width:h.toString()+"px"});$("ul",
this).css("display","block")},function(){$("ul",this).css("display","none")});$("#subnav li").hover(function(){var h=$(this).width()-2;$("ul",this).css({display:"block",width:h.toString()+"px"})},function(){$("ul",this).css("display","none")});$("a.colorbox").attr("href",function(h,g){var j="";try{j=$(this).parents("tr").attr("id").replace(/__row/,"")}catch(b){if(j=="")return g}var c=g;if(g.indexOf("&caller=")==-1)c=g+"&caller="+j;return c});$(".colorbox").click(function(){$.fn.colorbox({iframe:true,
width:"99%",height:"99%",href:this.href,title:this.title});return false});$(".tooltip").cluetip({activation:"hover",sticky:false,splitTitle:"|"});var e='<img src="'+S3.Ap.concat("/static/img/cross2.png")+'" alt="close" />';$(".stickytip").cluetip({activation:"hover",sticky:true,closePosition:"title",closeText:e,splitTitle:"|"});$(".ajaxtip").cluetip({activation:"click",sticky:true,closePosition:"title",closeText:e,width:380});now=new Date;$("form").append("<input type='hidden' value="+now.getTimezoneOffset()+
" name='_utc_offset'/>")});function s3_tb_remove(){$.fn.colorbox.close()}
(function(a){a.ajaxS3=function(e){var h=a.extend({},a.ajaxS3Settings,e);h.tryCount=0;if(e.message)s3_showStatus(S3.i18n.ajax_get+" "+(e.message?e.message:S3.i18n.ajax_fmd)+"...",this.ajaxS3Settings.msgTimeout);h.success=function(g,j){s3_hideStatus();e.success&&e.success(g,j)};h.error=function(g,j){if(j=="timeout"){this.tryCount++;if(this.tryCount<=this.retryLimit){s3_showStatus(S3.i18n.ajax_get+" "+(e.message?e.message:S3.i18n.ajax_fmd)+"... "+S3.i18n.ajax_rtr+" "+this.tryCount,a.ajaxS3Settings.msgTimeout);
a.ajax(this)}else s3_showStatus(S3.i18n.ajax_wht+" "+(this.retryLimit+1)+" "+S3.i18n.ajax_gvn,a.ajaxS3Settings.msgTimeout,false,true)}else g.status==500?s3_showStatus(S3.i18n.ajax_500,a.ajaxS3Settings.msgTimeout,false,true):s3_showStatus(S3.i18n.ajax_dwn,a.ajaxS3Settings.msgTimeout,false,true)};a.ajax(h)};a.postS3=function(e,h,g,j){return a.ajaxS3({type:"POST",url:e,data:h,success:g,dataType:j})};a.getS3=function(e,h,g,j,b,c){if(a.isFunction(h)){c=b;b=j;j=g;g=h;h=null}if(c)var f=false;return a.ajaxS3({type:"GET",
url:e,async:f,data:h,success:g,dataType:j,message:b})};a.getJSONS3=function(e,h,g,j,b){if(a.isFunction(h)){b=j;j=g;g=h;h=null}b||(b=false);return a.getS3(e,h,g,"json",j,b)};a.ajaxS3Settings={timeout:1E4,msgTimeout:2E3,retryLimit:10,dataType:"json",async:true,type:"GET"};a.ajaxS3Setup=function(e){a.extend(a.ajaxS3Settings,e)}})($);
function S3StatusBar(a,e){var h=this,g=null;this.elementId="_showstatus";this.prependMultiline=true;this.showCloseButton=false;this.afterTimeoutText=null;this.cssClass="statusbar";this.highlightClass="statusbarhighlight";this.errorClass="statusbarerror";this.closeButtonClass="statusbarclose";this.additive=false;$.extend(this,e);if(a)g=$(a);g||(g=$("<div id='_statusbar' class='"+h.cssClass+"'><div class='"+h.closeButtonClass+"'>"+(h.showCloseButton?" X </div></div>":"")).appendTo(document.body).show());
$("."+h.cssClass).click(function(){$(g).hide()});this.show=function(j,b,c,f){if(c||c==undefined&&h.additive){j="<div style='margin-bottom: 2px;' >"+j+"</div>";h.prependMultiline?g.prepend(j):g.append(j)}else if(h.showCloseButton){c=g.find("div.statusbarclose");g.text(j).prepend(c)}else g.text(j);g.show();if(b){f?g.addClass(h.errorClass):g.addClass(h.highlightClass);setTimeout(function(){g.removeClass(h.highlightClass);h.afterTimeoutText&&h.show(h.afterTimeoutText)},b)}};this.release=function(){if(_statusbar){$("#_statusbar").remove();
_statusbar=undefined}}}var _statusbar=null;function s3_showStatus(a,e,h,g){_statusbar||(_statusbar=new S3StatusBar);_statusbar.show(a,e,h,g)}function s3_hideStatus(){_statusbar&&_statusbar.release()}function S3SetNavigateAwayConfirm(){window.onbeforeunload=function(){return S3.i18n.unsaved_changes}}function S3ClearNavigateAwayConfirm(){window.onbeforeunload=function(){}}
function S3EnableNavigateAwayConfirm(){$(document).ready(function(){$("[class=error]").length>0&&S3SetNavigateAwayConfirm();$(":input:not(input[id=gis_location_advanced_checkbox])").keypress(S3SetNavigateAwayConfirm);$(":input:not(input[id=gis_location_advanced_checkbox])").change(S3SetNavigateAwayConfirm);$("form").submit(S3ClearNavigateAwayConfirm)})}function S3ConfirmClick(a,e){$(a).click(function(h){if(confirm(e))return true;else{h.preventDefault();return false}})}
function s3_viewMap(a){a=S3.Ap.concat("/gis/display_feature/")+a;var e=$("#map").html();a="<iframe width='640' height='480' src='"+a+"'></iframe>";var h=$('<a href="#">'+S3.i18n.close_map+"</a>");h.bind("click",function(g){$("#map").html(e);g.preventDefault()});$("#map").html(a);$("#map").append($("<div style='margin-bottom: 10px' />").append(h))}
function s3_viewMapMulti(a,e,h,g){a=S3.Ap.concat("/gis/display_feature//?module=")+a+"&resource="+e+"&instance="+h+"&jresource="+g;var j=$("#map").html();a='<iframe width="640" height="480" src="'+a+'"></iframe>';e=$('<a href="#">'+S3.i18n.close_map+"</a>");e.bind("click",function(b){$("#map").html(j);b.preventDefault()});$("#map").html(a);$("#map").append($("<div style='margin-bottom: 10px' />").append(e))};
