<!--Running in Debug mode, so we want each script to download separately & to use the uncompressed versions-->

<script type="text/javascript" src="/{{=request.application}}/static/scripts/S3/ba-debug.min.js"></script>
<script type="text/javascript">//<![CDATA[
// Global variable to store all of our variables inside
var S3 = Object();
{{if response.s3.rtl:}}
S3.rtl = true;
{{else:}}
S3.rtl = false;
{{pass}}
S3.gis = Object();
function s3_debug(message, value) {
        if (undefined == value) {
            debug.debug('s3_debug: ' + message);
        } else {
            debug.debug('s3_debug: ' + message + ': ' + value);
        }
    }
//]]></script>

<!--Web2Py Layer-->
{{if session.s3.cdn:}}
<!-- For Sites Hosted on the Public Internet, using Google's version of jQuery will provide better performance -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js" type="text/javascript"></script>
{{else:}}
<script src="/{{=request.application}}/static/scripts/web2py/jquery-1.4.4.js" type="text/javascript"></script>
{{pass}}
<script src="/{{=request.application}}/static/scripts/web2py/calendar.js" type="text/javascript" charset="utf-8"></script>
<!-- These 2 are included in the 1 above, but so is other stuff :/
<script src="/{{=request.application}}/static/scripts/web2py/calendar-1.0.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/web2py/jquery.timeentry.js" type="text/javascript" charset="utf-8"></script>
-->
<script src="/{{=request.application}}/static/scripts/web2py/web2py.js" type="text/javascript" charset="utf-8"></script>
<!--Scripts which need pre-processing by server must be called in-line-->
<script type="text/javascript">//<![CDATA[
jQuery(document).ready(function() {
    jQuery("input[type='checkbox'].delete").click(function() { if(this.checked) if(!confirm("{{=T('Sure you want to delete this object?')}}")) this.checked=false; });
    try { jQuery('input.datetime').focus( function() {Calendar.setup({
         inputField:this.id, ifFormat:"{{=T('%Y-%m-%d %H:%M:%S')}}", showsTime: true, timeFormat: '24'
    }); }); } catch(e) {};
});
//]]></script>

<!--T2 Layer-->
<script src="/{{=request.application}}/static/scripts/T2/fancyzoom.min.js" type="text/javascript" charset="utf-8"></script>
<!--
<script src="/{{=request.application}}/static/scripts/T2/rating.js" type="text/javascript" charset="utf-8"></script>
-->
<!--Scripts which need pre-processing by server must be called in-line-->
<script type="text/javascript">//<![CDATA[
jQuery(document).ready(function(){
    try { jQuery('.zoom').fancyZoom({scaleImg:true, closeOnClick:true, directory:"/{{=request.application}}/static/media"}); } catch(e) {};
});
//]]></script>

<!--S3 Layer-->
<script src="/{{=request.application}}/static/scripts/S3/labels.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.cluetip.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.colorbox.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.form-extension.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.ui.core.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.ui.position.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.ui.widget.js" type="text/javascript" charset="utf-8"></script>
{{if session.s3.cdn:}}
<!-- For Sites Hosted on the Public Internet, using Google's version of jQueryUI will provide better performance -->
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.7/jquery-ui.js" type="text/javascript"></script>
{{else:}}
<script src="/{{=request.application}}/static/scripts/S3/jquery.ui.autocomplete.js" type="text/javascript" charset="utf-8"></script>
{{pass}}
<script src="/{{=request.application}}/static/scripts/S3/jquery.ui.datepicker.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/S3.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/s3.multiselect.widget.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/s3.checkboxes.widget.js" type="text/javascript" charset="utf-8"></script>
<script src="/{{=request.application}}/static/scripts/S3/jquery.multiSelect.js" type="text/javascript" charset="utf-8"></script>
<!--Scripts which need pre-processing by server must be called in-line-->
<script type="text/javascript">//<![CDATA[

{{include "l10n.js"}}

function s3_viewMap(feature_id) {
    var url = '{{=URL(r=request, c="gis", f="display_feature")}}/' + feature_id;
    var oldhtml = $('#map').html();
    var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
    var closelink = $("<a href=\"#\">{{=T("Close map")}}</a>");

    closelink.bind( "click", function(evt) {
        $('#map').html(oldhtml);
        evt.preventDefault();
    });

    $('#map').html(iframe);
    $('#map').append($("<div style='margin-bottom: 10px' />").append(closelink));
}
function s3_viewMapMulti(module, resource, instance, jresource) {
    var url = '{{=URL(r=request, c="gis", f="display_features")}}/?module=' + module + '&resource=' + resource + '&instance=' + instance + '&jresource=' + jresource;
    var oldhtml = $('#map').html();
    var iframe = "<iframe width='640' height='480' src='" + url + "'></iframe>";
    var closelink = $("<a href=\"#\">{{=T("Close map")}}</a>");

    closelink.bind( 'click', function(evt) {
        $('#map').html(oldhtml);
        evt.preventDefault();
    });

    $('#map').html(iframe);
    $('#map').append($("<div style='margin-bottom: 10px' />").append(closelink));
}
jQuery(document).ready(function() {
    jQuery('input.date').datepicker({
        changeMonth: true, changeYear: true,
        //showOtherMonths: true, selectOtherMonths: true,
        showOn: 'both', buttonImage: '/{{=request.application}}/static/img/jquery-ui/calendar.gif', buttonImageOnly: true,
        dateFormat: 'yy-mm-dd', isRTL: {{if response.s3.rtl:}}true{{else:}}false{{pass}} });
    jQuery('a#delete-btn').click(function(event){ if(confirm("{{=T("Sure you want to delete this object?")}}")) {
            return true;
        } else {
            event.preventDefault();
            return false;
        }
    });
    jQuery('.tooltip').cluetip({activation: 'hover', sticky: false, splitTitle: '|'});
    jQuery('.stickytip').cluetip({activation: 'hover', sticky: true, closePosition: 'title', closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />', splitTitle: '|'});
    jQuery('.ajaxtip').cluetip({activation: 'click', sticky: true, closePosition: 'title', closeText: '<img src="/{{=request.application}}/static/img/cross2.png" alt="close" />', width: 380});
    now = new Date();
    jQuery('form').append("<input type='hidden' value=" + now.getTimezoneOffset() + " name='_utc_offset'/>");
});
//]]></script>

{{if session.s3.cdn:}}
<!-- For Sites Hosted on the Public Internet, using Cachefly CDN's version of ExtJS may provide better performance -->
<script src="http://extjs.cachefly.net/ext-3.3.1/adapter/jquery/ext-jquery-adapter-debug.js" type="text/javascript"></script>
<script src="http://extjs.cachefly.net/ext-3.3.1/ext-all-debug.js" type="text/javascript"></script>
<script src="http://extjs.cachefly.net/ext-3.3.1/src/locale/ext-lang-{{=response.s3.language}}.js" type="text/javascript"></script>
{{else:}}
<script src="/{{=request.application}}/static/scripts/ext/adapter/jquery/ext-jquery-adapter-debug.js" type="text/javascript"></script>
<script src="/{{=request.application}}/static/scripts/ext/ext-all-debug.js" type="text/javascript"></script>
<script src="/{{=request.application}}/static/scripts/ext/src/locale/ext-lang-{{=response.s3.language}}.js" type="text/javascript"></script>
{{pass}}
<!-- Needs to be loaded after Ext -->
<script src="/{{=request.application}}/static/scripts/S3/s3.locationselector.widget.js" type="text/javascript" charset="utf-8"></script>
